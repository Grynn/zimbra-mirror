# SpamAssassin rules file
#
# Please don't modify this file as your changes will be overwritten with
# the next update. Use @@LOCAL_RULES_DIR@@/local.cf instead.
# See 'perldoc Mail::SpamAssassin::Conf' for details.
#
# <@LICENSE>
# Licensed to the Apache Software Foundation (ASF) under one or more
# contributor license agreements.  See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# The ASF licenses this file to you under the Apache License, Version 2.0
# (the "License"); you may not use this file except in compliance with
# the License.  You may obtain a copy of the License at:
# 
#     http://www.apache.org/licenses/LICENSE-2.0
# 
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# </@LICENSE>
#
###########################################################################

require_version @@VERSION@@

##{ T_ADVANCE_FEE_2_NEW

meta      T_ADVANCE_FEE_2_NEW  __ADVANCE_FEE_2_NEW && !__SUBSCRIPTION_INFO && !__DKIM_EXISTS && !__HAS_SENDER && !__DOS_HAS_LIST_UNSUB && !__TAG_EXISTS_STYLE && !__HTML_LINK_IMAGE && !__COMMENT_EXISTS && !__HAS_X_LOOP
describe  T_ADVANCE_FEE_2_NEW  Appears to be advance fee fraud (Nigerian 419)
#score     T_ADVANCE_FEE_2_NEW  2.50	# limit
##} T_ADVANCE_FEE_2_NEW

##{ T_ADV_SUBJ

header	 T_ADV_SUBJ	Subject =~ /\[ ?(?:ADV|A D V) ?\]/i
describe T_ADV_SUBJ	Marked by sender as an advertisement
##} T_ADV_SUBJ

##{ T_AD_COMPLAINTS

body           T_AD_COMPLAINTS       /\bcomplaints about this ad+\b/i
describe       T_AD_COMPLAINTS       Complain about this spam
##} T_AD_COMPLAINTS

##{ T_APOSTROPHE_TOCC

header		T_APOSTROPHE_TOCC	ToCc:addr =~ /'/
describe	T_APOSTROPHE_TOCC	To or CC address contains an apostrophe
##} T_APOSTROPHE_TOCC

##{ T_ARTHUR_INTRUST

meta        T_ARTHUR_INTRUST         __ARTHUR_SIMMONS && __INTRUST_DOMS
describe    T_ARTHUR_INTRUST         Arthur Simmons - registrar spammer extraordinaire
##} T_ARTHUR_INTRUST

##{ T_ART_NAMES_ORG

header      T_ART_NAMES_ORG          Received =~ /\bart\.names\.org\b/i
describe    T_ART_NAMES_ORG          Arthur Simmons - registrar spammer extraordinaire
##} T_ART_NAMES_ORG

##{ T_AXB_BODYMAIL_SBL112884

body            T_AXB_BODYMAIL_SBL112884  /\@yeah\.net\b/
describe        T_AXB_BODYMAIL_SBL112884  Spammer dropbox SBL112884
##} T_AXB_BODYMAIL_SBL112884

##{ T_AXB_BULK_ECO

header          T_AXB_BULK_ECO            exists:X-CSA-Complaints
describe        T_AXB_BULK_ECO            Message sent by eco.de member
##} T_AXB_BULK_ECO

##{ T_AXB_BULK_SENDGRID

header		T_AXB_BULK_SENDGRID	exists:X-Sendgrid-EID
describe	T_AXB_BULK_SENDGRID	Bulk sent via Sendgrid
##} T_AXB_BULK_SENDGRID

##{ T_AXB_HELO_HOME_UN

header          T_AXB_HELO_HOME_UN        X-Spam-Relays-Untrusted =~ /^[^\]]+ helo=\w+\.(lan|home) /i
describe        T_AXB_HELO_HOME_UN        HELO from home  - untrusted
##} T_AXB_HELO_HOME_UN

##{ T_AXB_OBFU_MULE

meta		T_AXB_OBFU_MULE	(__AXB_LI_U && !__AXB_LI_CLASS && !__AXB_LI_FBL)
describe	T_AXB_OBFU_MULE	spacey mules
##} T_AXB_OBFU_MULE

##{ T_AXB_SSCECCF

rawbody         T_AXB_SSCECCF     /\bSandboxScopeClass ExternalClass\b/
describe        T_AXB_SSCECCF     unidentified fingerprint
##} T_AXB_SSCECCF

##{ T_AXB_XMAILER_MIMEOLE_OL_C485C

meta   T_AXB_XMAILER_MIMEOLE_OL_C485C  (__AXB_XM_OL_C485C && __AXB_MO_OL_C485C)
##} T_AXB_XMAILER_MIMEOLE_OL_C485C

##{ T_AXB_XMA_BASP

header          T_AXB_XMA_BASP            X-Mail-Agent =~ /^BASP21/
describe        T_AXB_XMA_BASP            Mailer fingerprint
##} T_AXB_XMA_BASP

##{ T_AXB_XMID_PFIX_CTRIP

header          T_AXB_XMID_PFIX_CTRIP     Message-ID =~ /\<[A-F0-9]{8}.[0-9]{6}\@ctrip\.com\>/
describe        T_AXB_XMID_PFIX_CTRIP     possibly forged ctrip sender - postfix
##} T_AXB_XMID_PFIX_CTRIP

##{ T_AXB_XM_BULK_SB

header          T_AXB_XM_BULK_SB          X-Mailer =~ /SendBlaster/
describe        T_AXB_XM_BULK_SB          Bulk mail tool
##} T_AXB_XM_BULK_SB

##{ T_AXB_XM_FORGED_OL2600

meta            T_AXB_XM_FORGED_OL2600    (__AXB_XM_OL_2600  && !__AXB_MO_OL_2600 )
describe        T_AXB_XM_FORGED_OL2600     Forged OE v. 6.2600
##} T_AXB_XM_FORGED_OL2600

##{ T_AXB_XM_GETRSP

header		T_AXB_XM_GETRSP	X-Mailer =~ /^GetResponse\b/
describe	T_AXB_XM_GETRSP	ESP Bulkware
##} T_AXB_XM_GETRSP

##{ T_AXB_XM_SENTBY

header          T_AXB_XM_SENTBY   exists:X-Mailer-Sent-By
describe        T_AXB_XM_SENTBY   Ratware fingerprint
##} T_AXB_XM_SENTBY

##{ T_AXB_XM_TURBOM

header          T_AXB_XM_TURBOM           X-Mailer =~ /TurboMailer/
describe        T_AXB_XM_TURBOM           Mailer fingerprint
##} T_AXB_XM_TURBOM

##{ T_AXB_XRCVD_EYOU_SEND

header   T_AXB_XRCVD_EYOU_SEND    Received =~ /\(eyou send program\)/
describe T_AXB_XRCVD_EYOU_SEND    fingerprint
##} T_AXB_XRCVD_EYOU_SEND

##{ T_AXB_X_AOL_SEZ_S

header          T_AXB_X_AOL_SEZ_S         x-aol-global-disposition =~ /^S$/
describe        T_AXB_X_AOL_SEZ_S         AOL said this is S
##} T_AXB_X_AOL_SEZ_S

##{ T_AXB_X_FORGED_OE61

header		T_AXB_X_FORGED_OE61	X-Mailer =~/^Microsoft Outlook Express 6\.1/
describe	T_AXB_X_FORGED_OE61	Forge OE version
##} T_AXB_X_FORGED_OE61

##{ T_AXB_X_MSEX_ANONYMOUS

header          T_AXB_X_MSEX_ANONYMOUS     X-MS-Exchange-Organization-AuthAs =~ /^Anonymous$/
describe        T_AXB_X_MSEX_ANONYMOUS     Seen in exploited MTA msgs
##} T_AXB_X_MSEX_ANONYMOUS

##{ T_AXB_X_PHPS_CTRIP

header          T_AXB_X_PHPS_CTRIP        X-PHP-Script =~ /\bctrip\.com\/sendmail\.php\b/
describe        T_AXB_X_PHPS_CTRIP        possibly forged ctrip sender - php
##} T_AXB_X_PHPS_CTRIP

##{ T_AXB_X_RCPTCNT

header          T_AXB_X_RCPTCNT           X-Rcptcnt =~ /gt3/
##} T_AXB_X_RCPTCNT

##{ T_AXB_X_WUM_TAG

header		T_AXB_X_WUM_TAG		X-WUM-CCI =~ /[\|\~\|]{10}/
describe	T_AXB_X_WUM_TAG		Possible Orange spam tag
##} T_AXB_X_WUM_TAG

##{ T_AXB_X_XM_MMAGIC

header          T_AXB_X_XM_MMAGIC         X-Mailer =~ /\bMailMagic/
describe        T_AXB_X_XM_MMAGIC         Mailer fingerprint
##} T_AXB_X_XM_MMAGIC

##{ T_BBC_RCVD_NCHAR_RAW

header T_BBC_RCVD_NCHAR_RAW     Received =~ / with (?:esmtp|ESMTP) \(\{nChar\[8-12\]} \{nChar\[4-6\]}\)/
##} T_BBC_RCVD_NCHAR_RAW

##{ T_BELL_MOBILITY_TXT_MSG

meta		T_BELL_MOBILITY_TXT_MSG	INVALID_DATE && MISSING_SUBJECT && FROM_STARTS_WITH_NUMS && __BELL_MOBILITY_RELAY
describe	T_BELL_MOBILITY_TXT_MSG	Adjustment for poorly formatted text->email messages
tflags		T_BELL_MOBILITY_TXT_MSG	nice
##} T_BELL_MOBILITY_TXT_MSG

##{ T_BIGNUM_EMAILS

meta           T_BIGNUM_EMAILS              __BIGNUM_EMAILS && !__SPOOFED_URL && !__BUGGED_IMG
describe       T_BIGNUM_EMAILS              Lots of email addresses/leads
#score          T_BIGNUM_EMAILS              3.00		# limti
##} T_BIGNUM_EMAILS

##{ T_BIG_HEADERS_2K

header	 T_BIG_HEADERS_2K 	ALL:raw =~ /^(?=.{2048,3071}$)/s
describe T_BIG_HEADERS_2K 	Headers contain 2K-3K characters total
##} T_BIG_HEADERS_2K

##{ T_BIG_HEADERS_3K

header	 T_BIG_HEADERS_3K 	ALL:raw =~ /^(?=.{3072,4095}$)/s
describe T_BIG_HEADERS_3K 	Headers contain 3K-4K characters total
##} T_BIG_HEADERS_3K

##{ T_BIG_HEADERS_4K

header	 T_BIG_HEADERS_4K 	ALL:raw =~ /^(?=.{4096,5119}$)/s
describe T_BIG_HEADERS_4K 	Headers contain 4K-5K characters total
##} T_BIG_HEADERS_4K

##{ T_BIG_HEADERS_5K

header	 T_BIG_HEADERS_5K 	ALL:raw =~ /^(?=.{5120})/s
describe T_BIG_HEADERS_5K 	Headers contain 5K+ characters total
##} T_BIG_HEADERS_5K

##{ T_BILLION_OVERLAP

meta T_BILLION_OVERLAP    	(BILLION_DOLLARS + US_DOLLARS_3 >= 2)
#score T_BILLION_OVERLAP   	-1.0
describe T_BILLION_OVERLAP 	Reducing score for overlap of similar rules 
##} T_BILLION_OVERLAP

##{ T_BILL_1618

body        T_BILL_1618          /\bUnder Bills?.1618(?: Title III)? passed by the 105th U\.S\. Congress\b/i
describe    T_BILL_1618          Mentions proposed US law supposedly permitting spamming
##} T_BILL_1618

##{ T_BITLY_URI

meta            T_BITLY_URI               __BITLY_URI && !__SUBSCRIPTION_INFO && !__HAS_ANY_EMAIL && !__HAS_REPLY_TO && !__UNSUB_LINK && !__RCD_RDNS_MAIL_MESSY && !__RP_MATCHES_RCVD && !__COMMENT_EXISTS && !__TO_NO_BRKTS_HTML_ONLY && !__NOT_SPOOFED 
describe        T_BITLY_URI               URI contains bit.ly
#score           T_BITLY_URI               2.25	# limit
##} T_BITLY_URI

##{ T_BOTNET_NOPLUGIN

meta T_BOTNET_NOPLUGIN	!__BOTNET_SERVER && (__BOTNET_CLIENT1||__BOTNET_CLIENT2)
##} T_BOTNET_NOPLUGIN

##{ T_BOTNET_OCNNEJP

describe T_BOTNET_OCNNEJP		Ocn.ne.jp customer address
meta	 T_BOTNET_OCNNEJP		(__BOTNET_OCNNEJP && __BOTNET_NOTRUST)
tflags	 T_BOTNET_OCNNEJP	nopublish # confirm license with author first
##} T_BOTNET_OCNNEJP

##{ T_BOTNET_SHAWCABLE

describe T_BOTNET_SHAWCABLE	Shawcable.net customer address
meta	 T_BOTNET_SHAWCABLE	(__BOTNET_SHAWCABLE && __BOTNET_NOTRUST)
tflags	 T_BOTNET_SHAWCABLE	nopublish # confirm license with author first
##} T_BOTNET_SHAWCABLE

##{ T_BUG5920_X_IP

meta T_BUG5920_X_IP             (__X_IP && !__GOOGLE_GROUPS_UA)
describe T_BUG5920_X_IP         Message has X-IP header
##} T_BUG5920_X_IP

##{ T_BUG6919_RDNS_DYNAMIC

meta     T_BUG6919_RDNS_DYNAMIC   (__LAST_EXTERNAL_RELAY_NO_AUTH && !__BUG6919_RDNS_STATIC && (__RDNS_DYNAMIC_IPADDR || __RDNS_DYNAMIC_DHCP || __RDNS_DYNAMIC_HCC || __RDNS_DYNAMIC_ATTBI || __RDNS_DYNAMIC_ROGERS || __RDNS_DYNAMIC_ADELPHIA || __RDNS_DYNAMIC_DIALIN || __RDNS_DYNAMIC_HEXIP || __RDNS_DYNAMIC_SPLIT_IP || __RDNS_DYNAMIC_YAHOOBB || __RDNS_DYNAMIC_OOL || __RDNS_DYNAMIC_RR2   || __RDNS_DYNAMIC_COMCAST || __RDNS_DYNAMIC_TELIA || __RDNS_DYNAMIC_VTR || __RDNS_DYNAMIC_CHELLO_NO  || __RDNS_DYNAMIC_CHELLO_NL  || __RDNS_DYNAMIC_VELOX  || __RDNS_DYNAMIC_NTL  || __RDNS_DYNAMIC_HOME_NL  || __RDNS_DYNAMIC_TDS || __RDNS_DYNAMIC_VIRTUA || __BUG6919_RDNS_DYNAMIC_SPACELAN || __RDNS_INDICATOR_DYN || __RDNS_INDICATOR_RES || __RDNS_INDICATOR_TYPE2 || __RDNS_DYNAMIC_TTNET || __RDNS_DYNAMIC_ASAHI))
#score    T_BUG6919_RDNS_DYNAMIC   0.01
##} T_BUG6919_RDNS_DYNAMIC

##{ T_BUG6919_RDNS_GENERIC

meta     T_BUG6919_RDNS_GENERIC   (__LAST_EXTERNAL_RELAY_NO_AUTH && (__RDNS_DYNAMIC_IPADDR || __RDNS_DYNAMIC_DHCP || __RDNS_DYNAMIC_HCC || __RDNS_DYNAMIC_ATTBI || __RDNS_DYNAMIC_ROGERS || __RDNS_DYNAMIC_ADELPHIA || __RDNS_DYNAMIC_DIALIN || __RDNS_DYNAMIC_HEXIP || __RDNS_DYNAMIC_SPLIT_IP || __RDNS_DYNAMIC_YAHOOBB || __RDNS_DYNAMIC_OOL || __RDNS_DYNAMIC_RR2   || __RDNS_DYNAMIC_COMCAST || __RDNS_DYNAMIC_TELIA || __RDNS_DYNAMIC_VTR || __RDNS_DYNAMIC_CHELLO_NO  || __RDNS_DYNAMIC_CHELLO_NL  || __RDNS_DYNAMIC_VELOX  || __RDNS_DYNAMIC_NTL  || __RDNS_DYNAMIC_HOME_NL  || __RDNS_DYNAMIC_TDS || __RDNS_DYNAMIC_VIRTUA || __BUG6919_RDNS_DYNAMIC_SPACELAN || __RDNS_INDICATOR_DYN || __RDNS_INDICATOR_RES || __RDNS_INDICATOR_TYPE2 || __RDNS_DYNAMIC_TTNET || __RDNS_DYNAMIC_ASAHI))            
#score    T_BUG6919_RDNS_GENERIC   0.01
##} T_BUG6919_RDNS_GENERIC

##{ T_CALL_SKYPE

body           T_CALL_SKYPE            /\bCall this phone number [\w\s]{0,30}with Skype\b/
##} T_CALL_SKYPE

##{ T_CAN_SPAM_HDR

header          T_CAN_SPAM_HDR            CAN-SPAM_Compliant =~ /./
##} T_CAN_SPAM_HDR

##{ T_CARD_DIRECT_WWW_ADDRESS

meta T_CARD_DIRECT_WWW_ADDRESS (__CARD_DIRECT_WWW_ADDRESS && !__LEGIT_MARLO_CARD)
##} T_CARD_DIRECT_WWW_ADDRESS

##{ T_CN_B2B_SPAMMER

body        T_CN_B2B_SPAMMER         /\bWe are (?:(?:a )?China[-\s]based|one of the best[^\.]{10,50} located in China)\b/i
describe    T_CN_B2B_SPAMMER         Chinese company introducing itself
##} T_CN_B2B_SPAMMER

##{ T_CN_URL

uri T_CN_URL      /[^\/]+\.cn(?:$|\/|\?)/i
describe T_CN_URL Contains a URL in the .cn domain
#score T_CN_URL    0.01
##} T_CN_URL

##{ T_COMPUTERS_JEWELRY

body T_COMPUTERS_JEWELRY /Electronics\s{0,5}Computers\s{0,5}Software\s{0,5}Home Essentials\s{0,5}Health & Beauty\s{0,5}Jewelry\s{0,5}More!/i
describe T_COMPUTERS_JEWELRY Selling computers, jewelry, etc.
##} T_COMPUTERS_JEWELRY

##{ T_CR_IN_SUBJ

header   T_CR_IN_SUBJ	Subject:raw =~ /\015/
describe T_CR_IN_SUBJ	Subject contains a CR character
##} T_CR_IN_SUBJ

##{ T_DATE_DOTS

header          T_DATE_DOTS               Date =~ /\d\d\.\d\d\.\d\d/
describe        T_DATE_DOTS               Periods in date header
##} T_DATE_DOTS

##{ T_DEAR_EMAIL

body	 T_DEAR_EMAIL	/^\s*Dear\b.{0,70}\w\@\w/i
describe T_DEAR_EMAIL	Message contains Dear email address
#score    T_DEAR_EMAIL	1.5 # 20090424
##} T_DEAR_EMAIL

##{ T_DEAR_EMAIL_USER

body           T_DEAR_EMAIL_USER          /^\s?(?:Dear\s|Attention:?\s?)(?:E|Web)-?mail\s(?:account\s)?User\b/i
describe       T_DEAR_EMAIL_USER          Dear Email User:
##} T_DEAR_EMAIL_USER

##{ T_DEAR_NOBODY

rawbody	 T_DEAR_NOBODY	/^\s*Dear\b[^a-zA-Z]{1,70}\n/mi
describe T_DEAR_NOBODY	Message contains Dear but with no name
##} T_DEAR_NOBODY

##{ T_DEB_RAJONAA

meta	 T_DEB_RAJONAA	__LISTID_DEBIAN && __RAJONAA_INFO
describe T_DEB_RAJONAA	Latvian text with .info URI on Debian List
##} T_DEB_RAJONAA

##{ T_DG_SPAMMER_EMAIL_B

body        T_DG_SPAMMER_EMAIL_B     /\b[a-z]{10,30}\.[a-z]{3,10}\@[a-z]{3,10}\.[a-z]{6,30}\.[a-z]{2,4}\b/
describe    T_DG_SPAMMER_EMAIL_B     Recognized spammer email address in body
##} T_DG_SPAMMER_EMAIL_B

##{ T_DG_SPAMMER_EMAIL_F

header      T_DG_SPAMMER_EMAIL_F     From =~ /\b[a-z]{10,30}\.[a-z]{3,10}\@[a-z]{3,10}\.[a-z]{6,30}\.[a-z]{2,4}\b/
describe    T_DG_SPAMMER_EMAIL_F     Recognized spammer email address in From: header
##} T_DG_SPAMMER_EMAIL_F

##{ T_DOS_ANAL_SPAM_MAILER2

header T_DOS_ANAL_SPAM_MAILER2	X-mailer =~ /^[A-Z][a-z]{6}e .* \d\.\d{2}$/
describe T_DOS_ANAL_SPAM_MAILER2	X-mailer pattern common to porn site spam
##} T_DOS_ANAL_SPAM_MAILER2

##{ T_DOS_BODY_HIGH_NO_MID

meta T_DOS_BODY_HIGH_NO_MID       __HIGHBITS && MISSING_MID
describe T_DOS_BODY_HIGH_NO_MID   High bit body and no message ID header
##} T_DOS_BODY_HIGH_NO_MID

##{ T_DOS_DEREK_AUG08

meta T_DOS_DEREK_AUG08    __DOS_SINGLE_EXT_RELAY && __DOS_HAS_ANY_URI && __NAKED_TO && __LAST_UNTRUSTED_RELAY_NO_AUTH && SPF_PASS && __TVD_MIME_ATT_TP && __CT_TEXT_PLAIN && (__DOS_MSGID_DIGITS9 || __DOS_MSGID_DIGITS10)
##} T_DOS_DEREK_AUG08

##{ T_DOS_DOM_LIST_CENTER

meta	T_DOS_DOM_LIST_CENTER		(__DOS_DOM_LIST_CENTER && __DOS_NOT_A_BILL && __DOS_SUB_SEARCH_ENGINE && __DOS_FINAL_NOTICE_DL)
describe	T_DOS_DOM_LIST_CENTER	Final notice for search engine submission
##} T_DOS_DOM_LIST_CENTER

##{ T_DOS_DOT_COM_AT

header		T_DOS_DOT_COM_AT	Envelope-From:addr =~ /^[^=]+\.com\@[^\@]+$/
describe	T_DOS_DOT_COM_AT	Envelope-From has a domain.com@anotherdomain.com
##} T_DOS_DOT_COM_AT

##{ T_DOS_DOUBLE_SOTCK

body T_DOS_DOUBLE_SOTCK		/\b(s(?:otc|tco)k)\b.{15,50}\b\1\b/
describe T_DOS_DOUBLE_SOTCK	Stock spelt wrong the same way twice in a row
##} T_DOS_DOUBLE_SOTCK

##{ T_DOS_FAKE_SQUIRREL

meta T_DOS_FAKE_SQUIRREL		(__DOS_MAILER_SM || __DOS_UA_SM) && (!__DOS_RELAY_SM || !__DOS_SM_MID)
describe T_DOS_FAKE_SQUIRREL	Message contains faked SquirrelMail headers
##} T_DOS_FAKE_SQUIRREL

##{ T_DOS_FAKE_UPS_TRACK_NUM

header T_DOS_FAKE_UPS_TRACK_NUM	Subject =~ /UPS Tracking Number \d{10}/
describe T_DOS_FAKE_UPS_TRACK_NUM	Invalid UPS Tracking Number in Subject
##} T_DOS_FAKE_UPS_TRACK_NUM

##{ T_DOS_FORGED_RCVD_QUADS

header T_DOS_FORGED_RCVD_QUADS    ALL-EXTERNAL =~ /(?:^|\n)Received:\s+from \[(\d{2,3}\.\d{1,3}.\d{1,3}\.\d{1,3})\] .+\nReceived:\s+from \[\1\] by \S+; /
describe T_DOS_FORGED_RCVD_QUADS  Probable forged received header
##} T_DOS_FORGED_RCVD_QUADS

##{ T_DOS_GOOGLE_DOCS

uri T_DOS_GOOGLE_DOCS	/^http:\/\/docs\.google\.com\/View\?id=/
##} T_DOS_GOOGLE_DOCS

##{ T_DOS_GOOGLE_LUCKY_REDIRECT

uri T_DOS_GOOGLE_LUCKY_REDIRECT	  	m{^http://[^/]\.google\.[^/]/search?(?:.*&|&?)btnI=?}
describe T_DOS_GOOGLE_LUCKY_REDIRECT	Invisible Google redirect using the "lucky button"
##} T_DOS_GOOGLE_LUCKY_REDIRECT

##{ T_DOS_HC_ZIP_VIRUS

meta T_DOS_HC_ZIP_VIRUS           T_DOS_ZIP_HARDCORE && T_DOS_PLAYED_IN_HARDCORE
describe T_DOS_HC_ZIP_VIRUS       Hardcore porn virus spam
#score T_DOS_HC_ZIP_VIRUS          3.5
##} T_DOS_HC_ZIP_VIRUS

##{ T_DOS_LIVE_SPACES_CID

uri T_DOS_LIVE_SPACES_CID	/^http:\/\/cid-.{10,20}\.spaces\.live\.com\/$/
##} T_DOS_LIVE_SPACES_CID

##{ T_DOS_MED_CAN_PHARM_NOV07

meta T_DOS_MED_CAN_PHARM_NOV07    __OE_MSGID_2 && __DOS_HAS_ANY_URI && ((__DOS_MED_WHAT_COULD && __DOS_MED_NO_DIRECTION) || ( __DOS_MED_CAN_WEB_PHARM && __DOS_MED_MARK_DOWN))
##} T_DOS_MED_CAN_PHARM_NOV07

##{ T_DOS_MORTGAGE

meta T_DOS_MORTGAGE	__DOS_488K_FIXED + __DOS_372K_VARI + __DOS_492K_INT + __DOS_248K_FIXED + __DOS_198K_VARI > 1
##} T_DOS_MORTGAGE

##{ T_DOS_PHISH_WWW_COM_BIZ

uri T_DOS_PHISH_WWW_COM_BIZ	/^http:\/\/www\.[^.]+\.com\.[^.]+\.biz$/
##} T_DOS_PHISH_WWW_COM_BIZ

##{ T_DOS_PHISH_WWW_COM_RU

uri T_DOS_PHISH_WWW_COM_RU	/^http:\/\/www\.[^.]+\.com\.[^.]+\.ru$/
##} T_DOS_PHISH_WWW_COM_RU

##{ T_DOS_PLAYED_IN_HARDCORE

body            T_DOS_PLAYED_IN_HARDCORE  /played in hardcore porn/
describe        T_DOS_PLAYED_IN_HARDCORE  Claims someone played in hardcore porn
#score           T_DOS_PLAYED_IN_HARDCORE  1.5
##} T_DOS_PLAYED_IN_HARDCORE

##{ T_DOS_PORN_BOUNDARY

header T_DOS_PORN_BOUNDARY        Content-Type =~ /\bboundary="----\#(?:SUBSTANCE|CONTENT)_BOUNDARY"$/
describe T_DOS_PORN_BOUNDARY      Content boundary common to porn spam
#score T_DOS_PORN_BOUNDARY         1.0
##} T_DOS_PORN_BOUNDARY

##{ T_DOS_PROVISION4

body T_DOS_PROVISION4	/\bProvisionfor income taxes\b/
describe T_DOS_PROVISION4	Provision for income taxes
#score T_DOS_PROVISION4	1.5
##} T_DOS_PROVISION4

##{ T_DOS_RCVD_IP_TWICE_A

header T_DOS_RCVD_IP_TWICE_A	X-Spam-Relays-External =~ /\[ ip=(?!127)([\d.]+) [^\[]*\bhelo=\S+ [^\[]*\[ ip=\1 /
describe T_DOS_RCVD_IP_TWICE_A	Received from the same IP twice in a row
##} T_DOS_RCVD_IP_TWICE_A

##{ T_DOS_RCVD_IP_TWICE_B

header T_DOS_RCVD_IP_TWICE_B	X-Spam-Relays-External =~ /^\s*\[ ip=(?!127)([\d.]+) [^\[]*\[ ip=\1 [^\]]*\]\s*$/
describe T_DOS_RCVD_IP_TWICE_B	Received from the same IP twice in a row (only one external relay)
##} T_DOS_RCVD_IP_TWICE_B

##{ T_DOS_REMOVE_DOMAIN_DOT

body T_DOS_REMOVE_DOMAIN_DOT		/e(?:mov|let)e the (?:dot|period|point) from the end/
##} T_DOS_REMOVE_DOMAIN_DOT

##{ T_DOS_REMOVE_DOMAIN_DOT_YAHOO

meta T_DOS_REMOVE_DOMAIN_DOT_YAHOO	T_DOS_REMOVE_DOMAIN_DOT && FORGED_YAHOO_RCVD
##} T_DOS_REMOVE_DOMAIN_DOT_YAHOO

##{ T_DOS_REPORT_FIN_INC

body T_DOS_REPORT_FIN_INC		/\bReport of financial income\b/
describe T_DOS_REPORT_FIN_INC	Report of financial income
#score T_DOS_REPORT_FIN_INC	0.5
##} T_DOS_REPORT_FIN_INC

##{ T_DOS_STOCK_CDYV_GENERIC

body T_DOS_STOCK_CDYV_GENERIC	/(?:Lookup|Sym8oL|Search for|Promoting sym|S\.umbol|Target sym|Campaign for): [A-Z]{4},?.{1,50}\b[Pp]rice/
describe T_DOS_STOCK_CDYV_GENERIC	Pump and dump stock spam
#score T_DOS_STOCK_CDYV_GENERIC	2.5
##} T_DOS_STOCK_CDYV_GENERIC

##{ T_DOS_STOCK_INCOME_STATEMENT

meta T_DOS_STOCK_INCOME_STATEMENT		T_DOS_REPORT_FIN_INC && T_DOS_PROVISION4 && __DOS_SYMBOL_4 && __DOS_HEADLINES
describe T_DOS_STOCK_INCOME_STATEMENT	Pump and dump stock income statement spam
#score T_DOS_STOCK_INCOME_STATEMENT	1.5
##} T_DOS_STOCK_INCOME_STATEMENT

##{ T_DOS_STOCK_O_PRICE

meta	T_DOS_STOCK_O_PRICE		(__DOS_STOCK_COMPANY && __DOS_STOCK_TICKER && __DOS_STOCK_O_PRICE)
describe	T_DOS_STOCK_O_PRICE	Stocks with 'oh', rather than 'zero' values
##} T_DOS_STOCK_O_PRICE

##{ T_DOS_TO_READ_STOCK

meta T_DOS_TO_READ_STOCK		(__DOS_HAVE_TO_READ || __DOS_REQ_TO_READ) + __DOS_TOLD_DAY + __DOS_OIL_EXCEED + __DOS_DEAL_MAKE_MONEY + __DOS_GREAT_DRAWN_UP + __DOS_KEY_GET_IN_EARLY + __DOS_INCREASE_UP + __DOS_WASTE_TIME_MISS + __DOS_NO_STOPPING > 4
describe T_DOS_TO_READ_STOCK	Stock pumping you just have to read
##} T_DOS_TO_READ_STOCK

##{ T_DOS_TWO_MIS_STOCK

body T_DOS_TWO_MIS_STOCK		/\bs(?:otc|tco)k\b.{15,50}\bs(?:otc|tco)k\b/
describe T_DOS_TWO_MIS_STOCK	Stock spelt wrong twice in a row
##} T_DOS_TWO_MIS_STOCK

##{ T_DQ_URI_DOM_IN_PATH

uri             T_DQ_URI_DOM_IN_PATH      /:\/\/[\d\.]+\/[^\/]+\/[^\@]+[a-z0-9]\w{3,}\.(?:com|gov|net)/i
describe        T_DQ_URI_DOM_IN_PATH      DQ URI having a domain name in the path part
##} T_DQ_URI_DOM_IN_PATH

##{ T_DUH_DIKSBJ

header T_DUH_DIKSBJ   Subject =~ /^\$DIKSBJ/
describe T_DUH_DIKSBJ Idiot spammer screwed up his templates (DIK variant)
##} T_DUH_DIKSBJ

##{ T_DVLABS_GOZI_PDF

full T_DVLABS_GOZI_PDF    /bWFpbHRvOiUvLi4vLi4vLi4vLi4vLi4vLi4v/
##} T_DVLABS_GOZI_PDF

##{ T_EMPTY_RVM_ATTCH

meta           T_EMPTY_RVM_ATTCH      (__PLS_REVIEW || __DLND_ATTACH) && __EMPTY_BODY
describe       T_EMPTY_RVM_ATTCH      Please review attached document, empty message
##} T_EMPTY_RVM_ATTCH

##{ T_END_FUTURE_EMAILS

body           T_END_FUTURE_EMAILS   /\bend future (?:email|alert)s?\b/i
describe       T_END_FUTURE_EMAILS   Pump-and-dump unsubscribe
##} T_END_FUTURE_EMAILS

##{ T_EXECUTABLE_URI

meta       T_EXECUTABLE_URI   __EXECUTABLE_URI
describe   T_EXECUTABLE_URI   Link to an executable file
##} T_EXECUTABLE_URI

##{ T_FAKE_REPLY_A1

meta     T_FAKE_REPLY_A1		(__SUBJ_RE && __MISSING_REPLY && __MISSING_REF && __BOTH_INR_AND_REF)
##} T_FAKE_REPLY_A1

##{ T_FAKE_REPLY_B

meta     T_FAKE_REPLY_B		(__SUBJ_RE && __MISSING_REPLY && __INR_AND_NO_REF)
##} T_FAKE_REPLY_B

##{ T_FAKE_REPLY_SURE_A

meta     T_FAKE_REPLY_SURE_A	(__SUBJ_RE && (!FAKE_REPLY_A && !T_FAKE_REPLY_A1 && !FAKE_REPLY_A2 && !T_FAKE_REPLY_B && !FAKE_REPLY_C) && (!T_NICE_REPLY_A && !T_NICE_REPLY_B && !T_NICE_REPLY_C) && !__BROKE_MUAS && __MISSING_THREAD)
##} T_FAKE_REPLY_SURE_A

##{ T_FAKE_REPLY_SURE_B

meta     T_FAKE_REPLY_SURE_B	(__SUBJ_RE && (!FAKE_REPLY_A && !T_FAKE_REPLY_A1 && !FAKE_REPLY_A2 && !T_FAKE_REPLY_B && !FAKE_REPLY_C) && (!T_NICE_REPLY_A && !T_NICE_REPLY_B && !T_NICE_REPLY_C) && !__BROKE_MUAS)
##} T_FAKE_REPLY_SURE_B

##{ T_FBI_MONEY

meta        T_FBI_MONEY            __FBI_SPOOF && LOTS_OF_MONEY
describe    T_FBI_MONEY            The FBI wants to give you lots of money?
#score       T_FBI_MONEY            2.00	# limit
##} T_FBI_MONEY

##{ T_FBI_SPOOF

meta        T_FBI_SPOOF            __FBI_SPOOF
describe    T_FBI_SPOOF            Claims to be FBI, but not from FBI domain
#score       T_FBI_SPOOF            2.00	# limit
##} T_FBI_SPOOF

##{ T_FB_AN_ERROR_4U

body     T_FB_AN_ERROR_4U         /An error has been made in your favor/
describe T_FB_AN_ERROR_4U         Phrase: an error has been made in your favor
##} T_FB_AN_ERROR_4U

##{ T_FB_B0NUS

body      T_FB_B0NUS              /B0nus/i
describe  T_FB_B0NUS              Phrase: B0nus
##} T_FB_B0NUS

##{ T_FB_BAD_ERECT

body     T_FB_BAD_ERECT           /bad erection/i
describe T_FB_BAD_ERECT           Phrase: Bad Erection
##} T_FB_BAD_ERECT

##{ T_FB_BEDISCARDED

body     T_FB_BEDISCARDED         /discarded [a-z\s]{1,14} future deployments/i
describe T_FB_BEDISCARDED         Phrase: discarded ... future deployments
##} T_FB_BEDISCARDED

##{ T_FB_BE_MILLION

body     T_FB_BE_MILLION          /be.{1,5}millionaire/i
describe T_FB_BE_MILLION          Phrase: be millionaire
##} T_FB_BE_MILLION

##{ T_FB_BOOST_CONFIDEN

body     T_FB_BOOST_CONFIDEN      /Boost your confidence/i
describe T_FB_BOOST_CONFIDEN      Phrase: boost your confidence.
##} T_FB_BOOST_CONFIDEN

##{ T_FB_BROKEN_PHNUM

body     T_FB_BROKEN_PHNUM        /(?!800)8[0o][0o][-.\s\)]{1,3}\d\d\d[-\.\s]{0,3}\d\d\d\d/i
describe T_FB_BROKEN_PHNUM        weird phone number, with letters!
##} T_FB_BROKEN_PHNUM

##{ T_FB_BROWSER_ERR

body     T_FB_BROWSER_ERR         /Browser Error: [a-z0-9_]+,/i
describe T_FB_BROWSER_ERR         Phrase: Browser Error: random
##} T_FB_BROWSER_ERR

##{ T_FB_CASINO

body     T_FB_CASINO              /(?!casino)Ca[\$s5][i1\|]n[o0]/i
describe T_FB_CASINO              Phrase: ca$ino
##} T_FB_CASINO

##{ T_FB_CASINO_SPELLER

body     T_FB_CASINO_SPELLER      /(?:Onliine Casino|Online CCasino)/i
describe T_FB_CASINO_SPELLER      Phrase: Online Casino, spelling mistake.
##} T_FB_CASINO_SPELLER

##{ T_FB_CHOLESTERBLCK

body     T_FB_CHOLESTERBLCK       /Cholesterblock/i
describe T_FB_CHOLESTERBLCK       Phrase: Cholesterblock
##} T_FB_CHOLESTERBLCK

##{ T_FB_COM_ADR_SIGN

body     T_FB_COM_ADR_SIGN        /\:\:\s.{0,5}\d{3}\s\w{3,9}\s\w{2,9}\s.{1,20}\d{2}/i
describe T_FB_COM_ADR_SIGN        Common sign used in Addresses
##} T_FB_COM_ADR_SIGN

##{ T_FB_CONSOL_YOUR

body     T_FB_CONSOL_YOUR         /consolidate your/i
describe T_FB_CONSOL_YOUR         Phrase: Consolidate your
##} T_FB_CONSOL_YOUR

##{ T_FB_DDDD_BUCKS

body     T_FB_DDDD_BUCKS          /\d{4} bucks/
describe T_FB_DDDD_BUCKS          We use comma's and it's dollars not bucks!
##} T_FB_DDDD_BUCKS

##{ T_FB_DROWNING_DEBT

body     T_FB_DROWNING_DEBT       /drowning in debt/i
describe T_FB_DROWNING_DEBT       Phrase: drowning in debt
##} T_FB_DROWNING_DEBT

##{ T_FB_EARN_UP_TO

body     T_FB_EARN_UP_TO          /earn up to \$?\d?,?\d\d\d.{1,7}(?:day|week|month|year)/i
describe T_FB_EARN_UP_TO          Phrase: Earn up to ....
##} T_FB_EARN_UP_TO

##{ T_FB_ENHANCED_MALE

body     T_FB_ENHANCED_MALE       /Enhanced male/i
describe T_FB_ENHANCED_MALE       Phrase: Enhanced male
##} T_FB_ENHANCED_MALE

##{ T_FB_EPHEDRA_IS

body     T_FB_EPHEDRA_IS          /Ephedra is back/i
describe T_FB_EPHEDRA_IS          Phrase: Ephedra is back
##} T_FB_EPHEDRA_IS

##{ T_FB_EXPLOSIVE

body     T_FB_EXPLOSIVE           /EXPLOSIVE\b/
describe T_FB_EXPLOSIVE           Phrase: EXPLOSIVE
##} T_FB_EXPLOSIVE

##{ T_FB_EXP_POWER_OF

body     T_FB_EXP_POWER_OF        /Experience the power of/i
describe T_FB_EXP_POWER_OF        Phrase: Experience the power of
##} T_FB_EXP_POWER_OF

##{ T_FB_FAKE_NUMS2

body     T_FB_FAKE_NUMS2          /\d,0OO/i
describe T_FB_FAKE_NUMS2          Looks like fake numbers
##} T_FB_FAKE_NUMS2

##{ T_FB_FEDERALLY_COMPL

body     T_FB_FEDERALLY_COMPL     /We are federally compliant/i
describe T_FB_FEDERALLY_COMPL     Phrase: we are federally compliant
##} T_FB_FEDERALLY_COMPL

##{ T_FB_FREE888

body     T_FB_FREE888             /Free \$888/i
describe T_FB_FREE888             Claims we can get $888 Free.
##} T_FB_FREE888

##{ T_FB_FUNNY_WEIGHT

body     T_FB_FUNNY_WEIGHT        /(?!weight)we ?i?ght/i
describe T_FB_FUNNY_WEIGHT        Looks like weight but it's not!
##} T_FB_FUNNY_WEIGHT

##{ T_FB_GAPPY_SOMETHING

body     T_FB_GAPPY_SOMETHING     /(?:[A-Z,-]\s){8}.{0,5}(?:[0-9]\s){3}/
describe T_FB_GAPPY_SOMETHING     Looks like something thats g a p p y
##} T_FB_GAPPY_SOMETHING

##{ T_FB_GET_LAID

body     T_FB_GET_LAID            /GET LAID/
describe T_FB_GET_LAID            Phrase: GET LAID
##} T_FB_GET_LAID

##{ T_FB_GET_XXX_CASH

body     T_FB_GET_XXX_CASH        /get \d+(?:,?\d+)? (?:[a-z]+ ?)?cash/i
describe T_FB_GET_XXX_CASH        Phrase: Get Cash
##} T_FB_GET_XXX_CASH

##{ T_FB_GREAT_BEST_SEX

body     T_FB_GREAT_BEST_SEX      /(?:greater|best|Improved) sex/i
describe T_FB_GREAT_BEST_SEX      Phrase: greater, best, improved sex
##} T_FB_GREAT_BEST_SEX

##{ T_FB_HA1R

body     T_FB_HA1R                /\bha1r\b/i
describe T_FB_HA1R                Phrase: ha1r
##} T_FB_HA1R

##{ T_FB_IMAGIRL

body     T_FB_IMAGIRL             /i am a girl/i
describe T_FB_IMAGIRL             Phrae: I am a girl
##} T_FB_IMAGIRL

##{ T_FB_IMPROVEJA

body     T_FB_IMPROVEJA           /Improved Ejaculation/i
describe T_FB_IMPROVEJA           Phrase: Improved Ejaculation
##} T_FB_IMPROVEJA

##{ T_FB_INCREASE_VOL

body     T_FB_INCREASE_VOL        /\bincrease.{0,8}volume/
describe T_FB_INCREASE_VOL        Phrase: increase volume
##} T_FB_INCREASE_VOL

##{ T_FB_IOW

body     T_FB_IOW                 /\bIow\b/
describe T_FB_IOW                 Phrase: mis-spelled low, iow?
##} T_FB_IOW

##{ T_FB_LAON

body     T_FB_LAON                /\blaon\b/i
describe T_FB_LAON                Phrase: laon
##} T_FB_LAON

##{ T_FB_LATEST_OEM

body     T_FB_LATEST_OEM          /latest oem/i
describe T_FB_LATEST_OEM          Phrase: latest oem.
##} T_FB_LATEST_OEM

##{ T_FB_LIMITED_TIME

body     T_FB_LIMITED_TIME        /limited time promotion/i
describe T_FB_LIMITED_TIME        Phrase: limited time promotion
##} T_FB_LIMITED_TIME

##{ T_FB_MAGIC_TAB

body     T_FB_MAGIC_TAB           /\b(?:magic|this) tab\b/
describe T_FB_MAGIC_TAB           Phrase: this / magic tab.
##} T_FB_MAGIC_TAB

##{ T_FB_MAKE_MONEY

body     T_FB_MAKE_MONEY          /generate \$/i
describe T_FB_MAKE_MONEY          Phrase: generate $
##} T_FB_MAKE_MONEY

##{ T_FB_MASCULINE_PERF

body     T_FB_MASCULINE_PERF      /Masculine performance/i
describe T_FB_MASCULINE_PERF      Phrase: Masculine performance
##} T_FB_MASCULINE_PERF

##{ T_FB_MED1CAT

body     T_FB_MED1CAT             /\bmed1cat/i
describe T_FB_MED1CAT             Phrase: Med1cat
##} T_FB_MED1CAT

##{ T_FB_MEDS_PERCENT

body     T_FB_MEDS_PERCENT        /meds .{3,10}\d\s?%/i
describe T_FB_MEDS_PERCENT        Talks about meds and %
##} T_FB_MEDS_PERCENT

##{ T_FB_MEEDS

body     T_FB_MEEDS               /\bmeed[zs]\b/i
describe T_FB_MEEDS               Phrase: meed[zs]
##} T_FB_MEEDS

##{ T_FB_MORE_SEMEN

body     T_FB_MORE_SEMEN          /more semen/i
describe T_FB_MORE_SEMEN          Phrase: more semen
##} T_FB_MORE_SEMEN

##{ T_FB_MOST_QUALITY

body     T_FB_MOST_QUALITY        /Most quality products/i
describe T_FB_MOST_QUALITY        Phrase: Most quality products
##} T_FB_MOST_QUALITY

##{ T_FB_MOST_RECOG

body     T_FB_MOST_RECOG          /most recognized brands/i
describe T_FB_MOST_RECOG          Phrase: most recognized brands.
##} T_FB_MOST_RECOG

##{ T_FB_N3W

body     T_FB_N3W                 / n3w /i
describe T_FB_N3W                 Phrase: n3w
##} T_FB_N3W

##{ T_FB_NATIONALSURV

body     T_FB_NATIONALSURV        /NationalSurveyPanel/i
describe T_FB_NATIONALSURV        Phrase: NationalSurveyPanel
##} T_FB_NATIONALSURV

##{ T_FB_NEW_LOW_RATE

body     T_FB_NEW_LOW_RATE        /new low rate/i
describe T_FB_NEW_LOW_RATE        Phrase: new low rate
##} T_FB_NEW_LOW_RATE

##{ T_FB_NOT_CREDIT

body     T_FB_NOT_CREDIT          /\b(?!credit)cred[^i\s]{1,3}t\b/i
describe T_FB_NOT_CREDIT          Looks like credit but ain't.
##} T_FB_NOT_CREDIT

##{ T_FB_NOT_PHONE_NUM2

body     T_FB_NOT_PHONE_NUM2      /8(?:66|77|88|[0o][0o])[-\.\s\)]{1,3}(?!\d{3})[OIL0-9]{3}[-\.\s]/i
describe T_FB_NOT_PHONE_NUM2      Looks like a fake phone number (2)
##} T_FB_NOT_PHONE_NUM2

##{ T_FB_NOT_SEXUAL

body     T_FB_NOT_SEXUAL          /[^Ss]exual/
describe T_FB_NOT_SEXUAL          Almost Sexual but not.
##} T_FB_NOT_SEXUAL

##{ T_FB_NOW_NOW_NOW

body     T_FB_NOW_NOW_NOW         /NOW NOW NOW/
describe T_FB_NOW_NOW_NOW         Phrase: NOW NOW NOW
##} T_FB_NOW_NOW_NOW

##{ T_FB_NO_MORE_ADS

body     T_FB_NO_MORE_ADS         /no more ad/i
describe T_FB_NO_MORE_ADS         Phrase: no more ad
##} T_FB_NO_MORE_ADS

##{ T_FB_NO_MORE_HTTP

body     T_FB_NO_MORE_HTTP        /no\s?more.{0,5} http/i
describe T_FB_NO_MORE_HTTP        No more, the http
##} T_FB_NO_MORE_HTTP

##{ T_FB_NO_MORE_MAIL

body     T_FB_NO_MORE_MAIL        /No More (?:Mail|distribution)/i
describe T_FB_NO_MORE_MAIL        Phrase: no more mail, distribution
##} T_FB_NO_MORE_MAIL

##{ T_FB_NO_MORE_OFFER

body     T_FB_NO_MORE_OFFER       /No more offer/i
describe T_FB_NO_MORE_OFFER       Phrase: no more offer
##} T_FB_NO_MORE_OFFER

##{ T_FB_PA1N

body     T_FB_PA1N                /\bpa1n/i
describe T_FB_PA1N                Phrase: pa1n
##} T_FB_PA1N

##{ T_FB_PASTE_LINK

body     T_FB_PASTE_LINK          /paste link .{1,8}browser/i
describe T_FB_PASTE_LINK          Phrase: past link into browser
##} T_FB_PASTE_LINK

##{ T_FB_PC_DOCTOR

body     T_FB_PC_DOCTOR           /PC Doctor/i
describe T_FB_PC_DOCTOR           Phrase: PC Doctor
##} T_FB_PC_DOCTOR

##{ T_FB_PIPENEWSLETTER

body     T_FB_PIPENEWSLETTER      /news\|etter/i
describe T_FB_PIPENEWSLETTER      Phrase news|etter
##} T_FB_PIPENEWSLETTER

##{ T_FB_RANDOM_SPUR

body     T_FB_RANDOM_SPUR         /\{SPUR_\d{1,2}\}/i
describe T_FB_RANDOM_SPUR         Pattern Replacement Failure
##} T_FB_RANDOM_SPUR

##{ T_FB_REFI

body     T_FB_REFI                / Refi /i
describe T_FB_REFI                Phrase: Refi
##} T_FB_REFI

##{ T_FB_REM_PART

body     T_FB_REM_PART            /remov\W/i
describe T_FB_REM_PART            Looks like remove w/o e.
##} T_FB_REM_PART

##{ T_FB_REWARDS_GATE

body     T_FB_REWARDS_GATE        /Rewards Gateway/i
describe T_FB_REWARDS_GATE        Phrase: Rewards Gateway
##} T_FB_REWARDS_GATE

##{ T_FB_SMALL_PEN

body     T_FB_SMALL_PEN           /small p+e+n(?!sion)/i
describe T_FB_SMALL_PEN           Phrase: small pen
##} T_FB_SMALL_PEN

##{ T_FB_SPACED_CASH

body     T_FB_SPACED_CASH         /c a s h/i
describe T_FB_SPACED_CASH         Phrase: c a s h
##} T_FB_SPACED_CASH

##{ T_FB_SPACED_LOWER

body     T_FB_SPACED_LOWER        /L O W E R/i
describe T_FB_SPACED_LOWER        Phrase: l o w e r
##} T_FB_SPACED_LOWER

##{ T_FB_STAMINA_IN_BED

body     T_FB_STAMINA_IN_BED      /stamina in bed/i
describe T_FB_STAMINA_IN_BED      Phrase: stamina in bed.
##} T_FB_STAMINA_IN_BED

##{ T_FB_STOP_EMAILING

body     T_FB_STOP_EMAILING       /Stop e-?mailing me/i
describe T_FB_STOP_EMAILING       Phrase stop e-mailing me
##} T_FB_STOP_EMAILING

##{ T_FB_STREAM_OF

body     T_FB_STREAM_OF           /Watch the stream of (?:potential\s?)? customers/i
describe T_FB_STREAM_OF           Phrase: Watch the stream of customers
##} T_FB_STREAM_OF

##{ T_FB_STRONGER_EJ

body     T_FB_STRONGER_EJ         /stronger ejaculation/
describe T_FB_STRONGER_EJ         Phrase: stronger ejaculation
##} T_FB_STRONGER_EJ

##{ T_FB_SUPERBREWARD

body     T_FB_SUPERBREWARD        /\bSuperb\s?Rewards\b/i
describe T_FB_SUPERBREWARD        Phrase: Superb Rewards
##} T_FB_SUPERBREWARD

##{ T_FB_TIRED_OF_YOUR

body     T_FB_TIRED_OF_YOUR       /Tired of your/i
describe T_FB_TIRED_OF_YOUR       Phrase: Tired of your
##} T_FB_TIRED_OF_YOUR

##{ T_FB_UGGS_NOW

body     T_FB_UGGS_NOW            /Uggs Now/i
describe T_FB_UGGS_NOW            Phrase: uggs now
##} T_FB_UGGS_NOW

##{ T_FB_VERIFY_ZIP

body     T_FB_VERIFY_ZIP          /verify your zipcode/i
describe T_FB_VERIFY_ZIP          Phrase: verify your zipcode
##} T_FB_VERIFY_ZIP

##{ T_FB_V_SPACE_GRA

body     T_FB_V_SPACE_GRA         m'(?:V|\\/).{2,5} G R A [a-z]'
describe T_FB_V_SPACE_GRA         Looks like Viagra?
##} T_FB_V_SPACE_GRA

##{ T_FB_WHILECONNECTED

body     T_FB_WHILECONNECTED      /while connected to the internet/i
describe T_FB_WHILECONNECTED      Phrase: white connected to the internet
##} T_FB_WHILECONNECTED

##{ T_FB_WHITEGOLD

body     T_FB_WHITEGOLD           /white gold sound good/
describe T_FB_WHITEGOLD           Phrase: white gold sound good
##} T_FB_WHITEGOLD

##{ T_FB_WITHOUT_INCRE

body     T_FB_WITHOUT_INCRE       /without increasing your/i
describe T_FB_WITHOUT_INCRE       Phrase: without increasing your
##} T_FB_WITHOUT_INCRE

##{ T_FB_WITHOUT_PRESC

body     T_FB_WITHOUT_PRESC       /without a prescript/i
describe T_FB_WITHOUT_PRESC       Phrase: without a prescription.
##} T_FB_WITHOUT_PRESC

##{ T_FB_WORD1_END_DOLLAR

body     T_FB_WORD1_END_DOLLAR    / [a-z013]{3,6}\$ /i
describe T_FB_WORD1_END_DOLLAR    Looks like a word ending with a $
##} T_FB_WORD1_END_DOLLAR

##{ T_FB_WORD2_END_DOLLAR

body     T_FB_WORD2_END_DOLLAR    /\b[a-z013]{3,6}\$ /i
describe T_FB_WORD2_END_DOLLAR    Looks like a word ending with a $ (2)
##} T_FB_WORD2_END_DOLLAR

##{ T_FB_YOUR_MED

body     T_FB_YOUR_MED            /your med\b/
describe T_FB_YOUR_MED            Phrase: your med
##} T_FB_YOUR_MED

##{ T_FB_YOUR_MORTGAGE

body     T_FB_YOUR_MORTGAGE       /your mortgage/i
describe T_FB_YOUR_MORTGAGE       Phrase: Your Mortgage
##} T_FB_YOUR_MORTGAGE

##{ T_FB_YOUR_PC_ERROR

body     T_FB_YOUR_PC_ERROR       /your PC has error/i
describe T_FB_YOUR_PC_ERROR       Phrase: your pc has error
##} T_FB_YOUR_PC_ERROR

##{ T_FB_YOUR_REFILL

body     T_FB_YOUR_REFILL         /your refill/i
describe T_FB_YOUR_REFILL         Phrase: your refill
##} T_FB_YOUR_REFILL

##{ T_FB_YOUR_WEIGHT

body     T_FB_YOUR_WEIGHT         /about your weight/i
describe T_FB_YOUR_WEIGHT         Phrase: about your weight
##} T_FB_YOUR_WEIGHT

##{ T_FB_YOUR_WOMAN

body     T_FB_YOUR_WOMAN          /your woman will be/
describe T_FB_YOUR_WOMAN          Phrase: Your woman will be
##} T_FB_YOUR_WOMAN

##{ T_FB_YOUTH_THIS

body     T_FB_YOUTH_THIS          /YOUTH is BACK!/
describe T_FB_YOUTH_THIS          Phrase: Youth is Back!
##} T_FB_YOUTH_THIS

##{ T_FB_YOU_LOVE

body     T_FB_YOU_LOVE            /You love can/i
describe T_FB_YOU_LOVE            Phrase: you love can
##} T_FB_YOU_LOVE

##{ T_FF_COMMENT_ODD

full     T_FF_COMMENT_ODD         /<-\*->/
describe T_FF_COMMENT_ODD         FULL RULE: Special Comment
##} T_FF_COMMENT_ODD

##{ T_FF_IHOPE_YOU_SINK

full     T_FF_IHOPE_YOU_SINK      /(?:FLOAT.{10,300}){3}/is
describe T_FF_IHOPE_YOU_SINK      Triple Floats, common viagra signs.
##} T_FF_IHOPE_YOU_SINK

##{ T_FF_LEO_FLOAT_RIGHT

full     T_FF_LEO_FLOAT_RIGHT     /FLOAT[\r\n]{1,2}:[\r\n]{1,2}RIGHT/i
describe T_FF_LEO_FLOAT_RIGHT     FULL RULE: Float, Right, Special signs!
##} T_FF_LEO_FLOAT_RIGHT

##{ T_FH_BAD_MSOE14

header   T_FH_BAD_MSOE14          X-Mailer =~ /^Microsoft Outlook Express 6\.00\.1400\.14$/
describe T_FH_BAD_MSOE14          Bad OE version
##} T_FH_BAD_MSOE14

##{ T_FH_FROM_RND_1

header   T_FH_FROM_RND_1          From =~ /%(?:from|RND_)/
describe T_FH_FROM_RND_1          From has pattern replacement broken.
##} T_FH_FROM_RND_1

##{ T_FH_FROM_START_YOU

header   T_FH_FROM_START_YOU      From =~ /^You\b/i
describe T_FH_FROM_START_YOU      From starts with you.
##} T_FH_FROM_START_YOU

##{ T_FH_HAS_UID

header   T_FH_HAS_UID             exists:UID
describe T_FH_HAS_UID             Header UID found.
##} T_FH_HAS_UID

##{ T_FH_HAS_X

header   T_FH_HAS_X               exists:X
describe T_FH_HAS_X               Has X: header
##} T_FH_HAS_X

##{ T_FH_HAS_XBBO

header   T_FH_HAS_XBBO            exists:X-BBounce
describe T_FH_HAS_XBBO            Has X-BBounce
##} T_FH_HAS_XBBO

##{ T_FH_HAS_XCVBN

header   T_FH_HAS_XCVBN           exists:X-CVBN
describe T_FH_HAS_XCVBN           Has X-CVBN header
##} T_FH_HAS_XCVBN

##{ T_FH_HAS_XFGHJ

header   T_FH_HAS_XFGHJ           exists:X-FGHJ
describe T_FH_HAS_XFGHJ           Has X-FGHJ
##} T_FH_HAS_XFGHJ

##{ T_FH_HAS_XOVE

header   T_FH_HAS_XOVE            exists:X-OVE
describe T_FH_HAS_XOVE            Has X-OVE
##} T_FH_HAS_XOVE

##{ T_FH_HAS_XUIOP

header   T_FH_HAS_XUIOP           exists:X-UIOP
describe T_FH_HAS_XUIOP           Has X-UIOP
##} T_FH_HAS_XUIOP

##{ T_FH_HAS_X_WBC

header   T_FH_HAS_X_WBC           exists:X-WBC
describe T_FH_HAS_X_WBC           Has X-WBC header
##} T_FH_HAS_X_WBC

##{ T_FH_HOST_EQ_SPRINT_H

header   T_FH_HOST_EQ_SPRINT_H    X-Spam-Relays-External =~ /^[^\]]+ rdns=[^ ]+\.dhcp\.sprint-hsd\.net /
describe T_FH_HOST_EQ_SPRINT_H    Host is dhcp sprint-hsd.net
##} T_FH_HOST_EQ_SPRINT_H

##{ T_FH_MSGID_DIGIT

header   T_FH_MSGID_DIGIT         MESSAGEID =~ /\{DIGIT\}/
describe T_FH_MSGID_DIGIT         Forgot Pattern Replacement?
##} T_FH_MSGID_DIGIT

##{ T_FH_RANDOM_SURE

meta     T_FH_RANDOM_SURE         (__ALL_RANDOM || __RAW_RANDOM)
describe T_FH_RANDOM_SURE         SARE Random in one rule.
##} T_FH_RANDOM_SURE

##{ T_FH_RCVD_FROM_2_WDS

header   T_FH_RCVD_FROM_2_WDS     Received =~ /from \w+ \w+ by/i
describe T_FH_RCVD_FROM_2_WDS     RCVD line has 2 words after from.
##} T_FH_RCVD_FROM_2_WDS

##{ T_FH_RCVD_HELODATE

header   T_FH_RCVD_HELODATE       Received =~ /from \[(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun)/
describe T_FH_RCVD_HELODATE       The HELO Looks like a date?
##} T_FH_RCVD_HELODATE

##{ T_FH_SPOOF_NAMES

header   T_FH_SPOOF_NAMES         ALL =~ /\$names\@/i
describe T_FH_SPOOF_NAMES         Pattern Replacement Failure
##} T_FH_SPOOF_NAMES

##{ T_FH_USER_MOZILLA_SMAL

header   T_FH_USER_MOZILLA_SMAL   user-agent =~ /mozilla/
describe T_FH_USER_MOZILLA_SMAL   Specific signs of ratware
##} T_FH_USER_MOZILLA_SMAL

##{ T_FH_VIRUS_NORTON

header   T_FH_VIRUS_NORTON        X-Virus-Status =~ /Scanned by norton/
describe T_FH_VIRUS_NORTON        Does Norton really not have caps?
##} T_FH_VIRUS_NORTON

##{ T_FH_XCOMMENT_GIBBER

header   T_FH_XCOMMENT_GIBBER     X-Comment =~ /[a-z]{15}/i
describe T_FH_XCOMMENT_GIBBER     X-Comment is gibberish
##} T_FH_XCOMMENT_GIBBER

##{ T_FH_XCON_HAS_EQ

header   T_FH_XCON_HAS_EQ         X-Contact =~ /=/
describe T_FH_XCON_HAS_EQ         X-Contact has =
##} T_FH_XCON_HAS_EQ

##{ T_FH_XMAIL_HEX20

header   T_FH_XMAIL_HEX20         X-Mailer =~ /^[A-F0-9]{6,10}\.[A-F0-9]{6,10}\.[a-f0-9]{6,10}/
describe T_FH_XMAIL_HEX20         Special HEX X-Mailer
##} T_FH_XMAIL_HEX20

##{ T_FH_XMAIL_RND_833

header   T_FH_XMAIL_RND_833       X-Mailer =~ /^[a-z]{3}\sv8\.3\.3\./
describe T_FH_XMAIL_RND_833       Special X-Mailer Version
##} T_FH_XMAIL_RND_833

##{ T_FH_X_REFS_DDD

header   T_FH_X_REFS_DDD          X-References =~ /^\d{1,5}$/
describe T_FH_X_REFS_DDD          X-Refs with digits.
##} T_FH_X_REFS_DDD

##{ T_FM_APPROVE_COMPLETE

meta     T_FM_APPROVE_COMPLETE    (__BEEN_APPROVED && __CAN_HELP && __COMPLETE_REVIEW)
describe T_FM_APPROVE_COMPLETE    Meta approved complete review
##} T_FM_APPROVE_COMPLETE

##{ T_FM_ASCII_ART_SPACINGc

meta     T_FM_ASCII_ART_SPACINGc  ((__FR_SPACING_8 + __FR_SPACING_9 + __FR_SPACING_15 + __FR_SPACING_17 + __FR_SPACING_22) > 3)
describe T_FM_ASCII_ART_SPACINGc  Looks like might be ASCII
##} T_FM_ASCII_ART_SPACINGc

##{ T_FM_BIG_REASON

meta     T_FM_BIG_REASON          ((__FB_BIG + __FB_REASON + __FB_BEST) > 1)
describe T_FM_BIG_REASON          Lot's of CAP words, BIG, REASON, BEST
##} T_FM_BIG_REASON

##{ T_FM_CLAIM_IPOD

meta     T_FM_CLAIM_IPOD          ((__FS_CLAIM_YOUR || __FS_FREE) && (__FS_IPODXBOX || __FS_MP3PLAY))
describe T_FM_CLAIM_IPOD          Looks like u should claim your ipod.
##} T_FM_CLAIM_IPOD

##{ T_FM_COKE_PEPSI

meta     T_FM_COKE_PEPSI          (__FS_COKE && __FS_PEPSI)
describe T_FM_COKE_PEPSI          Subject has both Coke and Pepsi
##} T_FM_COKE_PEPSI

##{ T_FM_CONG_GIFTCARD

meta     T_FM_CONG_GIFTCARD       ((__CONGRADULAT || __GETYOUR) && __GIFTCERT)
describe T_FM_CONG_GIFTCARD       Talks about gift cards and congrads.
##} T_FM_CONG_GIFTCARD

##{ T_FM_COSTA_RICA

meta     T_FM_COSTA_RICA          ((__OWN_LAND || __OWN_PROP) && __COSTA_RI && __FB_TOUR)
describe T_FM_COSTA_RICA          Looks like Costa Rica spams.
##} T_FM_COSTA_RICA

##{ T_FM_CUSTOMLOGODSGNc

meta     T_FM_CUSTOMLOGODSGNc     (__FB_CUSTOM_LOGO && (__FB_LOGO_DESIGN || __FB_CUSTOM_RECOG || __FB_TARGET_AUDIEN))
describe T_FM_CUSTOMLOGODSGNc     Custom Designed Logos
##} T_FM_CUSTOMLOGODSGNc

##{ T_FM_DEBT_HELP

meta     T_FM_DEBT_HELP           (__FS_DEBT && __FS_HELP)
describe T_FM_DEBT_HELP           Subject says debt and help.
##} T_FM_DEBT_HELP

##{ T_FM_FORGED_GMAIL

meta     T_FM_FORGED_GMAIL        (__MSGID_GMAIL && !__FROM_GMAIL)
describe T_FM_FORGED_GMAIL        Looks like a forged gmail msg?
##} T_FM_FORGED_GMAIL

##{ T_FM_FUCK_ASS_TEEN

meta     T_FM_FUCK_ASS_TEEN       (__F_FUCK && __F_ASS && __F_TEEN)
##} T_FM_FUCK_ASS_TEEN

##{ T_FM_GET_CASH_SURVEY

meta     T_FM_GET_CASH_SURVEY     (T_FB_GET_XXX_CASH && __SURVEY)
describe T_FM_GET_CASH_SURVEY     Meta Get Cash + Survey
##} T_FM_GET_CASH_SURVEY

##{ T_FM_GOOD_ENF_CREDIT

meta     T_FM_GOOD_ENF_CREDIT     (__YOUR_CREDIT && __GOOD_ENOUGH)
describe T_FM_GOOD_ENF_CREDIT     Meta Good enough credit
##} T_FM_GOOD_ENF_CREDIT

##{ T_FM_HOW_IMG_COST

meta     T_FM_HOW_IMG_COST        (__FS_HOWMUCH && __FS_IMAGE && __FS_COST)
describe T_FM_HOW_IMG_COST        How much does your image cost?
##} T_FM_HOW_IMG_COST

##{ T_FM_HOW_IMG_COST2

meta     T_FM_HOW_IMG_COST2       (__FM_HOW_COST_ID && __FM_YOUR_IMAGE)
describe T_FM_HOW_IMG_COST2       How much does your image cost? (2)
##} T_FM_HOW_IMG_COST2

##{ T_FM_LEND_MONEY

meta     T_FM_LEND_MONEY          (__NUMBERS_IN_SUBJ && __FS_LEND)
describe T_FM_LEND_MONEY          Subject has ddd + lend!
##} T_FM_LEND_MONEY

##{ T_FM_LOAN_NUM_DOMAIN

meta     T_FM_LOAN_NUM_DOMAIN     (__FU_LOAN && __DOMAIN_WITH_NUMS)
describe T_FM_LOAN_NUM_DOMAIN     Loan and numbers in .com
##} T_FM_LOAN_NUM_DOMAIN

##{ T_FM_LOTTO_MONEY

meta     T_FM_LOTTO_MONEY         (__FM_LARGE_MONEY && __FM_NAT_LOTTERY)
describe T_FM_LOTTO_MONEY         Talks about lotto and large money!
##} T_FM_LOTTO_MONEY

##{ T_FM_LOWER_CASE_HEAD

meta     T_FM_LOWER_CASE_HEAD     (__SUBJ_LOWER && __FROM_LOWER && __TO___LOWER && __DATE_LOWER)
describe T_FM_LOWER_CASE_HEAD     Lots of headers with lower case.
##} T_FM_LOWER_CASE_HEAD

##{ T_FM_MAKE_MONEY_HOME

meta     T_FM_MAKE_MONEY_HOME     (__FB_GENERATE && __FB_FIND_OUT && __FB_FROM_YOUR && __FB_HOME_HOUSE)
describe T_FM_MAKE_MONEY_HOME     Making money from home.
##} T_FM_MAKE_MONEY_HOME

##{ T_FM_MEDS_SUBJ_2WDS

meta     T_FM_MEDS_SUBJ_2WDS      ((__FB_YOUR_MEDS || T_FB_MEDS_PERCENT) && __FS_RE_TWO_WORDS)
describe T_FM_MEDS_SUBJ_2WDS      Talks about Meds, Re: two words.
##} T_FM_MEDS_SUBJ_2WDS

##{ T_FM_MORTGAGE3PLUS

meta     T_FM_MORTGAGE3PLUS       (__FM_MORTGAGE3PLUS && !__FM_MORTGAGE4PLUS && !__FM_MORTGAGE5PLUS && !__FM_MORTGAGE6PLUS)
describe T_FM_MORTGAGE3PLUS       Looks like a mortgage spam (3+)
##} T_FM_MORTGAGE3PLUS

##{ T_FM_MORTGAGE4PLUS

meta     T_FM_MORTGAGE4PLUS       (__FM_MORTGAGE4PLUS && !__FM_MORTGAGE5PLUS && !__FM_MORTGAGE6PLUS)
describe T_FM_MORTGAGE4PLUS       Looks like a mortgage spam (4+)
##} T_FM_MORTGAGE4PLUS

##{ T_FM_NIKE_ADIDAS

meta     T_FM_NIKE_ADIDAS         (__FS_ADIDAS && __FS_NIKE)
describe T_FM_NIKE_ADIDAS         Meta Nike & Adidas
##} T_FM_NIKE_ADIDAS

##{ T_FM_PAYING_LOWER

meta     T_FM_PAYING_LOWER        (FB_LOWER_PAYM && __FB_YOU_ARE_PAYING)
describe T_FM_PAYING_LOWER        Meta You are paying too much...
##} T_FM_PAYING_LOWER

##{ T_FM_PC_ERROR_DBL

meta     T_FM_PC_ERROR_DBL        (T_FB_YOUR_PC_ERROR && (T_FS_YOUR_COMPUTER || T_FB_PC_DOCTOR))
describe T_FM_PC_ERROR_DBL        Combo Meta of multiple rules.
##} T_FM_PC_ERROR_DBL

##{ T_FM_PEOPLE_LOOK_4ME

meta     T_FM_PEOPLE_LOOK_4ME     (__FB_PPLE_ARE_SEARCH && __FB_COULD_NOT_F)
describe T_FM_PEOPLE_LOOK_4ME     People are looking for me?
##} T_FM_PEOPLE_LOOK_4ME

##{ T_FM_REPLY_OR_NOT

meta     T_FM_REPLY_OR_NOT        (__FB_DO_NOT_REPLY && __FB_EMAIL_ME_BAC)
describe T_FM_REPLY_OR_NOT        Meta do they want a reply or not?
##} T_FM_REPLY_OR_NOT

##{ T_FM_SUB_TEEN_NUDE

meta     T_FM_SUB_TEEN_NUDE       (FS_NUDE && __FS_TEEN)
describe T_FM_SUB_TEEN_NUDE       Subject says teen and nude
##} T_FM_SUB_TEEN_NUDE

##{ T_FM_WEIGHT_LOSS

meta     T_FM_WEIGHT_LOSS         ((__SEEN_ON_ABC + __SEEN_ON_CNN + __SEEN_ON_NBC + __SEEN_ON_CBS + __LOSE_WEIGHT + __SEEN_ON_OPRAH) > 3)
describe T_FM_WEIGHT_LOSS         Looks like oprah weight loss spam.
##} T_FM_WEIGHT_LOSS

##{ T_FM_XREF_CLICKPHP

meta     T_FM_XREF_CLICKPHP       (T_FU_CLICK_PHP_DDD && T_FH_X_REFS_DDD)
describe T_FM_XREF_CLICKPHP       Whatever it takes!
##} T_FM_XREF_CLICKPHP

##{ T_FORGED_HOTMAIL_RCVD3

meta	 T_FORGED_HOTMAIL_RCVD3	__HOST_HOTMAIL && (!__HOTMAIL_HELO || __DOS_SINGLE_EXT_RELAY)
##} T_FORGED_HOTMAIL_RCVD3

##{ T_FORGED_RELAY_MUA_TO_MX

header T_FORGED_RELAY_MUA_TO_MX         X-Spam-Relays-External =~ /^\[ ip=(?!127)([\d.]+) [^\[]*\[ ip=\1 [^\[]+ helo=(!(?!(?:10|127|169\.254|172\.(?:1[6-9]|2[0-9]|3[01])|192\.168)\.)| )[^\[]+$/
##} T_FORGED_RELAY_MUA_TO_MX

##{ T_FORGED_SPF_HELO

meta	 T_FORGED_SPF_HELO	__HELO_NOT_RDNS && SPF_HELO_PASS && !SPF_PASS
##} T_FORGED_SPF_HELO

##{ T_FORGED_TBIRD_IMG_ARROW

meta       T_FORGED_TBIRD_IMG_ARROW  __FORGED_TBIRD_IMG && __TO_NO_ARROWS_R && !__TO_UNDISCLOSED
describe   T_FORGED_TBIRD_IMG_ARROW  Likely forged Thunderbird image spam
##} T_FORGED_TBIRD_IMG_ARROW

##{ T_FORGED_TBIRD_IMG_TO_MX

meta       T_FORGED_TBIRD_IMG_TO_MX  __FORGED_TBIRD_IMG && __DOS_DIRECT_TO_MX
describe   T_FORGED_TBIRD_IMG_TO_MX  Likely forged Thunderbird image spam
##} T_FORGED_TBIRD_IMG_TO_MX

##{ T_FORGED_URL_DOM

meta	 T_FORGED_URL_DOM	__FORGED_URL_DOM_1 || __FORGED_URL_DOM_2
describe T_FORGED_URL_DOM	Link domain has a TLD as a subdomain
##} T_FORGED_URL_DOM

##{ T_FORM_FRAUD

meta     T_FORM_FRAUD       __FORM_FRAUD && !__DOS_HAS_LIST_UNSUB && !__THREADED && !__HAS_THREAD_INDEX && !__VIA_ML && !__HTML_LINK_IMAGE && !__COMMENT_EXISTS && !__NOT_SPOOFED && !__UPPERCASE_URI && !__UNSUB_LINK
describe T_FORM_FRAUD       Fill a form and a fraud phrase
tflags   T_FORM_FRAUD       nopublish
##} T_FORM_FRAUD

##{ T_FORM_LOW_CONTRAST

meta        T_FORM_LOW_CONTRAST     __FORM_LOW_CONTRAST && !__BUGGED_IMG && !__HAS_REPLY_TO && !__DKIM_EXISTS && !__DOS_HAS_LIST_UNSUB && !__MSGID_JAVAMAIL
describe    T_FORM_LOW_CONTRAST     Fill in a form with hidden text
#score       T_FORM_LOW_CONTRAST     3.00	# Limit
##} T_FORM_LOW_CONTRAST

##{ T_FOUND_YOU

meta        T_FOUND_YOU          __FOUND_YOU && !__MIME_QP && !__CTYPE_HAS_BOUNDARY && !__LOCAL_PP_NONPPURL && !__RCD_RDNS_MAIL_MESSY && !__DKIM_EXISTS && !__SUBJ_RE && !__HAS_X_REF && !__RP_MATCHES_RCVD && !__TO_NO_ARROWS_R
#score       T_FOUND_YOU          3.25	# limit
describe    T_FOUND_YOU          I found you...
##} T_FOUND_YOU

##{ T_FROM_2_EMAILS

header	 T_FROM_2_EMAILS	From =~ /([^\@]{2,}\@[^\@]{2,60}\.\w\w).*(?!\1)[^\@]{2,}\@[^\@]/
describe T_FROM_2_EMAILS	Sender claims to have a different email
##} T_FROM_2_EMAILS

##{ T_FROM_ADDR_BCDE

header   T_FROM_ADDR_BCDE  From:addr =~ /^(?:[bcde][a-z]){16,}\@/
describe T_FROM_ADDR_BCDE  Alternating random address, BCDE
tflags   T_FROM_ADDR_BCDE  nopublish
##} T_FROM_ADDR_BCDE

##{ T_FROM_MISSP_DYNIP

meta           T_FROM_MISSP_DYNIP      __FROM_RUNON && RDNS_DYNAMIC
describe       T_FROM_MISSP_DYNIP      From misspaced + dynamic rDNS
##} T_FROM_MISSP_DYNIP

##{ T_FROM_ONE_CHAR

header      T_FROM_ONE_CHAR          From =~ /^\s*"[^"]"\s*</
describe    T_FROM_ONE_CHAR          Bogus FROM name
##} T_FROM_ONE_CHAR

##{ T_FROM_SPACE_COMMA

header   T_FROM_SPACE_COMMA	From =~ /\w+ <\w+ \w+\.\d+[^,@]+,@[a-z0-9.-]+>/i
describe T_FROM_SPACE_COMMA	Distinctive syntax error in from address
##} T_FROM_SPACE_COMMA

##{ T_FROM_UNBAL1

header   T_FROM_UNBAL1	From:raw =~ / < [^>]* $/xm
describe T_FROM_UNBAL1	From with unbalanced angle brackets, '>' missing
##} T_FROM_UNBAL1

##{ T_FROM_UNBAL2

header   T_FROM_UNBAL2	From:raw =~ /^ [^<]* > /xm
describe T_FROM_UNBAL2	From with unbalanced angle brackets, '<' missing
##} T_FROM_UNBAL2

##{ T_FROM_URI

meta           T_FROM_URI                   __FROM_URI_1 || __FROM_URI_2
describe       T_FROM_URI                   URI or www. in From
##} T_FROM_URI

##{ T_FROM_WEBSITE

header	 T_FROM_WEBSITE	From:raw =~ m'\b(?:f|ht)tps?://[^\s"</\@]{3,60}\.\w\w'i
describe T_FROM_WEBSITE	Sender name appears to be a link
##} T_FROM_WEBSITE

##{ T_FROM_WSP_LEAD

header   T_FROM_WSP_LEAD 	From:raw =~ /< \s+ [^>\s] [^>]* > [^<>]* \z/xm
describe T_FROM_WSP_LEAD	Leading whitespace after '<' in From header field
##} T_FROM_WSP_LEAD

##{ T_FROM_WSP_TRAIL

header   T_FROM_WSP_TRAIL	From:raw =~ /< [^>]* \s > [^<>]* \z/xm
describe T_FROM_WSP_TRAIL	Trailing whitespace before '>' in From header field
##} T_FROM_WSP_TRAIL

##{ T_FROM_WWW

header	 T_FROM_WWW	From:name =~ /\bwww\.[^\s"<\/\@]{4,60}\.\w\w/i
describe T_FROM_WWW	Sender name appears to be a website
##} T_FROM_WWW

##{ T_FR_COMMENT_ODD

rawbody  T_FR_COMMENT_ODD         /<-\*->/
describe T_FR_COMMENT_ODD         Strange HTML comment.
##} T_FR_COMMENT_ODD

##{ T_FR_DIV_DRUGS_3

rawbody  T_FR_DIV_DRUGS_3         m'(?:<DIV[^>]{0,20}> (?:<STRONG> )?[a-z0-9$] (?:</STRONG> )?</DIV> ){3}'i
describe T_FR_DIV_DRUGS_3         Looks like many div's in drug spam.
##} T_FR_DIV_DRUGS_3

##{ T_FR_DOT_FEVER_5

rawbody  T_FR_DOT_FEVER_5         /(?:[a-z ']{2,35}\s[.,]\s){5}/
describe T_FR_DOT_FEVER_5         Lots of dots inbetween letters.
##} T_FR_DOT_FEVER_5

##{ T_FR_IMPORT_CSS

rawbody  T_FR_IMPORT_CSS          /\@import url\(/i
describe T_FR_IMPORT_CSS          Special @import url css
##} T_FR_IMPORT_CSS

##{ T_FR_M_E_D_S

rawbody  T_FR_M_E_D_S             /M E D S/i
describe T_FR_M_E_D_S             Spaced out M E D S
##} T_FR_M_E_D_S

##{ T_FR_PORN_NOT_URL

rawbody  T_FR_PORN_NOT_URL        /\b,(?:hVX|WeQ|VSd|WeQ)\b/
describe T_FR_PORN_NOT_URL        Looks like a porn url seen before.
##} T_FR_PORN_NOT_URL

##{ T_FR_P_END_P_MANY10

rawbody  T_FR_P_END_P_MANY10      m'(?:<p></p>){10}'i
describe T_FR_P_END_P_MANY10      Many <p></p> (10)
##} T_FR_P_END_P_MANY10

##{ T_FR_TEST_BASE64_BAD

rawbody  T_FR_TEST_BASE64_BAD     /[a-z0-9]{70}<BR>/i
describe T_FR_TEST_BASE64_BAD     Looks like bad BASE64 with <br> at end.
##} T_FR_TEST_BASE64_BAD

##{ T_FR_TITLE_CONS_6

rawbody  T_FR_TITLE_CONS_6        m'<title>.{0,4}[bcdfgjklmnpqrstvwxyz]{6}.{0,25}</title>'i
describe T_FR_TITLE_CONS_6        Title Attribute has 6 non-vowels.
##} T_FR_TITLE_CONS_6

##{ T_FR_WATCHES_HTTP

rawbody  T_FR_WATCHES_HTTP        m'watches\s(?:\w+)?\s?http://'i
describe T_FR_WATCHES_HTTP        Watches http://
##} T_FR_WATCHES_HTTP

##{ T_FSL_ABUSED_WEB_1

header   T_FSL_ABUSED_WEB_1       exists:X-AntiAbuse
#score    T_FSL_ABUSED_WEB_1       0.01
describe T_FSL_ABUSED_WEB_1       Has X-AntiAbuse header
##} T_FSL_ABUSED_WEB_1

##{ T_FSL_ABUSED_WEB_2

header   T_FSL_ABUSED_WEB_2       exists:X-PHP-Script
#score    T_FSL_ABUSED_WEB_2       0.01
describe T_FSL_ABUSED_WEB_2       Has X-PHP-Script header
##} T_FSL_ABUSED_WEB_2

##{ T_FSL_ABUSED_WEB_3

header   T_FSL_ABUSED_WEB_3       exists:X-PHP-Originating-Script
#score    T_FSL_ABUSED_WEB_3       0.01
describe T_FSL_ABUSED_WEB_3       Has X-PHP-Originating-Script header
##} T_FSL_ABUSED_WEB_3

##{ T_FSL_ADV

body     T_FSL_ADV                /\bThis(?:\s*is an)? advert(?:isement)?\b/i
#score    T_FSL_ADV                1.0
describe T_FSL_ADV                This is an advertisement
##} T_FSL_ADV

##{ T_FSL_BLOGSPOT_ABUSE

uri T_FSL_BLOGSPOT_ABUSE /\/\S+\.blogspot\.com/
##} T_FSL_BLOGSPOT_ABUSE

##{ T_FSL_BODY_SEO

meta     T_FSL_BODY_SEO          (__FSL_BODY_SEO_1 || __FSL_BODY_SEO_2)
describe T_FSL_BODY_SEO          Search engine optimisation
#score    T_FSL_BODY_SEO          1.0
##} T_FSL_BODY_SEO

##{ T_FSL_BOTSPAM_1

rawbody  T_FSL_BOTSPAM_1   /^[^\n]+\nhttp:\/\/[^\n]+\.ru\/\n$/s
describe T_FSL_BOTSPAM_1   Two-line spam with URI pointing to .ru domain
##} T_FSL_BOTSPAM_1

##{ T_FSL_BOTSPAM_2

rawbody  T_FSL_BOTSPAM_2   /alt="Click here to show image"/
##} T_FSL_BOTSPAM_2

##{ T_FSL_BOTSPAM_3

rawbody  T_FSL_BOTSPAM_3   /<img alt="\*\*\* Click here \*\*\*"/
##} T_FSL_BOTSPAM_3

##{ T_FSL_BOTSPAM_4

rawbody  T_FSL_BOTSPAM_4   /Sorry for taking your time\.\./
##} T_FSL_BOTSPAM_4

##{ T_FSL_BULK_SIG

meta     T_FSL_BULK_SIG          ((DCC_CHECK || RAZOR2_CHECK || PYZOR_CHECK) && !__FSL_HAS_LIST_UNSUB)
describe T_FSL_BULK_SIG          Bulk signature with no Unsubscribe
##} T_FSL_BULK_SIG

##{ T_FSL_CREATEPDF_ABUSE

uri T_FSL_CREATEPDF_ABUSE /http(?:s)?:\/\/createpdf\.adobe\.com\/cgi-pickup.pl\//
##} T_FSL_CREATEPDF_ABUSE

##{ T_FSL_CSS_NO_DISPLAY

rawbody  T_FSL_CSS_NO_DISPLAY      /display:[^:]+\bnone\b/i
##} T_FSL_CSS_NO_DISPLAY

##{ T_FSL_FAKE_RCVD

header  T_FSL_FAKE_RCVD           Received =~ /^from \S+ by \S+; \S+, \d+ \S+ \d{4} \d+:\d+:\d+ \+\d+$/
##} T_FSL_FAKE_RCVD

##{ T_FSL_FAKE_YAHOO_RCVD

header  T_FSL_FAKE_YAHOO_RCVD     X-Spam-Relays-External =~ /mx\.mail\.yahoo.com/
##} T_FSL_FAKE_YAHOO_RCVD

##{ T_FSL_FBOOK_PHISH

uri T_FSL_FBOOK_PHISH /\/\S+\..+\/facebook\.com/
##} T_FSL_FBOOK_PHISH

##{ T_FSL_FRAUD_FROM_41

meta     T_FSL_FRAUD_FROM_41     (__FSL_IPV4_41 && (LOTS_OF_MONEY || T_FSL_MY_NAME_IS || T_FSL_I_AM || __FSL_URGENT_ASSIST || __FSL_MAIL_HAS || __FSL_SUBJECT_EMAIL || __FSL_ATM_CARD))
#score    T_FSL_FRAUD_FROM_41     1.0
##} T_FSL_FRAUD_FROM_41

##{ T_FSL_FREEMAIL_SEO

meta     T_FSL_FREEMAIL_SEO      (FREEMAIL_FROM && (T_FSL_SUBJ_SEO || T_FSL_BODY_SEO))
describe T_FSL_FREEMAIL_SEO      Freemail account offering SEO
#score    T_FSL_FREEMAIL_SEO      5.0
##} T_FSL_FREEMAIL_SEO

##{ T_FSL_FRIEND_SPAM

meta     T_FSL_FRIEND_SPAM         (__FSL_FROM_EQ_REPTO && __FSL_FRIEND_SPAM && FREEMAIL_REPLYTO)
#score    T_FSL_FRIEND_SPAM         10.0
##} T_FSL_FRIEND_SPAM

##{ T_FSL_FROM_INFO_DOM

header   T_FSL_FROM_INFO_DOM      From:addr =~ /\.info$/
#score    T_FSL_FROM_INFO_DOM      1.0
describe T_FSL_FROM_INFO_DOM      From address is in .info
##} T_FSL_FROM_INFO_DOM

##{ T_FSL_GD1_URI

uri T_FSL_GD1_URI /\/\S+\.docs\.google\.com/
##} T_FSL_GD1_URI

##{ T_FSL_GD2_URI

uri T_FSL_GD2_URI /\/docs\.google\.com\/Doc\?id=\S+/
##} T_FSL_GD2_URI

##{ T_FSL_GG_ABUSE

uri T_FSL_GG_ABUSE /\/google\.com\/group\/\S+\/web\//
##} T_FSL_GG_ABUSE

##{ T_FSL_GS_ABUSE

uri T_FSL_GS_ABUSE /\/sites\.google\.com\/site\//
##} T_FSL_GS_ABUSE

##{ T_FSL_HAS_TINYURL

uri T_FSL_HAS_TINYURL /tinyurl\.com\//
##} T_FSL_HAS_TINYURL

##{ T_FSL_HELO_FAKE

header  T_FSL_HELO_FAKE           X-Spam-Relays-External =~ /\bhelo=(?:yandex.ru|(?:hotmail|gmail|google|yahoo|msn|microsoft)\.com)\b/i
##} T_FSL_HELO_FAKE

##{ T_FSL_HELO_FIREWALL

header  T_FSL_HELO_FIREWALL       X-Spam-Relays-External =~ /\bhelo=\S+\.firewall\b/i
##} T_FSL_HELO_FIREWALL

##{ T_FSL_HELO_HOME

header  T_FSL_HELO_HOME           X-Spam-Relays-External =~ /\bhelo=\S+\.home\b/i
##} T_FSL_HELO_HOME

##{ T_FSL_HELO_LITERAL

header  T_FSL_HELO_LITERAL        X-Spam-Relays-External =~ /\bhelo=\[\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\]\b/i
##} T_FSL_HELO_LITERAL

##{ T_FSL_HELO_NON_FQDN_2

header  T_FSL_HELO_NON_FQDN_2     X-Spam-Relays-External =~ /\bhelo=[a-zA-Z0-9-_]+\b/i
##} T_FSL_HELO_NON_FQDN_2

##{ T_FSL_HELO_UNKNOWN

header  T_FSL_HELO_UNKNOWN        X-Spam-Relays-External =~ /\bhelo=unkown\b/i
##} T_FSL_HELO_UNKNOWN

##{ T_FSL_HTML_COMMENT

rawbody  T_FSL_HTML_COMMENT        /<!--/
##} T_FSL_HTML_COMMENT

##{ T_FSL_I_AM

body     T_FSL_I_AM              /^I(?:'m| am)(?! a | by | pretty | very | excited | seeking )\s*[a-zA-Z.-]+(?:\s*\S+){1,3}(?:\s*from\s*\S+[,.]|[,.])/
describe T_FSL_I_AM              I am ...
#score    T_FSL_I_AM              0.1
##} T_FSL_I_AM

##{ T_FSL_LINK_AWS_S3_WEB

uri      T_FSL_LINK_AWS_S3_WEB    /http:\/\/[^. ]+\.s3-website-[^. ]+\.amazonaws\.com/i
describe T_FSL_LINK_AWS_S3_WEB    Contains a link to Amazon S3 website
##} T_FSL_LINK_AWS_S3_WEB

##{ T_FSL_LINK_AWS_S3_WEB_FM

meta     T_FSL_LINK_AWS_S3_WEB_FM (FREEMAIL_FROM && T_FSL_LINK_AWS_S3_WEB)
describe T_FSL_LINK_AWS_S3_WEB_FM Contains a link to Amazon S3 website and from a Freemail address
##} T_FSL_LINK_AWS_S3_WEB_FM

##{ T_FSL_LSPACES_ABUSE

uri T_FSL_LSPACES_ABUSE /cid\-\S+\.spaces\.live\.com/
##} T_FSL_LSPACES_ABUSE

##{ T_FSL_MIME_NO_TEXT

meta    T_FSL_MIME_NO_TEXT        (__CTYPE_MULTIPART_MIXED && !__ANY_TEXT_ATTACH_DOC)
##} T_FSL_MIME_NO_TEXT

##{ T_FSL_MY_NAME_IS

body     T_FSL_MY_NAME_IS        /\bmy name is\b/i
describe T_FSL_MY_NAME_IS        My name is ...
##} T_FSL_MY_NAME_IS

##{ T_FSL_NEW_HELO_USER

meta    T_FSL_NEW_HELO_USER   (__FSL_HELO_USER_1 || __FSL_HELO_USER_2 || __FSL_HELO_USER_3)
##} T_FSL_NEW_HELO_USER

##{ T_FSL_NOT_FROM_AOL

meta     T_FSL_NOT_FROM_AOL       __FSL_ENVFROM_AOL && !__FSL_RELAY_AOL
#score    T_FSL_NOT_FROM_AOL       2.0
describe T_FSL_NOT_FROM_AOL       Envelope-From AOL but not originated from AOL systems
##} T_FSL_NOT_FROM_AOL

##{ T_FSL_NOT_FROM_GOOGLE

meta     T_FSL_NOT_FROM_GOOGLE	__FSL_ENVFROM_GOOGLE && !__FSL_RELAY_GOOGLE
#score    T_FSL_NOT_FROM_GOOGLE	2.0
describe T_FSL_NOT_FROM_GOOGLE    Envelope-From GMail or Google but not originated from Google systems
##} T_FSL_NOT_FROM_GOOGLE

##{ T_FSL_NOT_FROM_HOTMAIL

meta     T_FSL_NOT_FROM_HOTMAIL   (__FSL_ENVFROM_HOTMAIL || __FSL_ENVFROM_LIVE) && !__FSL_RELAY_HOTMAIL
#score    T_FSL_NOT_FROM_HOTMAIL   2.0
describe T_FSL_NOT_FROM_HOTMAIL   Envelope-From Hotmail/Live but not originated from Hotmail systems
##} T_FSL_NOT_FROM_HOTMAIL

##{ T_FSL_NOT_FROM_YAHOO

meta     T_FSL_NOT_FROM_YAHOO     ((__FSL_ENVFROM_YAHOO || __FSL_ENVFROM_YMAIL || __FSL_ENVFROM_ROCKET) && !__FSL_RELAY_YAHOO)
#score    T_FSL_NOT_FROM_YAHOO     2.0
describe T_FSL_NOT_FROM_YAHOO     Envelope-From Yahoo or Yahoo Groups but not originated from Yahoo systems
##} T_FSL_NOT_FROM_YAHOO

##{ T_FSL_OPEN_ATTACH

body     T_FSL_OPEN_ATTACH        /\b(?:OPEN|VIEW|READ|SEE|YOUR|ARE)\s*(?:THE\s*)?ATTACH(?:ED|MENT)\b?/
#score    T_FSL_OPEN_ATTACH        2.0
describe T_FSL_OPEN_ATTACH        DEMANDS that you open the attachment!
##} T_FSL_OPEN_ATTACH

##{ T_FSL_PHISH_EMAIL

meta     T_FSL_PHISH_EMAIL        (__FSL_PHISH_UN + __FSL_PHISH_PW + __FSL_PHISH_DE + __FSL_PHISH_MB + __FSL_PHISH_RV + __FSL_PHISH_ADMIN) >= 3
#score    T_FSL_PHISH_EMAIL        1.0
describe T_FSL_PHISH_EMAIL        Likely phishing for e-mail account details
##} T_FSL_PHISH_EMAIL

##{ T_FSL_RU_URL

uri      T_FSL_RU_URL      /[^\/]+\.ru(?:$|\/|\?)/i
tflags   T_FSL_RU_URL      nopublish
##} T_FSL_RU_URL

##{ T_FSL_STACKED_TEXT

meta    T_FSL_STACKED_TEXT (__TWO_WORD_LINES > 10)
##} T_FSL_STACKED_TEXT

##{ T_FSL_SUBJ_SEO

meta     T_FSL_SUBJ_SEO          (__FSL_SUBJ_SEO_1 || __FSL_SUBJ_SEO_2)
describe T_FSL_SUBJ_SEO          Search engine optimisation
#score    T_FSL_SUBJ_SEO          1.0
##} T_FSL_SUBJ_SEO

##{ T_FSL_SUPPLY

body     T_FSL_SUPPLY            /\b(?:i|we|company)\s*(?:can|is|am|are)?\s*(?:sell(?:ing)?|offer(?:ing)?|provid(?:es?|ing|supply(?:ing)))\b/i
describe T_FSL_SUPPLY            Something can be supplied
#score    T_FSL_SUPPLY            1.0
##} T_FSL_SUPPLY

##{ T_FSL_SUPPLY_FM

meta     T_FSL_SUPPLY_FM         (FREEMAIL_FROM && T_FSL_SUPPLY)
describe T_FSL_SUPPLY_FM         Something can be supplied and from Freemail account
#score    T_FSL_SUPPLY_FM         1.0
##} T_FSL_SUPPLY_FM

##{ T_FSL_THIS_IS_ADV

body     T_FSL_THIS_IS_ADV  /This is an advertisement\./
describe T_FSL_THIS_IS_ADV  This is an advertisement
##} T_FSL_THIS_IS_ADV

##{ T_FSL_TO_ROLE_BULK

meta     T_FSL_TO_ROLE_BULK      (__FSL_TO_COMMON_ROLE && (DCC_CHECK || RAZOR2_CHECK || PYZOR_CHECK))
describe T_FSL_TO_ROLE_BULK      Bulk signature and to a role account
#score    T_FSL_TO_ROLE_BULK      1.0
##} T_FSL_TO_ROLE_BULK

##{ T_FSL_UNDISCLOSED_BULK

meta     T_FSL_UNDISCLOSED_BULK  (T_FSL_UNDISCLOSED_RCPTS && (DCC_CHECK || RAZOR2_CHECK || PYZOR_CHECK))
describe T_FSL_UNDISCLOSED_BULK  Undisclosed recipients and bulk signature
#score    T_FSL_UNDISCLOSED_BULK  3.0
##} T_FSL_UNDISCLOSED_BULK

##{ T_FSL_UNDISCLOSED_RCPTS

header   T_FSL_UNDISCLOSED_RCPTS  To =~ /\bundisclosed[- ]recipients\b/i
#score    T_FSL_UNDISCLOSED_RCPTS  0.01
describe T_FSL_UNDISCLOSED_RCPTS  To undisclosed recipients
##} T_FSL_UNDISCLOSED_RCPTS

##{ T_FSL_UNSUB_RATWARE

uri      T_FSL_UNSUB_RATWARE     /unsubscribe\.php\?M=[0-9]+&C=[^& ]+&L=[0-9]+&N=[0-9]+/
describe T_FSL_UNSUB_RATWARE     Unsubscribe ratware signature
#score    T_FSL_UNSUB_RATWARE     3.0
##} T_FSL_UNSUB_RATWARE

##{ T_FSL_Y360_ABUSE

uri T_FSL_Y360_ABUSE /\.360\.yahoo\.com\//
##} T_FSL_Y360_ABUSE

##{ T_FSL_YAHOO_AUTH_SIG

meta     T_FSL_YAHOO_AUTH_SIG     (__FSL_RELAY_YAHOO && (__FSL_YAHOO_AUTH1 || __FSL_YAHOO_AUTH2 || __FSL_YAHOO_AUTH3))
describe T_FSL_YAHOO_AUTH_SIG     Yahoo SMTP AUTH observed patterns
#score    T_FSL_YAHOO_AUTH_SIG     5.0
##} T_FSL_YAHOO_AUTH_SIG

##{ T_FSL_YHG_ABUSE

uri      T_FSL_YHG_ABUSE   /groups\.yahoo\.com\/group\/\S+\/message/
describe T_FSL_YHG_ABUSE   URI pointing to a message in an abused Yahoo Group
##} T_FSL_YHG_ABUSE

##{ T_FSL_YPIPES_ABUSE

uri T_FSL_YPIPES_ABUSE /\/pipes\.yahoo\.com\/pipes\/pipe\.info\?_id=\S+$/
##} T_FSL_YPIPES_ABUSE

##{ T_FS_ATTRACT_CUST

header   T_FS_ATTRACT_CUST        Subject =~ /Attract (?:\w{2,8}\s)?customer/i
describe T_FS_ATTRACT_CUST        Subject says Attract something customer
##} T_FS_ATTRACT_CUST

##{ T_FS_BROKEN_MEETING

header   T_FS_BROKEN_MEETING      Subject =~ /(?!meeting)m.{0,1}e.{0,1}e.{0,1}t.{0,1}i.{0,1}n.{0,1}g/i
describe T_FS_BROKEN_MEETING      Subject looks like meeting but broken.
##} T_FS_BROKEN_MEETING

##{ T_FS_CAILIS

header   T_FS_CAILIS              Subject =~ /\bcailis\b/i
describe T_FS_CAILIS              Subject says cailis
##} T_FS_CAILIS

##{ T_FS_CLAIM_NOW

header   T_FS_CLAIM_NOW           Subject =~ /Claim Now/i
describe T_FS_CLAIM_NOW           Subject says "Claim now"
##} T_FS_CLAIM_NOW

##{ T_FS_COSTARICA

header   T_FS_COSTARICA           Subject =~ /costa rica/i
describe T_FS_COSTARICA           Subject says Costa Rica
##} T_FS_COSTARICA

##{ T_FS_CUTE_TEEN

header   T_FS_CUTE_TEEN           Subject =~ /cute teen/i
describe T_FS_CUTE_TEEN           Subject says cute teen
##} T_FS_CUTE_TEEN

##{ T_FS_END_BILLS

header   T_FS_END_BILLS           Subject =~ /bills\s?$/i
describe T_FS_END_BILLS           Subject ends with bills.
##} T_FS_END_BILLS

##{ T_FS_GANGBANG

header   T_FS_GANGBANG            Subject =~ /gangbang/i
describe T_FS_GANGBANG            Phrase: subject says gangbang
##} T_FS_GANGBANG

##{ T_FS_GET_LAID

header   T_FS_GET_LAID            Subject =~ /get la[i1]d/i
describe T_FS_GET_LAID            Phrase: get laid in subj.
##} T_FS_GET_LAID

##{ T_FS_GIFT_CARD_OFF

header   T_FS_GIFT_CARD_OFF       Subject =~ /Gift\s?Card\s?Offer/i
describe T_FS_GIFT_CARD_OFF       Subject says Gift card offer
##} T_FS_GIFT_CARD_OFF

##{ T_FS_HOT_TEEN

header   T_FS_HOT_TEEN            Subject =~ /hot teen/i
describe T_FS_HOT_TEEN            Phrase: subject says "hot teen"
##} T_FS_HOT_TEEN

##{ T_FS_LITTLE_PILL

header   T_FS_LITTLE_PILL         Subject =~ /little \w+ pill/i
describe T_FS_LITTLE_PILL         Phrase: little somthing pill.
##} T_FS_LITTLE_PILL

##{ T_FS_LOWER_YOUR

header   T_FS_LOWER_YOUR          Subject =~ /lower your/i
describe T_FS_LOWER_YOUR          Phrase: lower your
##} T_FS_LOWER_YOUR

##{ T_FS_LOW_INTMOR

header   T_FS_LOW_INTMOR          Subject =~ /low.{1,6}(?:interest|mortgage)/i
describe T_FS_LOW_INTMOR          Subject says low interest or mortgage
##} T_FS_LOW_INTMOR

##{ T_FS_MAKE_MONEY

header   T_FS_MAKE_MONEY          Subject =~ /make money/i
describe T_FS_MAKE_MONEY          Subject says "make money"
##} T_FS_MAKE_MONEY

##{ T_FS_MORE_CONFIDENT

header   T_FS_MORE_CONFIDENT      Subject =~ /more confident/i
describe T_FS_MORE_CONFIDENT      Subject says More Confident
##} T_FS_MORE_CONFIDENT

##{ T_FS_NEED_MONEY

header   T_FS_NEED_MONEY          Subject =~ /Need (?:\$|Cash)/i
describe T_FS_NEED_MONEY          Subject talks about needing cash.
##} T_FS_NEED_MONEY

##{ T_FS_NUMYO

header   T_FS_NUMYO               Subject =~ /1[0-9][\s\.]?y[\s\.]?o[\s\.]?\b/i
describe T_FS_NUMYO               Speaks of teenager in subject.
##} T_FS_NUMYO

##{ T_FS_PAYINGTOOM

header   T_FS_PAYINGTOOM          Subject =~ /paying too much for/i
describe T_FS_PAYINGTOOM          Subject says Paying too much for
##} T_FS_PAYINGTOOM

##{ T_FS_PORN_STAR

header   T_FS_PORN_STAR           Subject =~ /Porn Star/i
describe T_FS_PORN_STAR           Subject says Porn Star
##} T_FS_PORN_STAR

##{ T_FS_PRE_SUBJ

header   T_FS_PRE_SUBJ            Subject =~ /\{PRE_SUBJ\}/
describe T_FS_PRE_SUBJ            Subject says PRE_SUBJ
##} T_FS_PRE_SUBJ

##{ T_FS_REFI

header   T_FS_REFI                Subject =~ /\brefi\b/i
describe T_FS_REFI                Subject says "refi"
##} T_FS_REFI

##{ T_FS_REPL_TOKEN

header   T_FS_REPL_TOKEN          Subject =~ /\{Token1\}/i
describe T_FS_REPL_TOKEN          Subject has Replacement Token
##} T_FS_REPL_TOKEN

##{ T_FS_RESULTS_BED

header   T_FS_RESULTS_BED         Subject =~ /results in bed/i
describe T_FS_RESULTS_BED         Subject says results in bed
##} T_FS_RESULTS_BED

##{ T_FS_SILDENAFIL

header   T_FS_SILDENAFIL          Subject =~ /Sildenafil Citrate/i
describe T_FS_SILDENAFIL          Subject says "Sildenafil Citrate"
##} T_FS_SILDENAFIL

##{ T_FS_SINGLE_LETTER_H

header   T_FS_SINGLE_LETTER_H     Subject =~ /\sh\s/i
describe T_FS_SINGLE_LETTER_H     Subject has a bare H
##} T_FS_SINGLE_LETTER_H

##{ T_FS_SINGLE_LETTER_J

header   T_FS_SINGLE_LETTER_J     Subject =~ /\sj\s/i
describe T_FS_SINGLE_LETTER_J     Subject has a bare J
##} T_FS_SINGLE_LETTER_J

##{ T_FS_SPERMAX

header   T_FS_SPERMAX             Subject =~ /Spermamax/i
describe T_FS_SPERMAX             Subject contains Spermamax
##} T_FS_SPERMAX

##{ T_FS_SPLASH

header   T_FS_SPLASH              Subject =~ / splash(?:ed|ing)? /i
describe T_FS_SPLASH              Subject says splash or splashed
##} T_FS_SPLASH

##{ T_FS_START_TEEN

header   T_FS_START_TEEN          Subject =~ /^Teen /i
describe T_FS_START_TEEN          Subject starts with Teen
##} T_FS_START_TEEN

##{ T_FS_TIGHT_TEEN

header   T_FS_TIGHT_TEEN          Subject =~ /tight (?:teen|pussy|ass)/i
describe T_FS_TIGHT_TEEN          Phrase: tight teen, etc.
##} T_FS_TIGHT_TEEN

##{ T_FS_VIEWPHOTOS

header   T_FS_VIEWPHOTOS          Subject =~ /view photos of singles in your area/i
describe T_FS_VIEWPHOTOS          Phrase: View photos of singles...
##} T_FS_VIEWPHOTOS

##{ T_FS_WE_WANT

header   T_FS_WE_WANT             Subject =~ /^We want/i
describe T_FS_WE_WANT             Subject starts with We Want.
##} T_FS_WE_WANT

##{ T_FS_YOUR_COMPUTER

header   T_FS_YOUR_COMPUTER       Subject =~ /^Your computer/i
describe T_FS_YOUR_COMPUTER       Phrase: Your Computer in Subject.
##} T_FS_YOUR_COMPUTER

##{ T_FS_YOUR_PRESCRIP

header   T_FS_YOUR_PRESCRIP       Subject =~ /Your(?: rx)? Prescription/i
describe T_FS_YOUR_PRESCRIP       Subject talks about your prescription
##} T_FS_YOUR_PRESCRIP

##{ T_FS_YOUR_REFILL

header   T_FS_YOUR_REFILL         Subject =~ /your refill/i
describe T_FS_YOUR_REFILL         Subject Phrase: your refill
##} T_FS_YOUR_REFILL

##{ T_FU_16R

uri      T_FU_16R                 m'/16r'i
describe T_FU_16R                 Often seen in spam /16r
##} T_FU_16R

##{ T_FU_CLICK_PHP_DDD

uri      T_FU_CLICK_PHP_DDD       /click\.php\?\d+\.\d+\.\d+\.\d+\.\d+/i
describe T_FU_CLICK_PHP_DDD       Click.php?ddd.ddd.ddd.ddd.ddd
##} T_FU_CLICK_PHP_DDD

##{ T_FU_COMMON_SUBS

uri      T_FU_COMMON_SUBS         m'/(?:h(?:5r|x1)|1q0|bgh|csy|j6x|n1b|y6g|zox)/?[,.]?$'i
describe T_FU_COMMON_SUBS         Sub-dir seen often in spam.
##} T_FU_COMMON_SUBS

##{ T_FU_ENDS_RT

uri      T_FU_ENDS_RT             m'/rt$'i
describe T_FU_ENDS_RT             URL ends with /rt
##} T_FU_ENDS_RT

##{ T_FU_ENDS_SG

uri      T_FU_ENDS_SG             m'/sg$'i
describe T_FU_ENDS_SG             URL ends with /sg
##} T_FU_ENDS_SG

##{ T_FU_HG_PATH

uri      T_FU_HG_PATH             m'/hgh/'i
describe T_FU_HG_PATH             URL has /hgh/ in path.
##} T_FU_HG_PATH

##{ T_FU_LONG_HTML

uri      T_FU_LONG_HTML           /[a-z]{50}\.html/i
describe T_FU_LONG_HTML           URL has long file name with .html extension.
##} T_FU_LONG_HTML

##{ T_FU_LOTSOFCOLONS

uri      T_FU_LOTSOFCOLONS        m'/\w{5,25}:\w{5,25}:\w{5,25}\b'i
describe T_FU_LOTSOFCOLONS        word:word:word in URL.
##} T_FU_LOTSOFCOLONS

##{ T_FU_RX_DIR

uri      T_FU_RX_DIR              m'/rx/'i
describe T_FU_RX_DIR              /rx/
##} T_FU_RX_DIR

##{ T_FU_SUB_D_WEIRD

uri      T_FU_SUB_D_WEIRD         /3a2kf\./
describe T_FU_SUB_D_WEIRD         Sub-domain seen often in spam.
##} T_FU_SUB_D_WEIRD

##{ T_GAPPY_HTML

meta        T_GAPPY_HTML             __GAPPY_HTML && !__UNSUB_LINK && !__RP_MATCHES_RCVD && !__RCD_RDNS_MAIL_MESSY
describe    T_GAPPY_HTML             HTML body with much useless whitespace
##} T_GAPPY_HTML

##{ T_GAPPY_PHONE_NA

meta        T_GAPPY_PHONE_NA         __GAPPY_PHONE_NA
describe    T_GAPPY_PHONE_NA         Phone number with lots of spaces
##} T_GAPPY_PHONE_NA

##{ T_GZ_PILL_SQUATTERS

meta        T_GZ_PILL_SQUATTERS      __GZ_PILL_SQUATTERS && !__DOS_RELAYED_EXT && !__FROM_ISO_2022_JP && !__RCD_RDNS_MX_MESSY
describe    T_GZ_PILL_SQUATTERS      Found a link to rogue pill pusher content
##} T_GZ_PILL_SQUATTERS

##{ T_HAS_APPARENTLY_TO

meta           T_HAS_APPARENTLY_TO          __APPARENTLY_TO > 0
describe       T_HAS_APPARENTLY_TO          Has deprecated Apparently-To header
tflags         T_HAS_APPARENTLY_TO          nopublish
##} T_HAS_APPARENTLY_TO

##{ T_HDRS_LCASE_1K

meta           T_HDRS_LCASE_1K         __HDRS_LCASE_1K && !__HDRS_LCASE_KNOWN && !__VIA_ML && !__MIME_QP && !__BUGGED_IMG && !__BOUNCE_RPATH_NULL && !__NOT_SPOOFED && !__DKIM_EXISTS && !__RDNS_NONE
describe       T_HDRS_LCASE_1K         Odd capitalization of message headers + long header
#score          T_HDRS_LCASE_1K         0.50	# limit
##} T_HDRS_LCASE_1K

##{ T_HDRS_LCASE_IMGONLY

meta           T_HDRS_LCASE_IMGONLY    __HDRS_LCASE && __HTML_IMG_ONLY && !__HDRS_LCASE_KNOWN
describe       T_HDRS_LCASE_IMGONLY    Odd capitalization of message headers + image-only HTML
#score          T_HDRS_LCASE_IMGONLY    0.10	# limit
##} T_HDRS_LCASE_IMGONLY

##{ T_HDRS_MISSP

header         T_HDRS_MISSP            ALL =~ /\n(?:Subject|From|To):\S/ism
describe       T_HDRS_MISSP            Misspaced headers
##} T_HDRS_MISSP

##{ T_HELO_MISC_IP

meta     	T_HELO_MISC_IP          	(__HELO_MISC_IP && !HELO_DYNAMIC_IPADDR && !HELO_DYNAMIC_IPADDR2 && !HELO_DYNAMIC_SPLIT_IP && !HELO_DYNAMIC_HCC && !HELO_DYNAMIC_DIALIN && ((TVD_RCVD_IP4 + TVD_RCVD_IP + RCVD_NUMERIC_HELO) <2))
describe	T_HELO_MISC_IP		Looking for more Dynamic IP Relays
#score		T_HELO_MISC_IP		0.25
##} T_HELO_MISC_IP

##{ T_HELO_NO_DOMAIN

meta     T_HELO_NO_DOMAIN	__HELO_NO_DOMAIN && !HELO_LOCALHOST
describe T_HELO_NO_DOMAIN	Relay reports its domain incorrectly
##} T_HELO_NO_DOMAIN

##{ T_HK_GOLDDUST

body		T_HK_GOLDDUST		/\bgold ?dust\b/i
##} T_HK_GOLDDUST

##{ T_HK_LOTTO_NAME

header		T_HK_LOTTO_NAME		From =~ /^[^@]*(?:lot(?:eri[ej]|t(?:ery|o))|award|winner)/mi
#score		T_HK_LOTTO_NAME		1
##} T_HK_LOTTO_NAME

##{ T_HK_LOTTO_SUBJECT

header		T_HK_LOTTO_SUBJECT	Subject =~ /\blot(?:eri[ej]|t(?:ery|o))\b/mi
#score		T_HK_LOTTO_SUBJECT	1
##} T_HK_LOTTO_SUBJECT

##{ T_HK_MUCHMONEY

meta		T_HK_MUCHMONEY		__hk_million || __hk_million2 || __hk_hthousand || __hk_bigmoney
describe	T_HK_MUCHMONEY		Message refers to hundreds of thousands or millions
#score		T_HK_MUCHMONEY		0.001
##} T_HK_MUCHMONEY

##{ T_HK_NAME_FREE

header		T_HK_NAME_FREE		From:name =~ /\b(?:get)?free(?!\.fr)\b/mi
describe	T_HK_NAME_FREE		From name mentions free stuff
#score		T_HK_NAME_FREE		0.5
##} T_HK_NAME_FREE

##{ T_HK_PNIS

body		T_HK_PNIS			/\bpenis\b/i
#score		T_HK_PNIS			1
##} T_HK_PNIS

##{ T_HK_PNISES

body		T_HK_PNISES		/\bpenises\b/i
#score		T_HK_PNISES		1
##} T_HK_PNISES

##{ T_HK_RANDOM_FROM_NAME

header		T_HK_RANDOM_FROM_NAME	From:name =~ /^(?!.*?(?:@|cnnbc|nlpbr)).*?(?:[bcdfgjklmnpqrtvwxz]{5}|[aeiouy]{5}|([a-z]{1,2})(?:\1){3})/mi
describe	T_HK_RANDOM_FROM_NAME	From name looks random
##} T_HK_RANDOM_FROM_NAME

##{ T_HK_RANDOM_REPLYTO

header		T_HK_RANDOM_REPLYTO	Reply-To:addr =~ /^(?!(?:mail|bounce)[_.-]|[^@]*(?:[+=^~\#]|mcgr|kpmg|nlpbr|ndqv|lcgc|cplpr|-mailer@)|[^@]{26}|.*?@.{0,20}\b(?:cmpgnr|cnn)\.com$)[^@]*(?:[bcdfgjklmnpqrtvwxz]{5}|[aeiouy]{5}|([a-z]{1,2})(?:\1){3})/mi
describe	T_HK_RANDOM_REPLYTO	Reply-To username looks random
#score		T_HK_RANDOM_REPLYTO	1
##} T_HK_RANDOM_REPLYTO

##{ T_HK_RANDOM_REPLYTO_NAME

header		T_HK_RANDOM_REPLYTO_NAME	Reply-To:name =~ /^(?!.*?(?:@|cnnbc|nlpbr)).*?(?:[bcdfgjklmnpqrtvwxz]{5}|[aeiouy]{5}|([a-z]{1,2})(?:\1){3})/mi
describe	T_HK_RANDOM_REPLYTO_NAME	Reply-To name looks random
##} T_HK_RANDOM_REPLYTO_NAME

##{ T_HK_SCAM_N1

body		T_HK_SCAM_N1		/\b(?:widow|son|daughter|husband|wife|brother|sister) of (?:the )?(?:late|sacked|dead|passed)\b/i
##} T_HK_SCAM_N1

##{ T_HK_SCAM_N12

body		T_HK_SCAM_N12		/\binsured with your email\b/i
##} T_HK_SCAM_N12

##{ T_HK_SCAM_N13

body		T_HK_SCAM_N13		/\b(?:business|important|discreet) transaction\b/i
##} T_HK_SCAM_N13

##{ T_HK_SCAM_N14

body		T_HK_SCAM_N14		/\bsum of amount\b/i
##} T_HK_SCAM_N14

##{ T_HK_SCAM_N15

body		T_HK_SCAM_N15		/\b(?:account (?:overseas?|offshore)|(?:overseas?|offshore) account)\b/i
##} T_HK_SCAM_N15

##{ T_HK_SCAM_N16

body		T_HK_SCAM_N16		/\b(?:arrangement secret|secret arrangement)\b/i
##} T_HK_SCAM_N16

##{ T_HK_SCAM_N3

body		T_HK_SCAM_N3		/\bdirect telephone numbers?\b/i
##} T_HK_SCAM_N3

##{ T_HK_SCAM_N4

body		T_HK_SCAM_N4		/\b(?:e?mail me below|reply (?:me to )?this e?mail (?:at|to)?|send your reply (?:to|at))\b/i
##} T_HK_SCAM_N4

##{ T_HK_SCAM_N8

body		T_HK_SCAM_N8		/\byour compensation\b/i
##} T_HK_SCAM_N8

##{ T_HK_SCAM_N9

body		T_HK_SCAM_N9		/\bseek for your indulgence\b/i
##} T_HK_SCAM_N9

##{ T_HK_SCAM_S1

body		T_HK_SCAM_S1		/pay you the sum of/i
##} T_HK_SCAM_S1

##{ T_HK_SCAM_S12

body		T_HK_SCAM_S12		/fidelity investments international/i
##} T_HK_SCAM_S12

##{ T_HK_SCAM_S15

body		T_HK_SCAM_S15		/(?:discovered a dormant account|can you be my partner)/i
##} T_HK_SCAM_S15

##{ T_HK_SCAM_S22

body		T_HK_SCAM_S22		/\bmining companies/i
##} T_HK_SCAM_S22

##{ T_HK_SCAM_S25

body		T_HK_SCAM_S25		/\bbank (?:in|of) ghana/i
##} T_HK_SCAM_S25

##{ T_HK_SCAM_S3

body		T_HK_SCAM_S3		/invest(?:ment (?:in your area|partner)|in your country|assist me in an investment)/i
##} T_HK_SCAM_S3

##{ T_HK_SCAM_S4

body		T_HK_SCAM_S4		/transfer (?:this|my|of )?funds?/i
##} T_HK_SCAM_S4

##{ T_HK_SCAM_S7

body		T_HK_SCAM_S7		/(?:(?:investment|proposed|lucrative) (?:business|venture)|(?:business|venture) (?:enterprise|propos(?:al|ition)))/i
##} T_HK_SCAM_S7

##{ T_HK_WIN

meta		T_HK_WIN			((__hk_win_1 || __hk_win_2 || __hk_win_3 || __hk_win_4 || __hk_win_5 || __hk_win_6 || __hk_win_7 || __hk_win_8 || __hk_win_9 || __hk_win_0 || __hk_win_a || __hk_win_b || __hk_win_c || __hk_win_d || __hk_win_e || __hk_win_f || __hk_win_g || __hk_win_h || __hk_win_i || __hk_win_j || __hk_win_k || __hk_win_l || __hk_win_m || __hk_win_n || __hk_win_o) > 2)
#score		T_HK_WIN			1
##} T_HK_WIN

##{ T_HTML_FONT_TINY

meta        T_HTML_FONT_TINY       __HTML_FONT_TINY_01 && __TAG_EXISTS_BODY
describe    T_HTML_FONT_TINY       Font too small to read
#score       T_HTML_FONT_TINY       1.00	# limit
##} T_HTML_FONT_TINY

##{ T_IMAGESHACK_URI

uri             T_IMAGESHACK_URI          /\.imageshack\.us\//i
describe        T_IMAGESHACK_URI          URI contains imageshack.us
##} T_IMAGESHACK_URI

##{ T_IMG_ALT_BRACKETS

rawbody T_IMG_ALT_BRACKETS /^<img src="cid:7\.1\.0\.9\.[^"]+\.0" width=\d+ height=\d+ alt="[[][]]">/
##} T_IMG_ALT_BRACKETS

##{ T_IMG_ALT_HSPACE_CID_ALIGN

rawbody T_IMG_ALT_HSPACE_CID_ALIGN  /<IMG alt="\S*" hspace=0 src=.cid:\S+ align=baseline/
##} T_IMG_ALT_HSPACE_CID_ALIGN

##{ T_IMG_CID_PART1

rawbody T_IMG_CID_PART1   /<img alt=\"\S*\" src=\"cid:part1\.\d/
##} T_IMG_CID_PART1

##{ T_IMG_DIRECT_TO_MX

meta       T_IMG_DIRECT_TO_MX        __DOS_DIRECT_TO_MX && __JPEG_ATTACH && __ONE_IMG && __IMG_LE_300K
##} T_IMG_DIRECT_TO_MX

##{ T_IRS_SPOOF

meta        T_IRS_SPOOF            __IRS_SPOOF
describe    T_IRS_SPOOF            Claims to be IRS, but not from IRS domain
#score       T_IRS_SPOOF            2.00	# limit
##} T_IRS_SPOOF

##{ T_JM_0800_GMT

header T_JM_0800_GMT      Received =~ / \+0800 \(GMT\)$/
##} T_JM_0800_GMT

##{ T_JM_EXIM_462

header T_JM_EXIM_462  Received =~ /with smtp \(Exim 4.62 \(FreeBSD\)\)/
##} T_JM_EXIM_462

##{ T_JM_GMT_RCVD

header T_JM_GMT_RCVD      ALL =~ /0 \(GMT\)\nReceived: by 192\.168\./s
##} T_JM_GMT_RCVD

##{ T_JM_HOODIA

body T_JM_HOODIA      /Hoodia has been showned on/
##} T_JM_HOODIA

##{ T_JM_NICE_GIRL

body T_JM_NICE_GIRL       /I am nice girl that would like to chat with you\. /
##} T_JM_NICE_GIRL

##{ T_JM_REACTOR_MAILER

meta T_JM_REACTOR_MAILER (__JM_REACTOR_MID && __JM_REACTOR_DATE && __JM_REACTOR_XM2900 && __JM_REACTOR_XMOLE)
describe T_JM_REACTOR_MAILER Header patterns indicative of "Reactor Mailer" ratware
##} T_JM_REACTOR_MAILER

##{ T_JM_REMOVE_FROM_URL

body T_JM_REMOVE_FROM_URL     /\.com\/ \(remove \"\S+\" from /i
##} T_JM_REMOVE_FROM_URL

##{ T_KAM_BLOCK_UTF7

meta		T_KAM_BLOCK_UTF7		(__KAM_BLOCK_UTF7_1 + __KAM_BLOCK_UTF7_2 >= 1)
describe	T_KAM_BLOCK_UTF7		Poison pill rule to block UTF-7 encoded e-mail
#score		T_KAM_BLOCK_UTF7		20
##} T_KAM_BLOCK_UTF7

##{ T_KB_CTYPE_SPACE

header   T_KB_CTYPE_SPACE   Content-Type =~ /charset="ISO /  # " emacs
##} T_KB_CTYPE_SPACE

##{ T_KB_CTYPE_SP_MOZ

meta     T_KB_CTYPE_SP_MOZ  ( T_KB_CTYPE_SPACE && __KB_UA_MOZ )
describe T_KB_CTYPE_SP_MOZ  Mozilla does not do that, I hope
##} T_KB_CTYPE_SP_MOZ

##{ T_KB_FORGED_MOZ4

header   T_KB_FORGED_MOZ4   User-Agent =~ /\bMozilla 4/
describe T_KB_FORGED_MOZ4   Mozilla 4 uses X-Mailer
##} T_KB_FORGED_MOZ4

##{ T_KHOP_BOTNET_4

meta	 T_KHOP_BOTNET_4	__LAST_EXTERNAL_RELAY_NO_AUTH && !(__FROM_FREEMAIL || __NOT_SPOOFED || __GREYLISTING) && (__S25R_3 || __S25R_4 || __S25R_5 || __S25R_6 || RDNS_DYNAMIC + __S25R_1*.8 + __S25R_2*.8 > 1.7)
describe T_KHOP_BOTNET_4	Relay looks like a dynamic address
tflags	 T_KHOP_BOTNET_4	nopublish
##} T_KHOP_BOTNET_4

##{ T_KHOP_BOTNET_7

meta	 T_KHOP_BOTNET_7	!(__FROM_FREEMAIL || __NOT_SPOOFED || __GREYLISTING) && (__S25R_4 || __S25R_5 || __S25R_6 || __RDNS_HEX || __S25R_1 + __S25R_2 + __S25R_3 + __IP_IN_RELAY > 2)
describe T_KHOP_BOTNET_7	Relay looks like a dynamic address
tflags	 T_KHOP_BOTNET_7	nopublish
##} T_KHOP_BOTNET_7

##{ T_KHOP_BOTNET_9

meta	 T_KHOP_BOTNET_9	!(__FROM_FREEMAIL || __NOT_SPOOFED || __GREYLISTING) && (__S25R_4 || __S25R_5 || __S25R_6 || __RDNS_HEX || __S25R_1 + __S25R_2 + __S25R_3 + __IP_IN_RELAY + __MAY_BE_FORGED > 2)
describe T_KHOP_BOTNET_9	Relay looks like a dynamic address
tflags	 T_KHOP_BOTNET_9	nopublish
##} T_KHOP_BOTNET_9

##{ T_KHOP_BOTNET_UNCLEAN

meta	 T_KHOP_BOTNET_UNCLEAN	__LAST_EXTERNAL_RELAY_NO_AUTH && (__S25R_4 || __S25R_5 || __S25R_6 || __RDNS_HEX || __5_SUBDOM || __S25R_1 + __S25R_2 + __S25R_3 + __IP_IN_RELAY + __MAY_BE_FORGED > 2)
describe T_KHOP_BOTNET_UNCLEAN	Relay looks like a dynamic address
tflags	 T_KHOP_BOTNET_UNCLEAN	nopublish
##} T_KHOP_BOTNET_UNCLEAN

##{ T_KHOP_BSD_REPORT

meta	 T_KHOP_BSD_REPORT    __BSD_REPORT && ALL_TRUSTED
describe T_KHOP_BSD_REPORT    Regular run output from a BSD system
tflags	 T_KHOP_BSD_REPORT    nice noautolearn nopublish
##} T_KHOP_BSD_REPORT

##{ T_KHOP_DYNAMIC

meta	 T_KHOP_DYNAMIC	__LAST_EXTERNAL_RELAY_NO_AUTH && !ALL_TRUSTED && (__5_SUBDOM || __RDNS_HEX || __S25R_4 || __S25R_6 || __RCD_RDNS_DYN_MESSY || __RCD_RDNS_PPP_MESSY || __RCD_RDNS_PPOE_MESSY) && !__RCD_RDNS_MAIL_MESSY
describe T_KHOP_DYNAMIC	Relay looks like a dynamic address
#score	 T_KHOP_DYNAMIC	2.0
##} T_KHOP_DYNAMIC

##{ T_KHOP_DYNAMIC2

meta	 T_KHOP_DYNAMIC2	!(__NOT_SPOOFED||__GREYLISTING||T_KHOP_DYNAMIC) && (__S25R_1 + __S25R_2 + 1.1*__S25R_3 + 1.1*__S25R_5 + __IP_IN_RELAY > 3)
describe T_KHOP_DYNAMIC2	Relay looks like a dynamic address
tflags	 T_KHOP_DYNAMIC2	nopublish
#score	 T_KHOP_DYNAMIC2	1.0
##} T_KHOP_DYNAMIC2

##{ T_KHOP_ENCRYPTED_CONTENT

header	 T_KHOP_ENCRYPTED_CONTENT	Content-Type =~ /^multipart\/(?:x-)?(?:pgp-)?encrypted|application\/(?:x-)?pkcs7-mime/
describe T_KHOP_ENCRYPTED_CONTENT	Message is encrypted
tflags	 T_KHOP_ENCRYPTED_CONTENT	nice noautolearn nopublish
##} T_KHOP_ENCRYPTED_CONTENT

##{ T_KHOP_FAKE_EBAY

meta	 T_KHOP_FAKE_EBAY 	__EBAY_ADDRESS && !__NOT_SPOOFED
describe T_KHOP_FAKE_EBAY 	Sender falsely claims to be from eBay
##} T_KHOP_FAKE_EBAY

##{ T_KHOP_FROM_WWW

meta	 T_KHOP_FROM_WWW	(__RDNS_IS_WWW || __RELAY_THRU_WWW) && ! (__FROM_WEB_DAEMON || __MSGID_JAVAMAIL)
##} T_KHOP_FROM_WWW

##{ T_KHOP_GREYED

meta T_KHOP_GREYED __GREYLISTED && (RDNS_NONE||RDNS_DYNAMIC||__HELO_NO_DOMAIN)
describe T_KHOP_GREYED	Greylisted and sent from dynamically-named relay
#score	 T_KHOP_GREYED	0.1
##} T_KHOP_GREYED

##{ T_KHOP_HELO_AS_VICTIM

meta	 T_KHOP_HELO_AS_VICTIM	__HELO_AS_VICTIM && !__BOTNET_NOTRUST
tflags   T_KHOP_HELO_AS_VICTIM    nopublish # confirm license with author first for __BOTNET_NOTRUST
##} T_KHOP_HELO_AS_VICTIM

##{ T_KHOP_HELO_FCRDNS

meta	 T_KHOP_HELO_FCRDNS	__HELO_NOT_RDNS && !(__VIA_ML || __freemail_safe || __RCVD_IN_DNSWL || __NOT_SPOOFED || __RDNS_SHORT)
describe T_KHOP_HELO_FCRDNS	Relay HELO differs from its IP's reverse DNS
#score	 T_KHOP_HELO_FCRDNS	0.4 # 20090603
##} T_KHOP_HELO_FCRDNS

##{ T_KHOP_ISC

header	 T_KHOP_ISC     X-Spam-Relays-Untrusted =~ / (?:by|ip)=(?-xism:^(?:2(?:2(?:2.(?:1(?:3(?:3.182.194|6.188.101)|86.(?:25.17|42.59)|71.104.171|21.157.13)|2(?:1(?:5.230.4|6.28.21)9|36.46.141)|(?:45.112.22|73.218.6)1|33.155.116)|1.1(?:9(?:2.199.(?:35|49)|5.73.86)|30.140.116)|0.162.207.62)|1(?:8.(?:6(?:0.130.216|1.17.10)|3(?:.204.139|0.22.82)|204.73.195|15.221.82|8.245.123|75.79.18)|1.1(?:43.230.140|03.153.49)|9.23(?:8.238.225|5.116.79)|2.14.228.46|3.23.171.37)|0(?:0.(?:113.109.155|46.196.130|57.146.24)|2.159.18.194|3.171.30.41)|4.98.109.144)|1(?:2(?:1.(?:1(?:4.(?:104.228|213.86)|89.61.124|0.117.40)|246.75.163)|2.(?:22(?:5.100.154|7.164.71)|102.64.54)|4.(?:2(?:47.193.17|37.121.5)|89.194.16)2|3.30.181.185|5.230.73.196)|1(?:9.62.128.11[35]|8.123.9.91)|9(?:3.93.207.130|0.2.29.193)|09.1(?:11.103.62|22.192.21)|74.1(?:38.160.13|42.39.135)|89.30.150.65)|6(?:1.(?:1(?:6(?:4.151.131|7.27.235|3.75.59)|5(?:1.246.14|2.107.15)0|28.110.96|76.216.44)|23(?:5.46.146|7.159.25))|0.1(?:91.(?:146.254|234.226)|61.78.155|73.11.20)|2.220.21.146|9.73.159.118)|8(?:1.(?:214.244.107|107.48.182)|(?:0.50.136.12|2.85.64.18)6|8.(?:203.203.147|80.10.1)|7.106.9.145|9.115.39.8)|5(?:9.(?:1(?:51.119.180|20.8.93)|(?:39.66|44.87).30)|8.(?:215.75.62|53.128.61|60.10.10))|9(?:3.6(?:2.207.167|3.180.84)|1.212.12(?:7.10|.6)0|2.240.68.15[23])|7(?:(?:1.57.50.15|5.125.39.7)4|4.205.241.29)|38.229.1.72)$) /
describe T_KHOP_ISC     Received through an IP in the ISC top 100 attackers
tflags	 T_KHOP_ISC     nopublish # auto-generated rule
##} T_KHOP_ISC

##{ T_KHOP_ISC_LE

header	 T_KHOP_ISC_LE  X-Spam-Relays-Untrusted =~ /^[^]]+ (?:by|ip)=(?-xism:^(?:2(?:2(?:2.(?:1(?:3(?:3.182.194|6.188.101)|86.(?:25.17|42.59)|71.104.171|21.157.13)|2(?:1(?:5.230.4|6.28.21)9|36.46.141)|(?:45.112.22|73.218.6)1|33.155.116)|1.1(?:9(?:2.199.(?:35|49)|5.73.86)|30.140.116)|0.162.207.62)|1(?:8.(?:6(?:0.130.216|1.17.10)|3(?:.204.139|0.22.82)|204.73.195|15.221.82|8.245.123|75.79.18)|1.1(?:43.230.140|03.153.49)|9.23(?:8.238.225|5.116.79)|2.14.228.46|3.23.171.37)|0(?:0.(?:113.109.155|46.196.130|57.146.24)|2.159.18.194|3.171.30.41)|4.98.109.144)|1(?:2(?:1.(?:1(?:4.(?:104.228|213.86)|89.61.124|0.117.40)|246.75.163)|2.(?:22(?:5.100.154|7.164.71)|102.64.54)|4.(?:2(?:47.193.17|37.121.5)|89.194.16)2|3.30.181.185|5.230.73.196)|1(?:9.62.128.11[35]|8.123.9.91)|9(?:3.93.207.130|0.2.29.193)|09.1(?:11.103.62|22.192.21)|74.1(?:38.160.13|42.39.135)|89.30.150.65)|6(?:1.(?:1(?:6(?:4.151.131|7.27.235|3.75.59)|5(?:1.246.14|2.107.15)0|28.110.96|76.216.44)|23(?:5.46.146|7.159.25))|0.1(?:91.(?:146.254|234.226)|61.78.155|73.11.20)|2.220.21.146|9.73.159.118)|8(?:1.(?:214.244.107|107.48.182)|(?:0.50.136.12|2.85.64.18)6|8.(?:203.203.147|80.10.1)|7.106.9.145|9.115.39.8)|5(?:9.(?:1(?:51.119.180|20.8.93)|(?:39.66|44.87).30)|8.(?:215.75.62|53.128.61|60.10.10))|9(?:3.6(?:2.207.167|3.180.84)|1.212.12(?:7.10|.6)0|2.240.68.15[23])|7(?:(?:1.57.50.15|5.125.39.7)4|4.205.241.29)|38.229.1.72)$) /
describe T_KHOP_ISC_LE  Received through an IP in the ISC top 100 attackers
tflags	 T_KHOP_ISC_LE  nopublish # auto-generated rule
##} T_KHOP_ISC_LE

##{ T_KHOP_LOGWATCH_REPORT

meta	 T_KHOP_LOGWATCH_REPORT	__LOGWATCH_REPORT && ALL_TRUSTED
describe T_KHOP_LOGWATCH_REPORT   System report from LogWatch
tflags	 T_KHOP_LOGWATCH_REPORT	nice noautolearn nopublish
##} T_KHOP_LOGWATCH_REPORT

##{ T_KHOP_NO_FULL_NAME

meta	 T_KHOP_NO_FULL_NAME	__KHOP_NO_FULL_NAME
describe T_KHOP_NO_FULL_NAME	Sender does not have both First and Last names
#score	 T_KHOP_NO_FULL_NAME	0.001
tflags	 T_KHOP_NO_FULL_NAME	nopublish
##} T_KHOP_NO_FULL_NAME

##{ T_KHOP_PSBL_CIDR24

header	 T_KHOP_PSBL_CIDR24	X-Spam-Relays-Untrusted =~ / (?:by|ip)=(?-xism:\b(?:1(?:1(?:2\.215\.(?:6[34]|44)|0\.52\.[028]|5\.63\.1[02]|8\.186\.86)|78\.172\.(?:1(?:5[234]|8[36])|229)|2(?:2\.155\.42|5\.60\.156)|83\.221\.1[23]|30\.193\.165|09\.127\.81|97\.252\.0)|(?:79\.106\.10|217\.76\.6|5\.44\.3)9|4(?:1\.254\.[158]|6\.227\.191)|85\.(?:115\.248|26\.184)|37\.17\.11[2345])\.[012]?\d{1,2}\b)/
describe T_KHOP_PSBL_CIDR24	Relay's IP/24 CIDR contains many PSBL hits
tflags	 T_KHOP_PSBL_CIDR24	nopublish
#score	 T_KHOP_PSBL_CIDR24	2 0.6 2 0.6
##} T_KHOP_PSBL_CIDR24

##{ T_KHOP_PSBL_CIDR24 if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )

if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )
#  score  T_KHOP_PSBL_CIDR24   (0) (1.5) (0) (1.5) # BRBL(98) XBL(95)
endif
##} T_KHOP_PSBL_CIDR24 if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )

##{ T_KHOP_SC_CIDR16

header	 T_KHOP_SC_CIDR16  Received =~ /___ FAILED TO POPULATE ___/
describe T_KHOP_SC_CIDR16  Relay CIDR /16 is among worst in SpamCop
tflags	 T_KHOP_SC_CIDR16  nopublish
#score	 T_KHOP_SC_CIDR16  1.0 0.2 1.0 0.2
##} T_KHOP_SC_CIDR16

##{ T_KHOP_SC_CIDR16 if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )

if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )
#  score  T_KHOP_SC_CIDR16     (0) (1.5) (0) (1.5) # BRBL(99%), PBL(98%)
endif
##} T_KHOP_SC_CIDR16 if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )

##{ T_KHOP_SC_CIDR24

header	 T_KHOP_SC_CIDR24  Received =~ /(?-xism:\b(?:1(?:1(?:4\.141\.253|2\.90\.197)|78\.33\.170|03\.9\.156|20\.84\.13|95\.94\.11)|(?:61\.138\.10|89\.218\.22)4|218\.194\.91|58\.254\.168)\.[012]?\d{1,2}\b)/
describe T_KHOP_SC_CIDR24  Relay CIDR /24 is among worst in SpamCop
tflags	 T_KHOP_SC_CIDR24  nopublish
#score	 T_KHOP_SC_CIDR24  0.1 0 0.1 0
##} T_KHOP_SC_CIDR24

##{ T_KHOP_SC_CIDR24 if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )

if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )
#  score  T_KHOP_SC_CIDR24     (0) (0.9) (0) (0.9) # SC(99) BRBL(96) MSPIKE(96)
endif
##} T_KHOP_SC_CIDR24 if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )

##{ T_KHOP_SC_CIDR8

meta	 T_KHOP_SC_CIDR8	__KHOP_SC_CIDR8 && !(__VIA_ML||__freemail_safe||__RCVD_IN_DNSWL||RCVD_IN_HOSTKARMA_WL)
describe T_KHOP_SC_CIDR8  Relay CIDR /8 is among worst in SpamCop
tflags	 T_KHOP_SC_CIDR8  nopublish
#score	 T_KHOP_SC_CIDR8	0.3 0.1 0.3 0.1
##} T_KHOP_SC_CIDR8

##{ T_KHOP_SC_CIDR8 if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )

if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )
#  score  T_KHOP_SC_CIDR8      (0) (0.2) (0) (0.2) # BRBL(98%)
endif
##} T_KHOP_SC_CIDR8 if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )

##{ T_KHOP_SC_TOP200

header	 T_KHOP_SC_TOP200  Received =~ /(?-xism:\b(?:1(?:1(?:4\.(?:1(?:13\.221\.66|41\.253\.14)|207\.113\.55)|9\.(?:1(?:80\.26\.110|93\.93\.25)|36\.138\.131)|6\.(?:112\.66\.102|255\.164\.18|90\.162\.116)|2\.(?:133\.201\.70|217\.161\.58)|5\.(?:88\.119\.132|22\.80\.197)|8\.2(?:44\.182\.94|6\.204\.182)|3\.108\.201\.189|1\.68\.104\.133)|2(?:1\.(?:1(?:81\.2(?:37\.251|51\.188)|45\.120\.75)|22\.(?:127\.17|34\.166)|66\.95\.156|49\.107\.2)|4\.(?:42\.124\.136|67\.69\.52)|0\.132\.132\.119|\.158\.188\.155|3\.30\.174\.61|5\.7\.221\.146)|9(?:5\.(?:1(?:(?:28\.253\.15|91\.184\.8)2|3(?:8\.195\.125|\.200\.218))|9(?:4\.11\.1[79]|8\.81\.3)|29\.81\.30)|(?:3\.200\.126\.1|4\.213\.122\.3)4|0\.(?:202\.116\.101|82\.89\.156)|9\.255\.11\.29)|7(?:8\.(?:3(?:2\.223\.8|3\.38\.17)8|207\.158\.230|49\.170\.57|91\.254\.66|151\.86\.1)|3\.2(?:00\.90\.19|45\.31\.13)6|6\.53\.112\.2(?:2[78]|3[12])|4\.137\.168\.212|7\.21\.1\.34)|8(?:0\.2(?:11\.1(?:91\.25|79\.3)0|25\.131\.176)|8\.(?:127\.230\.28|252\.0\.237)|5\.20\.52\.118|9\.75\.63\.114|7\.111\.3\.22)|0(?:9\.(?:195\.54\.231|236\.220\.98)|8\.178\.59\.34|1\.44\.3\.50)|4(?:4\.76\.31\.172|\.63\.74\.204))|2(?:1(?:7\.(?:2(?:1(?:9\.1(?:23\.59|32\.15)|8\.43\.130)|3\.(?:2\.1(?:3[37]|02|29|61)|8\.118))|12\.113\.67|97\.211\.20)|3\.(?:2(?:30\.128\.226|51\.186\.229|21\.9\.13)|1(?:71\.39\.154|86\.39\.43)|81\.164\.57|0\.89\.6)|0\.(?:1(?:17\.6\.152|3\.210\.84|68\.50\.16)|2(?:23\.111\.8|45\.89\.69)|32\.34\.115|51\.44\.199)|1\.(?:1(?:04\.184\.195|11\.174\.98|47\.211\.16)|33\.121\.196)|9\.(?:2(?:23\.252\.150|19\.114\.74)|143\.3\.210)|2\.(?:144\.254\.122|49\.70\.48)|8\.1(?:94\.91\.238|6\.210\.10)|6\.153\.136\.125)|0(?:0\.(?:2(?:47\.100\.178|06\.14\.26)|7(?:2\.11\.132|9\.27\.60)|142\.133\.21|68\.76\.69)|2\.(?:1(?:42\.203\.19|58\.39\.250)|29\.216\.236|71\.136\.200|44\.53\.64|91\.25\.41)|1\.(?:1(?:95\.239\.27|8\.93\.170)|65\.114\.212|45\.114\.3)|3\.(?:155\.102\.2|249\.75\.17)|9\.238\.180\.166|8\.115\.244\.54)|2(?:2\.(?:1(?:74\.(?:255\.238|54\.164|163\.2)|22\.79\.121)|255\.27\.140)|1\.(?:2(?:07\.220\.140|14\.208\.226)|1(?:43\.51\.201|39\.0\.67))|3\.4\.233\.16[45])|\.183\.155\.2)|6(?:1\.(?:1(?:3(?:3\.125\.162|8\.104\.30|6\.68\.76)|6(?:6\.55\.153|3\.37\.76)|75\.223\.1(?:34|42))|55\.156\.210|98\.131\.141)|6\.(?:84\.(?:50\.133|49\.9)|199\.227\.115|240\.232\.54)|0\.(?:173\.11\.121|2\.227\.123)|2\.146\.28\.212)|8(?:9\.218\.(?:68\.(?:146|74|90)|224\.(?:35|58)|94\.166)|1\.1(?:7\.16\.13[47]|5\.172\.145)|5\.(?:113\.141\.251|214\.157\.75)|3\.(?:111\.92\.120|3\.103\.227)|7\.(?:103\.197\.9|98\.226\.3)3|0\.36\.130\.135|8\.204\.187\.90)|9(?:5\.(?:51\.156\.218|159\.105\.2|48\.24\.10)|(?:1\.144\.153|0\.83\.184)\.211|4\.23\.(?:100\.24|2\.185)|3\.159\.160\.164)|4(?:2\.121\.(?:1(?:05\.138|18\.123)|81\.212)|6\.(?:99\.253\.158|48\.191\.71)|1\.1(?:85\.21\.186|37\.24\.4))|7(?:4\.(?:122\.227\.124|216\.223\.82|9\.203\.186)|7\.106\.232\.178|5\.127\.15\.143|9\.165\.252\.66)|5(?:9\.(?:11\.237\.151|34\.57\.88|60\.7\.146)|\.39\.49\.149)|3(?:1\.210\.47\.230|7\.59\.62\.186))\b)/
describe T_KHOP_SC_TOP200  Relay listed in SpamCop top 200 spammer IPs
tflags	 T_KHOP_SC_TOP200  nopublish
#score	 T_KHOP_SC_TOP200  4 0 4 0	# unnecessary if DNSBLs work
##} T_KHOP_SC_TOP200

##{ T_KHOP_SC_TOP200 if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )

if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )
#  score  T_KHOP_SC_TOP200     (0) (4.4) (0) (4.4) # SC(99) PSBL(99) ...
endif
##} T_KHOP_SC_TOP200 if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )

##{ T_KHOP_SC_TOP_CIDR16

header	 T_KHOP_SC_TOP_CIDR16  Received =~ /(?-xism:\b(?:187\.111|222\.174)(?:\.[012]?\d{1,2}){2}\b)/
describe T_KHOP_SC_TOP_CIDR16  Relay CIDR /16 leads SpamCop in worst /16s
tflags	 T_KHOP_SC_TOP_CIDR16  nopublish
#score	 T_KHOP_SC_TOP_CIDR16  2.0 0.3 2.0 0.4
##} T_KHOP_SC_TOP_CIDR16

##{ T_KHOP_SC_TOP_CIDR16 if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )

if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )
#  score  T_KHOP_SC_TOP_CIDR16 (0) (1.7) (0) (1.7) # BRBL(99%), PBL(94%)
endif
##} T_KHOP_SC_TOP_CIDR16 if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )

##{ T_KHOP_SC_TOP_CIDR24

header	 T_KHOP_SC_TOP_CIDR24  Received =~ /(?-xism:\b(?:1(?:2(?:0\.(?:128\.2|84\.13)|5\.60\.156)|(?:76\.53\.1|83\.221\.)12|03\.9\.156|12\.97\.24|44\.76\.31)|2(?:1(?:0\.(?:21\.225|51\.44)|7\.23\.2)|22\.174\.163)|8(?:0\.36\.130|9\.218\.68))\.[012]?\d{1,2}\b)/
describe T_KHOP_SC_TOP_CIDR24  Relay CIDR /24 leads SpamCop in worst /24s
tflags	 T_KHOP_SC_TOP_CIDR24  nopublish
#score	 T_KHOP_SC_TOP_CIDR24  2.7 0.5 2.7 0.5
##} T_KHOP_SC_TOP_CIDR24

##{ T_KHOP_SC_TOP_CIDR24 if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )

if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )
#  score  T_KHOP_SC_TOP_CIDR24 (0) (2.5) (0) (2.5) # MSPIKE(99) SC(98) BRBL(97) ...
endif
##} T_KHOP_SC_TOP_CIDR24 if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )

##{ T_KHOP_SC_TOP_CIDR8

meta	 T_KHOP_SC_TOP_CIDR8  __KHOP_SC_TOP_CIDR8 && !(__VIA_ML||__freemail_safe||__RCVD_IN_DNSWL||RCVD_IN_HOSTKARMA_WL)
describe T_KHOP_SC_TOP_CIDR8  Relay CIDR /8 leads SpamCop in worst /8s
tflags	 T_KHOP_SC_TOP_CIDR8  nopublish
#score	 T_KHOP_SC_TOP_CIDR8  0.2 0 0.2 0
##} T_KHOP_SC_TOP_CIDR8

##{ T_KHOP_SC_TOP_CIDR8 if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )

if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )
#  score  T_KHOP_SC_TOP_CIDR8  (0) (0.9) (0) (0.9) # BRBL(98%)
endif
##} T_KHOP_SC_TOP_CIDR8 if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )

##{ T_KHOP_SMIME_SIGNED

meta	 T_KHOP_SMIME_SIGNED	__SMIME_SIGNED
describe T_KHOP_SMIME_SIGNED	Message seems to contain S/MIME signature
tflags	 T_KHOP_SMIME_SIGNED	nice noautolearn nopublish
#score	 T_KHOP_SMIME_SIGNED	-2 -2 -3 -3
##} T_KHOP_SMIME_SIGNED

##{ T_KHOP_SPAMDB_SUBJ

header	 T_KHOP_SPAMDB_SUBJ Subject =~ m{(?-xism:^(?:A(?:dobe (?:(?:Creative Suite 4 Master Collection. Our Price: .32|Acrobat 9 Pro for MAC - Our Price: .9)9.95.|Photoshop CS5 Extended -  .199.95)|cademic and student discount software - Mac software. Microsoft|(?:vira Premium Security Suite 9 - .|utoCAD 2011 - .3)19.95|CDSee. Adobe Macromedia. Anti-Virus. Security| great tool for great focus. Adderall.|n(?:-ti vi-rus software.|y problems)|ffordable home ownership for vets)|(?:Xara Xtreme PRO 5 for Windows (?:will (?:allow you to apply various effects on image|help you create professional 3D object)s|for only 79.95 dollars. obtain one right now)|If you work with drawings and websites. use Xara Xtreme PRO 5 for Windows at work|Licensed Xara Xtreme PRO 5 for Windows for as low as .79.95. buy it right now|90% SALE for MICROSOFT WINDOWS 7 ULTIMATE .64 BIT. ).|S(?:(?:elf-test your blood glucose with a free meter from Liberty|ick and tired of your old time-piece. Get a new one here).|t(?:ay Hard and Long ALL night Starting Today.|op your dog.s annoying barking)|oftware license (?:locallzed language version|Video and Audio Editor)s|PECIAL OFFERS - Windows 7 and Office 2007 .64bit. - .149.95|pend endless nights of pleasure|uper Collection)|C(?:o(?:rel(?:. Cyberlink DVD.FileMaker. Macromedia|DRAW Graphics Suite X4 - .119.95)|mpare fire alarm system prices. Find the best deal and save today.)|h(?:eap popular licensed software|ild Safety ID Kit)|anadian Pharmacy is worth a try.)|Re(?:: (?:Re: (?:h(?:i (?:mate|bud)|ey mate)|yo (?:mate|bud))|Please. tell me success stories about V|Second time in you order|worldwide delivery info|Order process)|al(?: University diplomas.|istic Solution))|You(?: can (?:even create websites due to Xara Xtreme PRO 5 for Windows features.|buy Phentermin On-Line Today.  )|r (?:free glucose meter is waiting for you.|supplies may be covered with Medicare))|O(?:ffice (?:Home and Student 2007 - . .69.95|suites software free).|rder now best software. Microsoft Office 2010 for MAC|ne of every ten men is completely impotent|pportunities in medical billing)|N(?:o(?: more hard work. Xara Xtreme PRO 5 for Windows will do everything for you.|rton 360 Version 3.0 Premier Edition - .49.95)|e(?:ed pain killers..Get them Her|w resum)e.|ice Collection)|P(?:o(?:tty pad that prevents stains and rinses clean in seconds|ssible Solution)|et meds for less at PetCareRx - order today|rint online anytime. anywhere.|lease Read|FIZER Inc)|W(?:(?:hat(?: (?:do you know|gives)|.s (?:new|up))|e will call you back).|indows 7 Ultimate (?:64 bit. Our Price: .99.95|32 bit - -.149.95-))|Th(?:a(?:nk you for buying iTunes Gift Certificate.|t's the latest news)|e (?:Best Software for Mac OS X .OSX.|best photo editing software))|G(?:o(?:od cheap software cheap software Mac| Mobile. Get Savings.|rgeous Collection)|I Bill Benefit Alert for Soldiers|reat Collection)|D(?:is(?:appointed with your bad performance in bed.|count (?:OEM Software.|WINDOWS 7))|o you need to lose_s0me_weight.)|F(?:ree (?:(?:Software and Shareware Downloads|(?:For All S|s)oftware).|Office 2010)|abulous Collection|ind out)|M(?:edicare may cover the cost of your diabetes supplies|asters degree with no efforts.|icrosoft Office 2010)|(?: ... .. ...|... ... ... )    ....... 100%...|B(?:e(?:ta Is Just The Beginning|autiful Collection)|uy Cheap Microsoft Windows 7 Ultimate)| . .    .......... 50%SALE|Quark XPress. Roxio. Utilites and Programming|Hot Collection)$)}
describe T_KHOP_SPAMDB_SUBJ Matches one of the SPAMDB top 100 spam subjects
tflags	 T_KHOP_SPAMDB_SUBJ nopublish # auto-generated rule
##} T_KHOP_SPAMDB_SUBJ

##{ T_KHOP_SPAMHAUS_DROP

header	 T_KHOP_SPAMHAUS_DROP	X-Spam-Relays-Untrusted =~ /___ FAILED TO POPULATE ___/
describe T_KHOP_SPAMHAUS_DROP	Relay listed in Spamhaus Don't Route Or Peer List
tflags	 T_KHOP_SPAMHAUS_DROP	nopublish
#score	 T_KHOP_SPAMHAUS_DROP	1 0.2 1 0.2
##} T_KHOP_SPAMHAUS_DROP

##{ T_KHOP_SPAMHAUS_DROP if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )

if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )
#  score  T_KHOP_SPAMHAUS_DROP (0) (3)   (0) (3)	# SBL(78)
endif
##} T_KHOP_SPAMHAUS_DROP if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )

##{ T_KHOP_SPAMHAUS_DROP_LE

header	 T_KHOP_SPAMHAUS_DROP_LE	X-Spam-Relays-External =~ /^[^]]*___ FAILED TO POPULATE ___/
describe T_KHOP_SPAMHAUS_DROP_LE	Relay listed in Spamhaus Don't Route Or Peer List
tflags	 T_KHOP_SPAMHAUS_DROP_LE	nopublish
#score	 T_KHOP_SPAMHAUS_DROP_LE	2 0 2 0 	# adds to T_KHOP_SPAMHAUS_DROP
##} T_KHOP_SPAMHAUS_DROP_LE

##{ T_KHOP_THREADED

meta	 T_KHOP_THREADED	__THREADED
describe T_KHOP_THREADED	Message references or replies to another message
tflags	 T_KHOP_THREADED	nice nopublish
##} T_KHOP_THREADED

##{ T_KHOP_UNSUB_EMAIL

meta	 T_KHOP_UNSUB_EMAIL	!__UNSUB_LINK && (__UNSUB_EMAIL||__UNSUB_MAILTO)
describe T_KHOP_UNSUB_EMAIL	Unsubscribe by email but not by link
##} T_KHOP_UNSUB_EMAIL

##{ T_KHOP_UNSUB_LINK

meta	 T_KHOP_UNSUB_LINK	__UNSUB_LINK && !__NOT_A_PERSON
describe T_KHOP_UNSUB_LINK	Personal message has unsusbscribe link
tflags	 T_KHOP_UNSUB_LINK	nopublish
#score	 T_KHOP_UNSUB_LINK	0.001
##} T_KHOP_UNSUB_LINK

##{ T_LAZY_LISTWASHING

header         T_LAZY_LISTWASHING   To =~ /\@(?:example\.com|example\.domain|your\.domain|some\.domain|domain\.dom|somewhere\.tld|somewhere\.com|your\.?domain\.com|your\.favorite\.machine)\b/i
describe       T_LAZY_LISTWASHING   Lazy spammer, painfully obvious bogus addresses
##} T_LAZY_LISTWASHING

##{ T_LH_URI_DOM_IN_PATH

uri             T_LH_URI_DOM_IN_PATH      /:\/\/[^\/]{25,}\/[^\/]+\/[^\@]+[a-z0-9]\w{3,}\.(?:com|gov|net)/i
describe        T_LH_URI_DOM_IN_PATH      Long-host URI having a domain name in the path part
##} T_LH_URI_DOM_IN_PATH

##{ T_LIVEFILESTORE_HTML

uri  T_LIVEFILESTORE_HTML  m~livefilestore.com/[^/]{0,100}/[^/]{0,20}\.html?$~
##} T_LIVEFILESTORE_HTML

##{ T_LOCAL_PP_UPD_BADURL

meta T_LOCAL_PP_UPD_BADURL (__FROM_PAYPAL && ((__LOCAL_PP_B_UPD || __LOCAL_PP_S_UPD) || __LOCAL_PP_PPCGIURL) && __LOCAL_PP_NONPPURL)
describe T_LOCAL_PP_UPD_BADURL paypal account update, but has bad URL
##} T_LOCAL_PP_UPD_BADURL

##{ T_LOLLY_419

body T_LOLLY_419      /\bLolly Stevens\b/
describe T_LOLLY_419  Your name is "Lolly"?  _sure_ it is
##} T_LOLLY_419

##{ T_LONGLINE

meta     T_LONGLINE	__LONGLINE
describe T_LONGLINE	Line length exceeds 998 character limit, RFC 5322
##} T_LONGLINE

##{ T_LONG_HEADER_LINE_160

header	 T_LONG_HEADER_LINE_160	ALL:raw =~ /^(?-xis:(?=(?!X-Spam|X-MailScan|Received).{160,239}$))/m
describe T_LONG_HEADER_LINE_160	A header line contains 160-239 characters
##} T_LONG_HEADER_LINE_160

##{ T_LONG_HEADER_LINE_240

header	 T_LONG_HEADER_LINE_240	ALL:raw =~ /^(?-xis:(?=(?!X-Spam|X-MailScan|Received).{240,319}$))/m
describe T_LONG_HEADER_LINE_240	A header line contains 240-319 characters
##} T_LONG_HEADER_LINE_240

##{ T_LONG_HEADER_LINE_320

header	 T_LONG_HEADER_LINE_320	ALL:raw =~ /^(?-xis:(?=(?!X-Spam|X-MailScan|Received).{320,399}$))/m
describe T_LONG_HEADER_LINE_320	A header line contains 320-399 characters
##} T_LONG_HEADER_LINE_320

##{ T_LONG_HEADER_LINE_400

header	 T_LONG_HEADER_LINE_400	ALL:raw =~ /^(?-xis:(?=(?!X-Spam|X-MailScan|Received).{400,499}$))/m
describe T_LONG_HEADER_LINE_400	A header line contains 400-499 characters
##} T_LONG_HEADER_LINE_400

##{ T_LONG_HEADER_LINE_500

header	 T_LONG_HEADER_LINE_500	ALL:raw =~ /^(?-xis:(?=(?!X-Spam|X-MailScan|Received).{500}))/m
describe T_LONG_HEADER_LINE_500	A header line contains 500+ characters
##} T_LONG_HEADER_LINE_500

##{ T_LONG_HEADER_LINE_80

header	 T_LONG_HEADER_LINE_80	ALL:raw =~ /^(?-xis:(?=(?!X-Spam|X-MailScan|Received).{80,159}$))/m
describe T_LONG_HEADER_LINE_80	A header line contains 80-159 characters
##} T_LONG_HEADER_LINE_80

##{ T_MAILER_EQ_ORG

meta           T_MAILER_EQ_ORG         __MUA_EQ_ORG_1 || __MUA_EQ_ORG_2
describe       T_MAILER_EQ_ORG         X-Mailer: same as Organization:
##} T_MAILER_EQ_ORG

##{ T_MALFORMED_FREEMAIL

meta	 T_MALFORMED_FREEMAIL	(MISSING_HEADERS||__HDRS_LCASE) && FREEMAIL_FROM
describe T_MALFORMED_FREEMAIL	Bad headers on message from free email service
##} T_MALFORMED_FREEMAIL

##{ T_MANY_APPARENTLY_TO

meta           T_MANY_APPARENTLY_TO         __APPARENTLY_TO > 20
describe       T_MANY_APPARENTLY_TO         Has many Apparently-To headers
tflags         T_MANY_APPARENTLY_TO         nopublish
##} T_MANY_APPARENTLY_TO

##{ T_MANY_SUBDOM

meta           T_MANY_SUBDOM         __MANY_SUBDOM && !__JM_REACTOR_DATE && !__UNSUB_LINK && !__VIA_ML && !NO_RELAYS && !__UPPERCASE_URI && !__MIME_QP
describe       T_MANY_SUBDOM         Lots and lots of subdomain parts in a URI
##} T_MANY_SUBDOM

##{ T_MAY_BE_FORGED

meta	 T_MAY_BE_FORGED	__MAY_BE_FORGED && !__NOT_SPOOFED && !__VIA_ML
describe T_MAY_BE_FORGED	Relay IP's reverse DNS does not resolve to IP
##} T_MAY_BE_FORGED

##{ T_MDN_BOTCHED

header         T_MDN_BOTCHED           Disposition-notification-to =~ /<>/
describe       T_MDN_BOTCHED           Malformed return receipt header
##} T_MDN_BOTCHED

##{ T_MIME_MALF

meta        T_MIME_MALF        __MIME_MALF && !ALL_TRUSTED
describe    T_MIME_MALF        Malformed MIME: headers in body
#score       T_MIME_MALF        2.00	# limit
##} T_MIME_MALF

##{ T_MISQ_HTML

rawbody        T_MISQ_HTML           /<\w{2,20}[^>=]{1,30}=[^"][^">]{1,30}[^=]"[\s>]/
describe       T_MISQ_HTML           Unbalanced quotes in HTML tag
tflags         T_MISQ_HTML           nopublish
##} T_MISQ_HTML

##{ T_MONEY_12LTRDOM

meta           T_MONEY_12LTRDOM      __MONEY_12LTRDOM
#score          T_MONEY_12LTRDOM      0.10		# limit
describe       T_MONEY_12LTRDOM      Mentions lots of money and from a 12-letter domain
##} T_MONEY_12LTRDOM

##{ T_MONEY_FORM

meta     T_MONEY_FORM          __MONEY_FORM && !__FB_TOUR && !__FM_MY_PRICE && !__FR_SPACING_8 && !__COMMENT_EXISTS && !__CAN_HELP
describe T_MONEY_FORM          Lots of money if you fill out a form
##} T_MONEY_FORM

##{ T_MONEY_FRAUD_8

meta     T_MONEY_FRAUD_8    __MONEY_FRAUD_8 && !__VIA_ML && !__HAS_THREAD_INDEX
describe T_MONEY_FRAUD_8    Lots of money and very many fraud phrases
tflags   T_MONEY_FRAUD_8    nopublish
##} T_MONEY_FRAUD_8

##{ T_MONEY_LOTTERY

meta     T_MONEY_LOTTERY    __MONEY_LOTTERY && !__CAN_HELP && !__HTML_LINK_IMAGE && !__DOS_HAS_LIST_UNSUB && !__MSGID_APPLEMAIL && __THREADED
describe T_MONEY_LOTTERY    Lots of money from a lottery
##} T_MONEY_LOTTERY

##{ T_MSGID_NOFQDN1

header   T_MSGID_NOFQDN1  Message-ID =~ /<[^\@]*>/m
describe T_MSGID_NOFQDN1  Message-ID with no domain name
##} T_MSGID_NOFQDN1

##{ T_MSGID_NOFQDN2

header   T_MSGID_NOFQDN2  Message-ID =~ /<.*\@[A-Za-z0-9]+>/m
describe T_MSGID_NOFQDN2  Message-ID without a fully-qualified domain name
##} T_MSGID_NOFQDN2

##{ T_MSGID_WSP_TRAIL

header   T_MSGID_WSP_TRAIL Message-ID:raw =~ /< [^>]* \s > [^<>]* \z/xm
describe T_MSGID_WSP_TRAIL Trailing whitespace before '>' in Message-ID header
##} T_MSGID_WSP_TRAIL

##{ T_MSNBC_HDR_ORDER

header T_MSNBC_HDR_ORDER          ALL =~ /\nContent-Transfer-Encoding: 7bit\nX-Mailer: Microsoft CDO for Windows 2000\nContent-Class: urn:content-classes:message\nImportance: normal\nPriority: normal\nX-MimeOLE: Produced By Microsoft MimeOLE V6.00.3790.3119\n/s
##} T_MSNBC_HDR_ORDER

##{ T_MSNBC_MESSAGEGUID

header T_MSNBC_MESSAGEGUID        exists:messageGUID
##} T_MSNBC_MESSAGEGUID

##{ T_MSNBC_THREAD_INDEX

meta T_MSNBC_THREAD_INDEX (__MSNBC_THREAD_INDEX && !__MSNBC_NOT_EXCH)
##} T_MSNBC_THREAD_INDEX

##{ T_MS_XYMOSG_1K

header	 T_MS_XYMOSG_1K	X-YMail-OSG =~ /^(?=.{1024,2047}$)/s
##} T_MS_XYMOSG_1K

##{ T_MS_XYMOSG_2K

header	 T_MS_XYMOSG_2K	X-YMail-OSG =~ /^(?=.{2048,3071}$)/s
##} T_MS_XYMOSG_2K

##{ T_MS_XYMOSG_3K

header	 T_MS_XYMOSG_3K	X-YMail-OSG =~ /^(?=.{3072,4095}$)/s
##} T_MS_XYMOSG_3K

##{ T_MS_XYMOSG_4K

header	 T_MS_XYMOSG_4K	X-YMail-OSG =~ /^(?=.{4096,5119}$)/s
##} T_MS_XYMOSG_4K

##{ T_MS_XYMOSG_5K

header	 T_MS_XYMOSG_5K	X-YMail-OSG =~ /^(?=.{4096})/s
##} T_MS_XYMOSG_5K

##{ T_NAME_EMAIL_DIFF

meta	 T_NAME_EMAIL_DIFF	__NAME_IS_EMAIL && ! __NAME_EQ_EMAIL
describe T_NAME_EMAIL_DIFF	Sender NAME is an unrelated email address
##} T_NAME_EMAIL_DIFF

##{ T_NICE_REPLY_A

meta     T_NICE_REPLY_A		(__SUBJ_RE && !__MISSING_REPLY && !__MISSING_REF && __BOTH_INR_AND_REF)
describe T_NICE_REPLY_A		Looks like a legit relpy (A)
tflags     T_NICE_REPLY_A		nopublish
##} T_NICE_REPLY_A

##{ T_NICE_REPLY_B

meta     T_NICE_REPLY_B		(__SUBJ_RE && !__MISSING_REPLY && __MISSING_REF && __INR_AND_NO_REF)
tflags     T_NICE_REPLY_B		nopublish
##} T_NICE_REPLY_B

##{ T_NICE_REPLY_C

meta     T_NICE_REPLY_C		(__SUBJ_RE && __MISSING_REPLY && !__MISSING_REF && __NO_INR_YES_REF)
tflags    T_NICE_REPLY_C		nopublish
##} T_NICE_REPLY_C

##{ T_NOT_A_PERSON

meta	 T_NOT_A_PERSON	__NOT_A_PERSON
describe T_NOT_A_PERSON   List, replier, bot, etc.  Filters: skip auto-reply
tflags	 T_NOT_A_PERSON	nice
#score	 T_NOT_A_PERSON	-0.001	# PIN ME HERE
##} T_NOT_A_PERSON

##{ T_NOT_SPAM

body        T_NOT_SPAM           /\b(?:this mail cannot be considered Spam|ESTE CORREO NO PUEDE SER CONSIDERADO (?:INTRUSIVO|spam))\b/i
describe    T_NOT_SPAM           I'm not spam! Really!
##} T_NOT_SPAM

##{ T_NSL_TO_ENDS_COMMA

header      T_NSL_TO_ENDS_COMMA      To =~ /,$/
describe    T_NSL_TO_ENDS_COMMA      To: ends with a comma
tflags      T_NSL_TO_ENDS_COMMA      nopublish
##} T_NSL_TO_ENDS_COMMA

##{ T_OE_MULTIPART_RELATED

meta T_OE_MULTIPART_RELATED (__OE_MUA && __MULTIPART_RELATED)
tflags T_OE_MULTIPART_RELATED nopublish
##} T_OE_MULTIPART_RELATED

##{ T_OPERA_MID_NON_OP

meta     T_OPERA_MID_NON_OP      __OPERA_MUA && __OPERA_MID_NON_OP
describe T_OPERA_MID_NON_OP      MUA Opera, Message-Id does not start with op
##} T_OPERA_MID_NON_OP

##{ T_OPERA_MID_NO_DIGIT

meta     T_OPERA_MID_NO_DIGIT    __OPERA_MUA && __OPERA_MID_NO_DIGIT
describe T_OPERA_MID_NO_DIGIT    MUA Opera, Message-Id does not contain digit
##} T_OPERA_MID_NO_DIGIT

##{ T_POSTCARD_01

header     T_POSTCARD_01   Subject =~ /You(?:'ve| have) (?:just )?(?:rec[ei]{2}ved )?an? (?:new )?(?:greeting |anonymous |virtual )?(?:post|e-?)?card (?:sen[dt] )?(?:from|by) an? (?:admirer|colleague|family member|friend|mate|neighbou?r|partner|(?:class|school).?(?:friend|mate)|worshipper|anonymous|buddy)/i
describe   T_POSTCARD_01   You got a postcard!
##} T_POSTCARD_01

##{ T_POSTCARD_02

header     T_POSTCARD_02   Subject =~ /you have a new greeting/i
describe   T_POSTCARD_02   You got a postcard!
##} T_POSTCARD_02

##{ T_POSTCARD_03

header     T_POSTCARD_03   From =~ /\b(?:[a-z]{0,10}greeting[a-z]{0,10}|(?:[a-z]{0,10}post|netfun)card[a-z]{0,10})\.[a-z]{2,5}/i
describe   T_POSTCARD_03   From a postcard domain
##} T_POSTCARD_03

##{ T_POSTCARD_04

header     T_POSTCARD_04   Subject =~ /You(?:'ve| have) (?:just )?(?:rec[ei]{2}ved )?an? (?:new )?(?:greeting |anonymous |virtual )?Hallmark (?:post|love-|e-?)?card(?: (?:sen[dt] )?(?:from|by) an? (?:admirer|colleague|family member|friend|mate|neighbou?r|partner|(?:class|school).?(?:friend|mate)|worshipper|anonymous|buddy))?/i
describe   T_POSTCARD_04   You got a forged Hallmark postcard!
##} T_POSTCARD_04

##{ T_POSTCARD_05

header     T_POSTCARD_05   Subject =~ /(?:[-\w]{3,20}\s+)+(?:has\s+)?sen[dt]\s+you\s+an?\s+(?:[-\w]{3,20}\s+)*"?(?:post|e-?)?card"?/i
describe   T_POSTCARD_05   You got a postcard!
##} T_POSTCARD_05

##{ T_POSTCARD_06

header     T_POSTCARD_06   Subject =~ /^(?:an?\s+)?(?:Animated|Digital|Funny|Greeting|Holiday|Thank[-\s]you|Musical|Love|Birthday|Movie[-\s]quality)\s+(?:e-?|post)?card/i
describe   T_POSTCARD_06   You got a postcard!
##} T_POSTCARD_06

##{ T_POSTCARD_07

header     T_POSTCARD_07   Subject =~ /^You(?:'ve| have) an? (?:new )?(?:greeting |anonymous |virtual )?(?:post|e-?)?card (?:.{0,30}\s)?waiting for you/i
describe   T_POSTCARD_07   You got a postcard!
##} T_POSTCARD_07

##{ T_POSTCARD_08

header     T_POSTCARD_08   Subject =~ /You(?:'ve| have) (?:just )?(?:rec[ei]{2}ved )?an? (?:new )?(?:greeting |anonymous |virtual )?(?:post|e-?)?card/i
describe   T_POSTCARD_08   You got a postcard!
##} T_POSTCARD_08

##{ T_POSTCARD_09

body       T_POSTCARD_09   /(?:rec[ie]{2}ve|view|enjoy|download|open|pick\sup)\syour\s(?:post|e-?)?card/i
describe   T_POSTCARD_09   You got a postcard!
##} T_POSTCARD_09

##{ T_POSTCARD_DQ

meta       T_POSTCARD_DQ   NORMAL_HTTP_TO_IP && (T_POSTCARD_01 || T_POSTCARD_02 || T_POSTCARD_03 || T_POSTCARD_04 || T_POSTCARD_05 || T_POSTCARD_06 || T_POSTCARD_07 || T_POSTCARD_08 || T_POSTCARD_09 || __POSTCARD_HALLMARK_01 || __POSTCARD_HALLMARK_02)
describe   T_POSTCARD_DQ   Postcard + DQ URI
##} T_POSTCARD_DQ

##{ T_POSTCARD_EXE

meta       T_POSTCARD_EXE   __EXECUTABLE_URI && (T_POSTCARD_01 || T_POSTCARD_02 || T_POSTCARD_03 || T_POSTCARD_04 || T_POSTCARD_05 || T_POSTCARD_06 || T_POSTCARD_07 || T_POSTCARD_08 || T_POSTCARD_09 || __POSTCARD_HALLMARK_01 || __POSTCARD_HALLMARK_02)
describe   T_POSTCARD_EXE   Postcard + Executable URI
##} T_POSTCARD_EXE

##{ T_PQRTW_4

meta     T_PQRTW_4         __PQRTW_4_A || __PQRTW_4_SPAN
##} T_PQRTW_4

##{ T_PR_TD_NOWRAP_BAT

meta T_PR_TD_NOWRAP_BAT     (__THEBAT_MUA && __PR_TD_NOWRAP)
##} T_PR_TD_NOWRAP_BAT

##{ T_PUBLISHED_DNSBLS

meta	 T_PUBLISHED_DNSBLS	RCVD_IN_XBL || RCVD_IN_PBL || RCVD_IN_PSBL || RCVD_IN_SORBS_DUL || RCVD_IN_SORBS_WEB || RCVD_IN_BL_SPAMCOP_NET || RCVD_IN_RP_RNBL
tflags	 T_PUBLISHED_DNSBLS	net nopublish	# 20110127
##} T_PUBLISHED_DNSBLS

##{ T_PUBLISHED_DNSBLS_BRBL

meta	 T_PUBLISHED_DNSBLS_BRBL	T_PUBLISHED_DNSBLS || RCVD_IN_BRBL_LASTEXT
tflags	 T_PUBLISHED_DNSBLS_BRBL	net nopublish	# 20110127
##} T_PUBLISHED_DNSBLS_BRBL

##{ T_RATWARE_HELO_DM

header T_RATWARE_HELO_DM     X-Spam-Relays-External =~ / helo=DM /
describe T_RATWARE_HELO_DM   External host used 'DM' as the HELO name, DarkMailer signature
##} T_RATWARE_HELO_DM

##{ T_RCD_RDNS_DYNAMIC

meta T_RCD_RDNS_DYNAMIC __RCD_RDNS_DIAL_MESSY || __RCD_RDNS_DYN_MESSY || __RCD_RDNS_PROXY_MESSY || __RCD_RDNS_PPP_MESSY || __RCD_RDNS_PPOE_MESSY
tflags T_RCD_RDNS_DYNAMIC nopublish
##} T_RCD_RDNS_DYNAMIC

##{ T_RCD_RDNS_DYNAMIC_CLEAN

meta T_RCD_RDNS_DYNAMIC_CLEAN T_RCD_RDNS_DYNAMIC_MESSY && !T_RCD_RDNS_SERVER_MESSY
tflags T_RCD_RDNS_DYNAMIC_CLEAN nopublish
##} T_RCD_RDNS_DYNAMIC_CLEAN

##{ T_RCD_RDNS_DYNAMIC_MESSY

meta T_RCD_RDNS_DYNAMIC_MESSY __RCD_RDNS_DIAL_MESSY || __RCD_RDNS_DYN_MESSY || __RCD_RDNS_PROXY || __RCD_RDNS_PPP_MESSY || __RCD_RDNS_PPOE_MESSY
tflags T_RCD_RDNS_DYNAMIC_MESSY nopublish
##} T_RCD_RDNS_DYNAMIC_MESSY

##{ T_RCD_RDNS_SERVER

meta T_RCD_RDNS_SERVER __RCD_RDNS_MX || __RCD_RDNS_SMTP || __RCD_RDNS_MTA || __RCD_RDNS_STATIC || __RCD_RDNS_OB || __RCD_RDNS_MAIL
tflags T_RCD_RDNS_SERVER nice nopublish
##} T_RCD_RDNS_SERVER

##{ T_RCD_RDNS_SERVER_MESSY

meta T_RCD_RDNS_SERVER_MESSY __RCD_RDNS_MX_MESSY_MESSY || __RCD_RDNS_SMTP_MESSY || __RCD_RDNS_MTA_MESSY || __RCD_RDNS_STATIC_MESSY || __RCD_RDNS_OB_MESSY || __RCD_RDNS_MAIL_MESSY
tflags T_RCD_RDNS_SERVER_MESSY nice nopublish
##} T_RCD_RDNS_SERVER_MESSY

##{ T_RCVD_FORGED_WROTE3

header T_RCVD_FORGED_WROTE3 Received =~ /from \[[0-9.]+\] \(port=\d+ helo=\S+[A-Za-z]+\) by (\S+) with asmtp id \S{6}-\S{6}-\S\S for \S+@\1;/s
##} T_RCVD_FORGED_WROTE3

##{ T_RCVD_FORGED_WROTE4

header T_RCVD_FORGED_WROTE4 Received =~ /from [0-9.]+ \(HELO \S+[A-Za-z]+\) by (\S+) with \(8[0-9.]+\/8[0-9.]+\) ESMTP [0-9a-z]{14} for \S+@\1;/s
##} T_RCVD_FORGED_WROTE4

##{ T_RCVD_INVALID_IP

header T_RCVD_INVALID_IP Received =~ /(?:^|[\[\s]) (?!(?:1\d\d|2[0-4]\d|25[0-5]|\d\d|\d)(?:\.(?:1\d\d|2[0-4]\d|25[0-5]|\d\d|\d)){3}) \d{1,3}(?:\.\d{1,3}){3} (?:$|[\]\s])/xm
tflags T_RCVD_INVALID_IP nopublish
#score T_RCVD_INVALID_IP 0.001
##} T_RCVD_INVALID_IP

##{ T_RCVD_IN_NIX_SPAM

header	 T_RCVD_IN_NIX_SPAM	eval:check_rbl('nix-spam-lastexternal','ix.dnsbl.manitu.net.')
describe T_RCVD_IN_NIX_SPAM	Received via a relay in NiX Spam (heise.de)
tflags	 T_RCVD_IN_NIX_SPAM	net nopublish	# 20091123
##} T_RCVD_IN_NIX_SPAM

##{ T_REPLYTO_EMPTY

header      T_REPLYTO_EMPTY          Reply-To =~ /<>/
describe    T_REPLYTO_EMPTY          Reply-To undeliverable
##} T_REPLYTO_EMPTY

##{ T_RPT_SPAM_HDR

header          T_RPT_SPAM_HDR            Report-SPAM =~ /./
##} T_RPT_SPAM_HDR

##{ T_RP_8BIT

header   T_RP_8BIT	Return-Path:raw =~ /[^\000-\177]/
describe T_RP_8BIT	Return-Path contains 8-bit characters with high bit on
##} T_RP_8BIT

##{ T_RP_LASTNAME

header   T_RP_LASTNAME	Return-Path =~ /LAST_NAME/m
describe T_RP_LASTNAME	Return-Path says LAST_NAME literally
##} T_RP_LASTNAME

##{ T_RP_MINUS

header   T_RP_MINUS	Return-Path:addr =~ /^-/m
describe T_RP_MINUS	Return-Path address starts with a minus
##} T_RP_MINUS

##{ T_RP_UNDERLINE

header   T_RP_UNDERLINE	Return-Path:addr =~ /^_/m
describe T_RP_UNDERLINE	Return-Path address starts with an underline
##} T_RP_UNDERLINE

##{ T_RUNON_SHY

rawbody        T_RUNON_SHY          /(?:\&shy;){3}/i
describe       T_RUNON_SHY          Repeating soft hyphens
tflags         T_RUNON_SHY          nopublish
##} T_RUNON_SHY

##{ T_S25R

meta	 T_S25R	!(__NOT_SPOOFED||__GREYLISTING) && (__MAY_BE_FORGED||__S25R_1||__S25R_3||__S25R_5||__S25R_2||__S25R_6||__S25R_4)
describe T_S25R	Selective SMTP Rejection: Relay has dynamic rDNS
tflags	 T_S25R	nopublish
##} T_S25R

##{ T_S25R_1

describe T_S25R_1 T_S25R: Bottom of rDNS has num, non-num, num
meta	 T_S25R_1 __S25R_1 && !(__DOS_RELAYED_EXT||__S25R_2||__S25R_3||__S25R_4||__S25R_5||__S25R_6 || __NOT_SPOOFED || __GREYLISTING)
tflags	 T_S25R_1 nopublish
##} T_S25R_1

##{ T_S25R_2

describe T_S25R_2 T_S25R: Bottom of rDNS has 5+ digits in a row
meta	 T_S25R_2 __S25R_2 && !(__S25R_1||__S25R_3||__S25R_4||__S25R_5||__S25R_6 || __NOT_SPOOFED || __GREYLISTING)
tflags	 T_S25R_2 nopublish
##} T_S25R_2

##{ T_S25R_3

describe T_S25R_3 T_S25R: A low-level of rDNS starts w/ a number
meta	 T_S25R_3 __S25R_3 && !(__S25R_1||__S25R_2||__S25R_4||__S25R_5||__S25R_6 || __NOT_SPOOFED || __GREYLISTING)
tflags	 T_S25R_3 nopublish
##} T_S25R_3

##{ T_S25R_4

describe T_S25R_4 T_S25R: Bottom of rDNS ends w/ num, next lvl has num-num
meta	 T_S25R_4 __S25R_4 && !(__S25R_1||__S25R_2||__S25R_3||__S25R_5||__S25R_6 || __NOT_SPOOFED || __GREYLISTING)
##} T_S25R_4

##{ T_S25R_5

describe T_S25R_5 T_S25R: rDNS has 5+ layers, bottom 2 end in numbers
meta	 T_S25R_5 __S25R_5 && !(__S25R_1||__S25R_2||__S25R_3||__S25R_4||__S25R_6 || __NOT_SPOOFED || __GREYLISTING)
tflags	 T_S25R_5 nopublish
##} T_S25R_5

##{ T_S25R_6

describe T_S25R_6 T_S25R: rDNS looks dynamic or customer-facing
meta	 T_S25R_6 __S25R_6 && !(__S25R_1||__S25R_2||__S25R_3||__S25R_4||__S25R_5 || __NOT_SPOOFED || __GREYLISTING)
##} T_S25R_6

##{ T_SCANNED_EXTERNAL

meta        T_SCANNED_EXTERNAL       __SCANNED && !ALL_TRUSTED && !__XEROXWORKCTR_MUA
describe    T_SCANNED_EXTERNAL       "Scanned Document" email from external source - malware?
#score       T_SCANNED_EXTERNAL       3.00		# limit
##} T_SCANNED_EXTERNAL

##{ T_SCRIPT_GIBBERISH

meta           T_SCRIPT_GIBBERISH         __SCRIPT_GIBBERISH && !__SCRIPT_TAG_IN_BODY && !__TAG_EXISTS_META
describe       T_SCRIPT_GIBBERISH         Nonsense in HTML <SCRIPT> tag
##} T_SCRIPT_GIBBERISH

##{ T_SERGIO_SUBJECT_PORN002

header   T_SERGIO_SUBJECT_PORN002     Subject =~ /p[^a-zA-Z0-9]{0,3}[i1l][^a-zA-Z0-9]{0,3}c[^a-zA-Z0-9]{0,3}t[^a-zA-Z0-9]{0,3}u[^a-zA-Z0-9]{1,3}r[^a-zA-Z0-9]{0,3}e[^a-zA-Z0-9]{0,3}s/i
describe T_SERGIO_SUBJECT_PORN002     Pictures garbled subject
##} T_SERGIO_SUBJECT_PORN002

##{ T_SERGIO_SUBJECT_PORN003

header   T_SERGIO_SUBJECT_PORN003     Subject =~ /v[^a-zA-Z0-9]{1,3}[i1l][^a-zA-Z0-9]{0,3}d[^a-zA-Z0-9]{0,3}e[^a-zA-Z0-9]{0,3}[o0][^a-zA-Z0-9]{0,3}s/i
describe T_SERGIO_SUBJECT_PORN003     Videos garbled subject
##} T_SERGIO_SUBJECT_PORN003

##{ T_SERGIO_SUBJECT_PORN004

header   T_SERGIO_SUBJECT_PORN004     Subject =~ /a[^a-zA-Z0-9]{1,3}d[^a-zA-Z0-9]{1,3}[uv][^a-zA-Z0-9]{1,3}[l1\|][^a-zA-Z0-9]{1,3}t/i
describe T_SERGIO_SUBJECT_PORN004     Adult garbled subject
##} T_SERGIO_SUBJECT_PORN004

##{ T_SERGIO_SUBJECT_PORN005

header   T_SERGIO_SUBJECT_PORN005     Subject =~ /\bp[^a-zA-Z0-9]{0,3}[o0][^a-zA-Z0-9]{1,3}r[^a-zA-Z0-9]{0,3}n/i
describe T_SERGIO_SUBJECT_PORN005     Porn garbled subject
##} T_SERGIO_SUBJECT_PORN005

##{ T_SERGIO_SUBJECT_PORN006

header   T_SERGIO_SUBJECT_PORN006     Subject =~ /b[^a-zA-Z0-9]{0,3}l[^a-zA-Z0-9]{0,3}[o0][^a-zA-Z0-9]{0,3}w[^a-zA-Z0-9]{0,3}j[^a-zA-Z0-9]{0,3}[o0][^a-zA-Z0-9]{0,3}b/i
describe T_SERGIO_SUBJECT_PORN006     B\*\*\* J\*\* garbled subject
##} T_SERGIO_SUBJECT_PORN006

##{ T_SERGIO_SUBJECT_PORN007

header   T_SERGIO_SUBJECT_PORN007     Subject =~ /bf[^a-zA-Z0-9]{0,3}[i1l][^a-zA-Z0-9]{1,3}[i1l][^a-zA-Z0-9]{0,3}m/i
describe T_SERGIO_SUBJECT_PORN007     Film garbled subject
##} T_SERGIO_SUBJECT_PORN007

##{ T_SERGIO_SUBJECT_PORN008

header   T_SERGIO_SUBJECT_PORN008     Subject =~ /m[^a-zA-Z0-9]{0,3}a[^a-zA-Z0-9]{0,3}t[^a-zA-Z0-9]{0,3}[uv][^a-zA-Z0-9]{0,3}r[^a-zA-Z0-9]{0,3}e/i
describe T_SERGIO_SUBJECT_PORN008     Mature garbled subject
##} T_SERGIO_SUBJECT_PORN008

##{ T_SERGIO_SUBJECT_PORN009

header   T_SERGIO_SUBJECT_PORN009     Subject =~ /u[^a-zA-Z0-9]{0,3}n[^a-zA-Z0-9]{0,3}d[^a-zA-Z0-9]{0,3}r[^a-zA-Z0-9]{0,3}e[^a-zA-Z0-9]{0,3}s[^a-zA-Z0-9]{0,3}s/i
describe T_SERGIO_SUBJECT_PORN009     Undress garbled subject
##} T_SERGIO_SUBJECT_PORN009

##{ T_SERGIO_SUBJECT_PORN010

header   T_SERGIO_SUBJECT_PORN010     Subject =~ /m[^a-zA-Z0-9]{1,3}o[^a-zA-Z0-9]{1,3}v[^a-zA-Z0-9]{1,3}i[^a-zA-Z0-9]{1,3}e/i
describe T_SERGIO_SUBJECT_PORN010     Movies garbled subject
##} T_SERGIO_SUBJECT_PORN010

##{ T_SERGIO_SUBJECT_PORN011

header   T_SERGIO_SUBJECT_PORN011     Subject =~ /s[^a-zA-Z0-9]{1,4}e[^a-zA-Z0-9]{1,4}x/i
describe T_SERGIO_SUBJECT_PORN011     Sex garbled subject
##} T_SERGIO_SUBJECT_PORN011

##{ T_SERGIO_SUBJECT_PORN012

header   T_SERGIO_SUBJECT_PORN012     Subject =~ /s[^a-zA-Z0-9]{1,4}c[^a-zA-Z0-9]{0,4}h[^a-zA-Z0-9]{0,4}[o0][^a-zA-Z0-9]{0,4}[o0][^a-zA-Z0-9]{0,4}[1l|]/i
describe T_SERGIO_SUBJECT_PORN012     School garbled subject
##} T_SERGIO_SUBJECT_PORN012

##{ T_SERGIO_SUBJECT_PORN013

header   T_SERGIO_SUBJECT_PORN013     Subject =~ /g[^a-zA-Z0-9]{1,3}[i1l][^a-zA-Z0-9]{1,3}r[^a-zA-Z0-9]{1,3}[1l\|]/i
describe T_SERGIO_SUBJECT_PORN013     Girls garbled subject
##} T_SERGIO_SUBJECT_PORN013

##{ T_SERGIO_SUBJECT_PORN014

header   T_SERGIO_SUBJECT_PORN014     Subject =~ /f[^a-zA-Z0-9]{0,3}[uv][^a-zA-Z0-9]{0,3}c[^a-zA-Z0-9]{0,3}k/i
describe T_SERGIO_SUBJECT_PORN014     F\*\*\* garbled subject
##} T_SERGIO_SUBJECT_PORN014

##{ T_SERGIO_SUBJECT_PORN015

header   T_SERGIO_SUBJECT_PORN015     Subject =~ /l[^a-zA-Z0-9]{0,3}e[^a-zA-Z0-9]{0,3}s[^a-zA-Z0-9]{0,3}b[^a-zA-Z0-9]{0,3}[i1l][^a-zA-Z0-9]{0,3}a[^a-zA-Z0-9]{0,3}n/i
describe T_SERGIO_SUBJECT_PORN015     Lesbian garbled subject
##} T_SERGIO_SUBJECT_PORN015

##{ T_SERGIO_SUBJECT_VIAGRA01

header   T_SERGIO_SUBJECT_VIAGRA01   Subject =~ /v[^a-zA-Z0-9]{0,3}[i1l][^a-zA-Z0-9]{0,3}a[^a-zA-Z0-9 ]{0,3}g[^a-zA-Z0-9]{0,3}r[^a-zA-Z0-9]{0,3}a/i
describe T_SERGIO_SUBJECT_VIAGRA01   Viagra garbled subject
##} T_SERGIO_SUBJECT_VIAGRA01

##{ T_SHORTENED_URL_HREF

rawbody	 T_SHORTENED_URL_HREF	/<[^>]{1,99}\shref=\W?http:\/\/(?:bit\.ly|tinyurl\.com|ow\.ly|is\.gd|tumblr\.com|formspring\.me|ff\.im|youtu\.be|tl\.gd|plurk\.com|migre\.me|j\.mp|cli\.gs|goo\.gl|yfrog\.com|lnk\.ms|su\.pr|fb\.me|alturl\.com|wp\.me|ping\.fm|chatter\.com|post\.ly|twurl\.nl|tiny\.cc|4sq\.com|ustre\.am|short\.to|u\.nu|flic\.kr|budurl\.com|digg\.com|twitvid\.com|gowal\.la|om\.ly|justin\.tv|icio\.us|p\.gs|loopt\.us|tcrn\.ch|xrl\.us|wpo\.st|bkite\.com)\/[^\/]{3}/
#score	T_SHORTENED_URL_HREF	1.0
##} T_SHORTENED_URL_HREF

##{ T_SHORTENED_URL_SRC

rawbody	 T_SHORTENED_URL_SRC	/<[^>]{1,99}\ssrc=\W?http:\/\/(?:bit\.ly|tinyurl\.com|ow\.ly|is\.gd|tumblr\.com|formspring\.me|ff\.im|youtu\.be|tl\.gd|plurk\.com|migre\.me|j\.mp|cli\.gs|goo\.gl|yfrog\.com|lnk\.ms|su\.pr|fb\.me|alturl\.com|wp\.me|ping\.fm|chatter\.com|post\.ly|twurl\.nl|tiny\.cc|4sq\.com|ustre\.am|short\.to|u\.nu|flic\.kr|budurl\.com|digg\.com|twitvid\.com|gowal\.la|om\.ly|justin\.tv|icio\.us|p\.gs|loopt\.us|tcrn\.ch|xrl\.us|wpo\.st|bkite\.com)\/[^\/]{3}/
##} T_SHORTENED_URL_SRC

##{ T_SHORT_URL

meta	 T_SHORT_URL	__SHORT_URL && !__URL_SHORTENER && !ALL_TRUSTED
describe T_SHORT_URL	Has a short URL without a shortening service
##} T_SHORT_URL

##{ T_SINGLE_HEADER_1K

meta     T_SINGLE_HEADER_1K	__SINGLE_HEADER_1K && !__VIA_ML && !__THREADED
describe T_SINGLE_HEADER_1K	A single header contains 1K-2K characters
##} T_SINGLE_HEADER_1K

##{ T_SINGLE_HEADER_2K

header   T_SINGLE_HEADER_2K	ALL:raw =~ /(?-xim:(?=(?:^|\n)[^\s\n]+:(?:.(?!\n\S)){2048,3071}.(?:\n\S|$)))/s
describe T_SINGLE_HEADER_2K	A single header contains 2K-3K characters
##} T_SINGLE_HEADER_2K

##{ T_SINGLE_HEADER_3K

header   T_SINGLE_HEADER_3K	ALL:raw =~ /(?-xim:(?=(?:^|\n)[^\s\n]+:(?:.(?!\n\S)){3072,4095}.(?:\n\S|$)))/s
describe T_SINGLE_HEADER_3K	A single header contains 3K-4K characters
##} T_SINGLE_HEADER_3K

##{ T_SINGLE_HEADER_4K

header   T_SINGLE_HEADER_4K	ALL:raw =~ /(?-xim:(?=(?:^|\n)[^\s\n]+:(?:.(?!\n\S)){4096,5119}.(?:\n\S|$)))/s
describe T_SINGLE_HEADER_4K	A single header contains 4K-5K characters
##} T_SINGLE_HEADER_4K

##{ T_SINGLE_HEADER_5K

header   T_SINGLE_HEADER_5K	ALL:raw =~ /(?-xim:(?=(?:^|\n)[^\s\n]+:(?:.(?!\n\S)){5120}))/s
describe T_SINGLE_HEADER_5K	A single header contains 5K+ characters
##} T_SINGLE_HEADER_5K

##{ T_SPAMMY_MIME_BDRY_01

header         T_SPAMMY_MIME_BDRY_01  Content-Type =~ /boundary="\@\@BOUNDARY"/
describe       T_SPAMMY_MIME_BDRY_01  Spammy MIME boundary string
##} T_SPAMMY_MIME_BDRY_01

##{ T_SPOOFED_FREEMAIL

meta	 T_SPOOFED_FREEMAIL	!__NOT_SPOOFED && FREEMAIL_FROM
##} T_SPOOFED_FREEMAIL

##{ T_SPOOFED_URL

meta	 T_SPOOFED_URL	__SPOOFED_URL && !(__VIA_ML || __SENDER_BOT || __YAHOO_BULK || __UNSUB_LINK || __THREADED || __URL_SHORTENER)
describe T_SPOOFED_URL	Has a link whose text is a different URL
##} T_SPOOFED_URL

##{ T_SPOOFED_URL_HOST

meta	 T_SPOOFED_URL_HOST	__SPOOFED_URL_HOST && !(__VIA_ML || __SENDER_BOT || __YAHOO_BULK || __UNSUB_LINK || __THREADED || __URL_SHORTENER)
describe T_SPOOFED_URL_HOST	Has a link whose text is URL with a different host
##} T_SPOOFED_URL_HOST

##{ T_STOX_BOUND_090909_B

header T_STOX_BOUND_090909_B Content-Type:raw =~ /;\n boundary=\"------------0[0-9]0[0-9]0[0-9]0[0-9]0[0-9]0[0-9]0[0-9]0[0-9]0[0-9]0[0-9]0[0-9]0[0-9]\"$/s
##} T_STOX_BOUND_090909_B

##{ T_STOX_META_5

meta T_STOX_META_5 (T_STOX_BOUND_090909_B && EMPTY_MESSAGE)
##} T_STOX_META_5

##{ T_STOX_UA

header T_STOX_UA  User-Agent =~ /^Thunderbird 1.5.0.12 \(Windows\/20070509\)/
##} T_STOX_UA

##{ T_STUDDLYCAPS

header		T_STUDDLYCAPS	Subject =~ /(?:[A-Z][a-z]+){3}/
describe	T_STUDDLYCAPS	ContainsThreeWordsLikeThis
##} T_STUDDLYCAPS

##{ T_SUBJ_ALL_CAPS2

meta	 T_SUBJ_ALL_CAPS2	SUBJ_ALL_CAPS && __SUBJ_4LOWER && __SUBJ_2UPPER && !__SUBJ_SHORT
##} T_SUBJ_ALL_CAPS2

##{ T_SUBJ_ALL_CAPS3

meta	 T_SUBJ_ALL_CAPS3	SUBJ_ALL_CAPS && __SUBJ_4LOWER && __SUBJ_2UPPER && !(__SUBJ_SHORT||__SUBJ_IMPORTANT)
##} T_SUBJ_ALL_CAPS3

##{ T_SUBJ_ATTENTION

meta        T_SUBJ_ATTENTION       __SUBJ_ATTENTION && !ALL_TRUSTED
describe    T_SUBJ_ATTENTION       ATTENTION in Subject
#score       T_SUBJ_ATTENTION       0.500	# limit
##} T_SUBJ_ATTENTION

##{ T_SUBJ_LACKS_WORDS

meta	 T_SUBJ_LACKS_WORDS	__SUBJ_NOT_SHORT && !__SUBJ_HAS_WORDS && !__SUBJECT_ENCODED_B64
describe T_SUBJ_LACKS_WORDS	Subject is not short yet lacks words
##} T_SUBJ_LACKS_WORDS

##{ T_SUBJ_OBFU_PUNCT_FEW

meta        T_SUBJ_OBFU_PUNCT_FEW    __SUBJ_OBFU_PUNCT > 1 && !__SUBJECT_ENCODED_B64 && !__VIA_ML && !__THREADED && !__RP_MATCHES_RCVD && !__DKIM_EXISTS && !NO_RELAYS && !__X_CRON_ENV && !__MSOE_MID_WRONG_CASE && !__HS_SUBJ_RE_FW_rulesrc_sandbox_jm_20_basic_cf && !__HAS_THREAD_INDEX && !__REPLYTO_EXISTS && !__RCD_RDNS_MAIL_MESSY
describe    T_SUBJ_OBFU_PUNCT_FEW    Possible punctuation-obfuscated Subject: header
#score       T_SUBJ_OBFU_PUNCT_FEW    0.750
##} T_SUBJ_OBFU_PUNCT_FEW

##{ T_SUBJ_OBFU_PUNCT_MANY

meta        T_SUBJ_OBFU_PUNCT_MANY   __SUBJ_OBFU_PUNCT > 2 && !__SUBJECT_ENCODED_B64 && !__VIA_ML && !__THREADED && !__RP_MATCHES_RCVD && !__DKIM_EXISTS && !NO_RELAYS && !__X_CRON_ENV && !__MSOE_MID_WRONG_CASE && !__HS_SUBJ_RE_FW_rulesrc_sandbox_jm_20_basic_cf && !__HAS_THREAD_INDEX && !__REPLYTO_EXISTS && !__RCD_RDNS_MAIL_MESSY
describe    T_SUBJ_OBFU_PUNCT_MANY   Punctuation-obfuscated Subject: header
#score       T_SUBJ_OBFU_PUNCT_MANY   1.750
##} T_SUBJ_OBFU_PUNCT_MANY

##{ T_SUBJ_ODD_CASE

header      T_SUBJ_ODD_CASE      ALL =~ /\n(?!(?:Subject:|SUBJECT:|subject:))(?i:subject:)/sm
describe    T_SUBJ_ODD_CASE      Oddly mixed-case Subject: header
##} T_SUBJ_ODD_CASE

##{ T_SUBJ_RE_CLNCLN

header         T_SUBJ_RE_CLNCLN      Subject =~ /^\s*RE::/
describe       T_SUBJ_RE_CLNCLN      Subject RE::
##} T_SUBJ_RE_CLNCLN

##{ T_TEMPLATE_203_RCVD

header T_TEMPLATE_203_RCVD    Received =~ /from 192.168.0.\d+ \(203-219-/
##} T_TEMPLATE_203_RCVD

##{ T_TEST_REPLY_B

meta     T_TEST_REPLY_B		(__SUBJ_RE && !__MISSING_REF && __INR_AND_NO_REF)
tflags    T_TEST_REPLY_B		nopublish
##} T_TEST_REPLY_B

##{ T_TEST_REPLY_C

meta     T_TEST_REPLY_C		(__SUBJ_RE && !__MISSING_REPLY && __NO_INR_YES_REF)
##} T_TEST_REPLY_C

##{ T_THREAD_INDEX_BAD

meta   T_THREAD_INDEX_BAD  __HAS_THREAD_INDEX && !__THREAD_INDEX_GOOD
##} T_THREAD_INDEX_BAD

##{ T_THREAD_INDEX_HEX

header T_THREAD_INDEX_HEX  Thread-Index =~ /^[a-z0-9]{30}/
##} T_THREAD_INDEX_HEX

##{ T_TINY_FLOAT

rawbody        T_TINY_FLOAT         /\bstyle\s*=\s*"[^"]{0,40}?(?:(?:FONT-SIZE\s*:\s+\dpx|FLOAT\s*:\s+(?:right|left))(?:;\s+)?(?:(?!(?:FONT-SIZE|FLOAT))\w+:\s+\w+;?\s*)*){2}/i
describe       T_TINY_FLOAT         Has small-font floating HTML - text obfuscation?
##} T_TINY_FLOAT

##{ T_TO_EQ_FM_DIRECT_MX

meta           T_TO_EQ_FM_DIRECT_MX   __TO_EQ_FM_DIRECT_MX && !__THREAD_INDEX_GOOD && !__IS_EXCH
describe       T_TO_EQ_FM_DIRECT_MX   To == From and direct-to-MX
##} T_TO_EQ_FM_DIRECT_MX

##{ T_TO_EQ_FM_DOM_HTML_IMG

meta           T_TO_EQ_FM_DOM_HTML_IMG    __TO_EQ_FM_DOM_HTML_IMG && !__NOT_SPOOFED && !__CTYPE_MULTIPART_ALT && !__IS_EXCH && !__UNSUB_LINK && !__COMMENT_EXISTS && !__FM_TO_ALL_NUMS && !__DKIM_EXISTS && !__HAS_THREAD_INDEX && !__MSGID_JAVAMAIL && !__RP_MATCHES_RCVD 
describe       T_TO_EQ_FM_DOM_HTML_IMG    To domain == From domain and HTML image link
##} T_TO_EQ_FM_DOM_HTML_IMG

##{ T_TO_EQ_FM_DOM_HTML_ONLY

meta           T_TO_EQ_FM_DOM_HTML_ONLY   __TO_EQ_FM_DOM_HTML_ONLY && !__NOT_SPOOFED && !__CTYPE_MULTIPART_ALT && !HTML_MIME_NO_HTML_TAG && !__IS_EXCH && !__MSGID_BEFORE_RECEIVED && !__FM_TO_ALL_NUMS && !__FROM_LOWER && !__HAS_IN_REPLY_TO && !__BUGGED_IMG && !__FROM_ENCODED_QP && !__MSGID_OK_HEX 
describe       T_TO_EQ_FM_DOM_HTML_ONLY   To domain == From domain and HTML only
##} T_TO_EQ_FM_DOM_HTML_ONLY

##{ T_TO_EQ_FM_HTML_DIRECT

meta           T_TO_EQ_FM_HTML_DIRECT  __TO_EQ_FM_HTML_DIRECT && !__HUSH_HUSH
describe       T_TO_EQ_FM_HTML_DIRECT  To == From and HTML only, direct-to-MX
##} T_TO_EQ_FM_HTML_DIRECT

##{ T_TO_EQ_FM_HTML_ONLY

meta           T_TO_EQ_FM_HTML_ONLY   __TO_EQ_FM_HTML_ONLY && !ALL_TRUSTED && !__RCD_RDNS_MAIL_MESSY && !__RCD_RDNS_SMTP_MESSY && !__NOT_SPOOFED && !__DKIM_EXISTS && !__ANY_IMAGE_ATTACH && !__FROM_LOWER && !__TAG_EXISTS_CENTER
describe       T_TO_EQ_FM_HTML_ONLY   To == From and HTML only
##} T_TO_EQ_FM_HTML_ONLY

##{ T_TO_IN_SUBJ

meta           T_TO_IN_SUBJ           __SUBJ_HAS_TO_1 && !__VIA_ML && !MISSING_MIMEOLE && !__THREAD_INDEX_GOOD
describe       T_TO_IN_SUBJ           To address is in Subject
##} T_TO_IN_SUBJ

##{ T_TO_JOHNZY

header      T_TO_JOHNZY              TO =~ /johnzy_the_king\@hotmail\.com/i
describe    T_TO_JOHNZY              To a spammy recipent	
##} T_TO_JOHNZY

##{ T_TO_NO_BRKTS_DIRECT

meta       T_TO_NO_BRKTS_DIRECT       __TO_NO_BRKTS_DIRECT && !__IS_EXCH && !__THREAD_INDEX_GOOD && !__COMMENT_EXISTS && !__RCD_RDNS_MTA_MESSY && !__TVD_SPACE_RATIO && !__THREADED && !__FB_DO_NOT_REPLY && !__VBOUNCE_MAILSWEEP3 && !__DEAL && !__RCD_RDNS_MAIL_MESSY && !__UNSUB_LINK && !__RP_MATCHES_RCVD && !__DKIM_EXISTS && !__TAG_EXISTS_CENTER
describe   T_TO_NO_BRKTS_DIRECT       To: misformatted and direct-to-MX
##} T_TO_NO_BRKTS_DIRECT

##{ T_TO_NO_BRKTS_DYNIP

meta       T_TO_NO_BRKTS_DYNIP       __TO_NO_BRKTS_DYNIP && !__NAME_IS_EMAIL && !__MSGID_OK_HEX && !__UNSUB_LINK && !__THREADED && !__RCD_RDNS_MX_MESSY && !__COMMENT_EXISTS && !__MUA_TBIRD && !__CD && !__ML1 && !__RP_MATCHES_RCVD
describe   T_TO_NO_BRKTS_DYNIP       To: misformatted and dynamic rDNS
##} T_TO_NO_BRKTS_DYNIP

##{ T_TO_NO_BRKTS_HTML_IMG

meta       T_TO_NO_BRKTS_HTML_IMG    __TO_NO_BRKTS_HTML_IMG && !__FM_TO_ALL_NUMS
#score      T_TO_NO_BRKTS_HTML_IMG    0.20
describe   T_TO_NO_BRKTS_HTML_IMG    To: misformatted and HTML and one image
##} T_TO_NO_BRKTS_HTML_IMG

##{ T_TO_NO_BRKTS_HTML_ONLY

meta       T_TO_NO_BRKTS_HTML_ONLY   __TO_NO_BRKTS_HTML_ONLY && !__MIME_QP && !__MSGID_JAVAMAIL && !__CTYPE_CHARSET_QUOTED && !__SUBJECT_ENCODED_B64 && !__VIA_ML && !__MSGID_BEFORE_RECEIVED && !__MIME_BASE64 && !__RCD_RDNS_MAIL_MESSY && !__COMMENT_EXISTS && !LOTS_OF_MONEY && !__TAG_EXISTS_CENTER && !__UPPERCASE_URI && !__UNSUB_LINK && !__RCD_RDNS_MX_MESSY && !__DKIM_EXISTS && !__BUGGED_IMG && !__FM_TO_ALL_NUMS && !__URI_12LTRDOM && !__RDNS_NO_SUBDOM && !__HDRS_LCASE
describe   T_TO_NO_BRKTS_HTML_ONLY   To: misformatted and HTML only
##} T_TO_NO_BRKTS_HTML_ONLY

##{ T_TO_NO_BRKTS_NORDNS

meta       T_TO_NO_BRKTS_NORDNS      __TO_NO_BRKTS_NORDNS && !__MANY_RECIPS && !__FROM_RUNON && !__VIA_ML && !__TO___LOWER && !ALL_TRUSTED && !__COMMENT_EXISTS && !__DOS_HAS_LIST_UNSUB && !__OE_MSGID_1 && !__MSGID_JAVAMAIL && !__CTYPE_MULTIPART_MIXED && !__UNSUB_LINK && !__JM_REACTOR_DATE && !__TAG_EXISTS_CENTER && !__HAS_UA && !__TO_EQ_FROM_DOM && !__TAG_EXISTS_STYLE 
#score      T_TO_NO_BRKTS_NORDNS      2.75	# limit
describe   T_TO_NO_BRKTS_NORDNS      To: misformatted and no rDNS
##} T_TO_NO_BRKTS_NORDNS

##{ T_TO_NO_BRKTS_NORDNS_HTML

meta       T_TO_NO_BRKTS_NORDNS_HTML      __TO_NO_BRKTS_NORDNS_HTML && !ALL_TRUSTED && !__MSGID_JAVAMAIL && !__MSGID_BEFORE_RECEIVED && !__VIA_ML && !__UA_MUTT && !__COMMENT_EXISTS && !__HTML_LENGTH_384 && !__MIME_BASE64 && !__UPPERCASE_URI && !__TO___LOWER && !__BUGGED_IMG && !__TAG_EXISTS_CENTER
describe   T_TO_NO_BRKTS_NORDNS_HTML      To: misformatted and no rDNS and HTML only
##} T_TO_NO_BRKTS_NORDNS_HTML

##{ T_TO_NO_BRKTS_NOTLIST

meta       T_TO_NO_BRKTS_NOTLIST      __TO_NO_BRKTS_NOTLIST && !__UNUSABLE_MSGID && !__THREADED && !__SUBJ_RE && !__RCD_RDNS_MAIL_MESSY && !__MANY_RECIPS && !__HAS_MIMEOLE && !__THREAD_INDEX_GOOD && !__IMS_MSGID && !__RCD_RDNS_MTA_MESSY && !__BOUNCE_RPATH_NULL && !__BOUNCE_STAT_FAIL && !__BOUNCE_CTYPE && !ALL_TRUSTED && !__FB_DO_NOT_REPLY && !__RPATH_12LTRDOM && !__MIME_BASE64 && !__UPPERCASE_URI && !__TO___LOWER && !__BUGGED_IMG && !__JM_REACTOR_DATE && !__RP_MATCHES_RCVD && !__X_CRON_ENV && !NO_RELAYS
describe   T_TO_NO_BRKTS_NOTLIST      To: misformatted and not a mailing list
##} T_TO_NO_BRKTS_NOTLIST

##{ T_TO_NO_BRKTS_PCNT

meta       T_TO_NO_BRKTS_PCNT         __TO_NO_BRKTS_PCNT && !__SUBJECT_ENCODED_B64 && !__DOS_HAS_LIST_UNSUB && !__VIA_ML && !__ISO_2022_JP_DELIM && !__IMS_MSGID && !__THREAD_INDEX_GOOD && !__RCD_RDNS_MX_MESSY && !__UNSUB_LINK && !__LONGLINE && !URI_HEX && !__RP_MATCHES_RCVD && !__MAIL_LINK && !__BUGGED_IMG
describe   T_TO_NO_BRKTS_PCNT         To: misformatted + percentage
##} T_TO_NO_BRKTS_PCNT

##{ T_TO_ONE_CHAR

header      T_TO_ONE_CHAR            To =~ /^\s*"<"\s*</
describe    T_TO_ONE_CHAR            Bogus TO name
##} T_TO_ONE_CHAR

##{ T_TO_SEM_SEM

header         T_TO_SEM_SEM          To =~ /;;/
describe       T_TO_SEM_SEM          To has ";;"
tflags         T_TO_SEM_SEM          nopublish
##} T_TO_SEM_SEM

##{ T_TR_FILLER_TEXT

body T_TR_FILLER_TEXT		/\b(?:[A-Z][a-z]{0,16}\b(?:\s[a-z]{1,16}\b){4,6}\.?\s{0,2}){18}/
describe T_TR_FILLER_TEXT 	18 sentences of capitalized word, 4-6 words, period
#score T_TR_FILLER_TEXT 0.2	# I (khopesh) am worried about this one getting out of hand
##} T_TR_FILLER_TEXT

##{ T_TR_JS_FROMCHARCODE

rawbody  T_TR_JS_FROMCHARCODE	/[+=(]\s{0,9}String\.fromCharCode\b/
describe T_TR_JS_FROMCHARCODE	JavaScript: function String.fromCharCode
##} T_TR_JS_FROMCHARCODE

##{ T_TR_JS_REDIRECTION_0

rawbody T_TR_JS_REDIRECTION_0	/<[Ss][Cc][Rr][Ii][Pp][Tt]\s*(type="[^"]+"\s*)?>\s*(window|self|(var\s+)?([a-z]+)\s*=\s*window\s*;?\s*\4)?\.?(location|\[['"]location['"]\])(\.href)?\s*[=(]/
describe T_TR_JS_REDIRECTION_0	Script: Current window location is redirected (unoptimized)
##} T_TR_JS_REDIRECTION_0

##{ T_TR_JS_REDIRECTION_1

rawbody T_TR_JS_REDIRECTION_1	/<script\s(?-i)[^>]{0,75}>(?:\s{0,9}.{0,1024};)?\s{0,9}\b(?:window|self|([a-z]+)\s{0,9}=\s{0,9}(?:window|self)\s{0,9};?\s{0,9}\1)?\.?(?:location|\[['"]location['"]\])(?:\.href)?\s{0,9}[=(]/msi
describe T_TR_JS_REDIRECTION_1	Script: Current window location is redirected
##} T_TR_JS_REDIRECTION_1

##{ T_TR_JS_REDIRECTION_2

rawbody T_TR_JS_REDIRECTION_2	/<script\s(?-i).{1,1024}(?:[.\s]|\[["'])location\b(?:["']\])?\s{0,9}(?:\.href)?\s{0,9}[=(]/msi
describe T_TR_JS_REDIRECTION_2	Script: Something changes location (a redirection)
##} T_TR_JS_REDIRECTION_2

##{ T_TT_OBSCURED_XANAX

meta T_TT_OBSCURED_XANAX          ( __TT_BROKEN_XANAX || __TT_OBSCURED_XANAX ) && ! __TT_XANAX
describe T_TT_OBSCURED_XANAX      Scora: obscured "XANAX" in subject
##} T_TT_OBSCURED_XANAX

##{ T_TVD_APP_LOAN

body T_TVD_APP_LOAN               /approved .{0,20}loan/i
##} T_TVD_APP_LOAN

##{ T_TVD_BODY_END_STAR

body T_TVD_BODY_END_STAR          /(?:[A-Z0-9]+\*[,\s]+){2}/
##} T_TVD_BODY_END_STAR

##{ T_TVD_COMPANY_PICK

body T_TVD_COMPANY_PICK           /company .{2,20}hot pick/i
##} T_TVD_COMPANY_PICK

##{ T_TVD_DEAD_JOB

body T_TVD_DEAD_JOB /\bTired of working a dead end job\s*\?/i
##} T_TVD_DEAD_JOB

##{ T_TVD_DOLLARS_US

body T_TVD_DOLLARS_US /\s\d[\d.,]+US/
##} T_TVD_DOLLARS_US

##{ T_TVD_FINGER_01

meta T_TVD_FINGER_01      __TVD_HAPPY_WITH || __TVD_GOT_UR || __TVD_VISIT_SITE
##} T_TVD_FINGER_01

##{ T_TVD_FW_GRAPHIC_ID3

meta T_TVD_FW_GRAPHIC_ID3 __TVD_OUTLOOK_IMG && __TVD_INT_CID && !__UNUSABLE_MSGID && ! (__OE_MSGID_2 || __IMS_MSGID )
##} T_TVD_FW_GRAPHIC_ID3

##{ T_TVD_FW_GRAPHIC_ID3_2

meta T_TVD_FW_GRAPHIC_ID3_2 __TVD_OUTLOOK_IMG && !__UNUSABLE_MSGID && ! (__OE_MSGID_2 || __IMS_MSGID )
##} T_TVD_FW_GRAPHIC_ID3_2

##{ T_TVD_GET_STOCK

body T_TVD_GET_STOCK              /(?i:OTC).{2,8}(?:[A-Z]\s*){3,5}\b/
##} T_TVD_GET_STOCK

##{ T_TVD_GOOG_LUCKY

uri T_TVD_GOOG_LUCKY /\bgooo?gle\..*&btnI=/i
##} T_TVD_GOOG_LUCKY

##{ T_TVD_HEAD_EDITION

header T_TVD_HEAD_EDITION exists:X-Edition
##} T_TVD_HEAD_EDITION

##{ T_TVD_HEAD_KERNEL

meta T_TVD_HEAD_KERNEL            __HEAD_X_KERNEL && !__USER_AGENT_MUTT
##} T_TVD_HEAD_KERNEL

##{ T_TVD_HEAD_USR

header T_TVD_HEAD_USR             exists:X-Usr
##} T_TVD_HEAD_USR

##{ T_TVD_IP_HEX

uri T_TVD_IP_HEX  m@^https?://(?:\d+\.){0,3}0x[0-9a-f]{2}@i
##} T_TVD_IP_HEX

##{ T_TVD_IP_OCT

uri T_TVD_IP_OCT  m@^https?://(?:(?:0x[0-9a-f]+|\d+)\.){0,3}0+(?:[1-3][0-7]{0,2}|[4-7][0-7]?)(?:\.(?:0x[0-9a-f]+|\d+)){0,3}(?:[:/]|$)@i
##} T_TVD_IP_OCT

##{ T_TVD_IP_SING_HEX

uri T_TVD_IP_SING_HEX     m@^https?://0x[0-9a-f]+(?:[:/]|$)@i
##} T_TVD_IP_SING_HEX

##{ T_TVD_LONG_WORD5

body T_TVD_LONG_WORD5             /^(?:(?:\w+,?\s+)\.)+\s*$/
##} T_TVD_LONG_WORD5

##{ T_TVD_NOT_SATISFIED

body T_TVD_NOT_SATISFIED          /not satisfied .{1,32}(?:lover|size)/i
##} T_TVD_NOT_SATISFIED

##{ T_TVD_PCT_OFF

header T_TVD_PCT_OFF Subject =~ /(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\S* \d+% OFF/
##} T_TVD_PCT_OFF

##{ T_TVD_PCT_OFF2

header T_TVD_PCT_OFF2 Subject =~ /% OFF/
##} T_TVD_PCT_OFF2

##{ T_TVD_PCT_OFF3

header T_TVD_PCT_OFF3 Subject =~ /^(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\S* \d+% OFF/
##} T_TVD_PCT_OFF3

##{ T_TVD_PDF_FINGER01

meta T_TVD_PDF_FINGER01 __TVD_MIME_CT_MM && __TVD_MIME_ATT_TP && __TVD_MIME_ATT && !__TVD_BODY
describe T_TVD_PDF_FINGER01 Mail matches standard pdf spam fingerprint
##} T_TVD_PDF_FINGER01

##{ T_TVD_PDF_FINGER01_JO

meta T_TVD_PDF_FINGER01_JO  (__TVD_MIME_CT_MM && __TVD_MIME_ATT && !__TVD_BODY)
##} T_TVD_PDF_FINGER01_JO

##{ T_TVD_PH_1

body T_TVD_PH_1	/Dear valued .{1,40}(?:member|customer)/i
##} T_TVD_PH_1

##{ T_TVD_PH_7

body T_TVD_PH_7	/\baccount .{0,20}suspen/i
##} T_TVD_PH_7

##{ T_TVD_PH_BODY_ACCOUNTS_POST

meta T_TVD_PH_BODY_ACCOUNTS_POST		__TVD_PH_BODY_ACCOUNTS_POST
##} T_TVD_PH_BODY_ACCOUNTS_POST

##{ T_TVD_PH_BODY_META

meta T_TVD_PH_BODY_META		__TVD_PH_BODY_META
##} T_TVD_PH_BODY_META

##{ T_TVD_PH_BODY_META_ALL

meta T_TVD_PH_BODY_META_ALL	__TVD_PH_BODY_META || __TVD_PH_BODY_ACCOUNTS_PRE || __TVD_PH_BODY_ACCOUNTS_POST
##} T_TVD_PH_BODY_META_ALL

##{ T_TVD_PH_FR5

meta T_TVD_PH_FR5 !__ENV_AND_HDR_FROM_MATCH && __PH_TVD_FROM2
##} T_TVD_PH_FR5

##{ T_TVD_PH_SUBJ_META

meta T_TVD_PH_SUBJ_META		__TVD_PH_SUBJ_META
##} T_TVD_PH_SUBJ_META

##{ T_TVD_RATWARE_MSGID_01

header T_TVD_RATWARE_MSGID_01     Message-ID =~ /<[a-z0-9]{2}-/
##} T_TVD_RATWARE_MSGID_01

##{ T_TVD_SINGLE_SPAN_DIV

rawbody T_TVD_SINGLE_SPAN_DIV />\s+[a-zA-Z]\s+<\/(?:span|div)\b/i
##} T_TVD_SINGLE_SPAN_DIV

##{ T_TVD_SPACED_SUBJECT_WORD5

header T_TVD_SPACED_SUBJECT_WORD5 Subject =~ /^(?:(?:Re|Fw)[^:]{0,5}: )?[A-Z]+\s*[a-z]+\s*[A-Z]+$/
##} T_TVD_SPACED_SUBJECT_WORD5

##{ T_TVD_SPACED_WORDS

body T_TVD_SPACED_WORDS   /^(?:[A-Z]\s)+[a-z]\s(?:[A-Z]\s)+$/
##} T_TVD_SPACED_WORDS

##{ T_TVD_SPACE_RATIO_MINFP

meta        T_TVD_SPACE_RATIO_MINFP  __TVD_SPACE_RATIO && !__OBFUSCATING_COMMENT_B && !WEIRD_QUOTING && !__NOT_SPOOFED && !__BUGGED_IMG && !__ML1 && !__DOS_HAS_LIST_UNSUB && !__RP_MATCHES_RCVD && !__MUA_TBIRD && !__HS_SUBJ_RE_FW_rulesrc_sandbox_jm_20_basic_cf && !__RCD_RDNS_MAIL_MESSY && !__ISO_2022_JP_DELIM && !__MIME_QP && !__NOT_A_PERSON && __HAS_THREAD_INDEX && !__MIME_ATTACHMENT && !__CTYPE_MULTIPART_MIXED && !__THREADED && !__NAKED_TO
#score       T_TVD_SPACE_RATIO_MINFP  3.5		# limit
##} T_TVD_SPACE_RATIO_MINFP

##{ T_TVD_SUBJ_APPR_LOAN

header T_TVD_SUBJ_APPR_LOAN       Subject =~ /approved? .{0,20}loan/i
##} T_TVD_SUBJ_APPR_LOAN

##{ T_TVD_SUBJ_END_STAR

header T_TVD_SUBJ_END_STAR        Subject =~ /(?:[A-Z0-9]+\*[,\s]+){2}/
##} T_TVD_SUBJ_END_STAR

##{ T_TVD_SUBJ_FINGER_04

header T_TVD_SUBJ_FINGER_04       Subject =~ /^(?:(?:Re|Fw)[^:]{0,5}: )?[A-Z]+[\/a-zA-Z]+[A-Z]+\s+(?i:news)?\s*$/
##} T_TVD_SUBJ_FINGER_04

##{ T_TVD_SUBJ_FINGER_05

header T_TVD_SUBJ_FINGER_05          Subject =~ /^(?:[A-Z][a-z]+){2}$/
##} T_TVD_SUBJ_FINGER_05

##{ T_TVD_SUBJ_FINGER_06

header T_TVD_SUBJ_FINGER_06          Subject =~ /^(?:[A-Z][a-z]{3,}){3,}$/
##} T_TVD_SUBJ_FINGER_06

##{ T_TVD_SUBJ_FINGER_07

header T_TVD_SUBJ_FINGER_07          Subject =~ /^(?:[A-Z][a-z]{2,}){3,}$/
##} T_TVD_SUBJ_FINGER_07

##{ T_TVD_SUBJ_NUM_OBFU

header T_TVD_SUBJ_NUM_OBFU Subject =~ /[a-z]{3,}\d+[a-z]{2,}/i
##} T_TVD_SUBJ_NUM_OBFU

##{ T_TVD_SUBJ_NUM_OBFU2

header T_TVD_SUBJ_NUM_OBFU2 Subject =~ /[a-z0-9]{2,}[a-z]\d+[a-z][a-z0-9]/i
##} T_TVD_SUBJ_NUM_OBFU2

##{ T_TVD_SUBJ_NUM_OBFU3

header T_TVD_SUBJ_NUM_OBFU3 Subject =~ /[a-z0-9]{2,}[a-z]\d+[a-z0-9]*[a-z][a-z0-9]/i
##} T_TVD_SUBJ_NUM_OBFU3

##{ T_TVD_SUBJ_NUM_OBFU_MINFP

meta        T_TVD_SUBJ_NUM_OBFU_MINFP   __TVD_SUBJ_NUM_OBFU && !__RP_MATCHES_RCVD && !__RCD_RDNS_MAIL_MESSY && !__VIA_ML && !__ISO_2022_JP_DELIM && !__NOT_SPOOFED && !__X_CRON_ENV && !__NOT_A_PERSON && !__HAS_THREAD_INDEX && !__THREADED && !__NUMBERS_IN_SUBJ && !__URI_MAILTO
##} T_TVD_SUBJ_NUM_OBFU_MINFP

##{ T_TVD_UA_FOSTERING

header T_TVD_UA_FOSTERING         User-Agent =~ /^fostering/i
##} T_TVD_UA_FOSTERING

##{ T_UNKNOWN_ORIGIN

meta	 T_UNKNOWN_ORIGIN	!(__RCVD_VIA_AFRINIC || __RCVD_VIA_APNIC || __RCVD_VIA_ARIN || __RCVD_VIA_LACNIC || __RCVD_VIA_RIPE || __RCVD_VIA_NON_RIR || RCVD_ILLEGAL_IP || __RCVD_VIA_IPV6)
##} T_UNKNOWN_ORIGIN

##{ T_UN_NO_ML

meta     T_UN_NO_ML         __UN && !__VIA_ML && !__UNSUB_LINK && !__COMMENT_EXISTS
describe T_UN_NO_ML         United Nations not via mailing list
tflags   T_UN_NO_ML         nopublish
##} T_UN_NO_ML

##{ T_UPPERCASE_HTTP

uri T_UPPERCASE_HTTP	/^(?:H|hT|htT|httP|httpS)/
describe T_UPPERCASE_HTTP	URI with an uppercase character in the ScHeMe
#score T_UPPERCASE_HTTP 0.1
##} T_UPPERCASE_HTTP

##{ T_UPPERCASE_URI

uri	 T_UPPERCASE_URI	/^[^:A-Z]+[A-Z]/
describe T_UPPERCASE_URI	Link protocol has unexpected mixed case
##} T_UPPERCASE_URI

##{ T_URI_1234

uri             T_URI_1234                m,//1\.2\.3\.4/,
##} T_URI_1234

##{ T_URI_DATA

meta        T_URI_DATA           __URI_DATA && !ALL_TRUSTED
describe    T_URI_DATA           "data:" URI - possible malware or phish
#score       T_URI_DATA           1.0	# limit
##} T_URI_DATA

##{ T_URI_DBL_INDIR

meta        T_URI_DBL_INDIR      __URI_DBL_INDIR && !__URI_TRPL_INDIR
describe    T_URI_DBL_INDIR      A URI with two levels of indirection
##} T_URI_DBL_INDIR

##{ T_URI_DEOBFU_INSTR

meta          T_URI_DEOBFU_INSTR    __URI_DEOBFU_INSTR && !__MSGID_OK_HOST
describe      T_URI_DEOBFU_INSTR    How to deobfuscate this URI
##} T_URI_DEOBFU_INSTR

##{ T_URI_GOOGLE_DOCS

meta        T_URI_GOOGLE_DOCS      __URI_GOOGLE_DOC && !__DKIM_EXISTS && !__TO_EQ_FROM_DOM && !__DOS_REF_TODAY && !__DOS_BODY_FRI && !__DOS_BODY_WED && !__freemail_safe_fwd && !__TO_EQ_FROM_DOM && !__HAS_ERRORS_TO
describe    T_URI_GOOGLE_DOCS      URI for Google Docs, common in phishing
#score       T_URI_GOOGLE_DOCS      1.00	# limit
##} T_URI_GOOGLE_DOCS

##{ T_URI_HIDDEN

uri	 T_URI_HIDDEN	m'.{7}\/\.\.?/?\w'
describe T_URI_HIDDEN	Contains a hidden directory
##} T_URI_HIDDEN

##{ T_URI_HIDDEN_2

uri            T_URI_HIDDEN_2               m;.{8}(?:[/\\]|%(?i:5c|2f))(?!\.\.?[/%\\])\..;
describe       T_URI_HIDDEN_2               URI contains a hidden file or directory
##} T_URI_HIDDEN_2

##{ T_URI_MALWARE_BH

uri         T_URI_MALWARE_BH     /\.\w{2,4}\/[\d\w]{8}\/index\.html/i
describe    T_URI_MALWARE_BH     Possible BlackHole malware links / phishing
#score       T_URI_MALWARE_BH     1.0	# limit
##} T_URI_MALWARE_BH

##{ T_URI_NUMERIC_CCTLD

uri            T_URI_NUMERIC_CCTLD     m;^[a-z]+://(?:\d+\.){2,}[a-z][a-z]/;i
describe       T_URI_NUMERIC_CCTLD     CCTLD URI with multiple numeric subdomains
##} T_URI_NUMERIC_CCTLD

##{ T_URI_OBFU_DOM

meta            T_URI_OBFU_DOM            __URI_OBFU_DOM && !__VIA_ML
describe        T_URI_OBFU_DOM            URI pretending to be different domain
##} T_URI_OBFU_DOM

##{ T_URI_OBFU_PROTO

body          T_URI_OBFU_PROTO    m,h\st\st\sp(?:\ss)\s?:\s?/\s?/,i
describe      T_URI_OBFU_PROTO    URI http protocol with space obfuscation
##} T_URI_OBFU_PROTO

##{ T_URI_OBFU_TLD

meta          T_URI_OBFU_TLD      __URI_OBFU_TLD && !__MSGID_OK_HOST
describe      T_URI_OBFU_TLD      URI top-level domain with space obfuscation
##} T_URI_OBFU_TLD

##{ T_URI_TRPL_INDIR

meta        T_URI_TRPL_INDIR     __URI_TRPL_INDIR
describe    T_URI_TRPL_INDIR     A URI with at least three levels of indirection
##} T_URI_TRPL_INDIR

##{ T_URL_SHORTENER

meta	 T_URL_SHORTENER	__URL_SHORTENER
describe T_URL_SHORTENER	Has a shortened URL (can hide a blacklisted link)
tflags	 T_URL_SHORTENER	nopublish
##} T_URL_SHORTENER

##{ T_WIKI_IMG

uri            T_WIKI_IMG            m,^https?://[^/]+wiki[mp]edia\.org/.+\.(?:png|gif|jpe?g),i
describe       T_WIKI_IMG            Image from wikipedia
##} T_WIKI_IMG

##{ T_XM_EC_MESSENGER

meta        T_XM_EC_MESSENGER        __XM_EC_MESSENGER
describe    T_XM_EC_MESSENGER        eC-Messenger bulk mail service
##} T_XM_EC_MESSENGER

##{ T_XM_PHPMAILER_FORGED

meta        T_XM_PHPMAILER_FORGED    __XM_PHPMAILER_FORGED
describe    T_XM_PHPMAILER_FORGED    Apparently forged header
##} T_XM_PHPMAILER_FORGED

##{ T_XOIP_INVALID_IP

header T_XOIP_INVALID_IP X-Originating-IP =~ /(?:^|[\[\s]) (?!(?:1\d\d|2[0-4]\d|25[0-5]|\d\d|\d)(?:\.(?:1\d\d|2[0-4]\d|25[0-5]|\d\d|\d)){3}) \d{1,3}(?:\.\d{1,3}){3} (?:$|[\]\s])/xm
tflags T_XOIP_INVALID_IP nopublish
#score T_XOIP_INVALID_IP 0.001
##} T_XOIP_INVALID_IP

##{ T_YAHOO_RDS_REDIR

uri T_YAHOO_RDS_REDIR m{^https?://rds\.yahoo\.com/_ylt=}i
##} T_YAHOO_RDS_REDIR

##{ T_YOUR_PERMISSION

meta     T_YOUR_PERMISSION  __YOUR_PERM && !__CTYPE_HAS_BOUNDARY && !__DKIM_EXISTS && !__DOS_HAS_LIST_UNSUB && !__CT_TEXT_PLAIN && !__BUGGED_IMG && !__COMMENT_EXISTS
describe T_YOUR_PERMISSION  With your permission...
##} T_YOUR_PERMISSION

##{ T_YOUR_PHOTOS

meta        T_YOUR_PHOTOS         __YOUR_PHOTOS && !__HAS_ANY_EMAIL && !__HAS_REPLY_TO && !__DOS_HAS_LIST_UNSUB 
describe    T_YOUR_PHOTOS         "Your Photos" phishing or malware
#score       T_YOUR_PHOTOS         4.00	# limit
##} T_YOUR_PHOTOS


header __5_SUBDOM X-Spam-Relays-External =~ /^[^\]]+ rdns=(?:[^. ]*\.){6,}\w+ /

header   __ALL_RANDOM           ALL =~ /(?:[%\#\[\$]R?A?NDO?M?|\%(?:CUSTOM|FROM|PROXY|X?MESSA|MAKE_TXT|FROM_USER))/i

header         __APPARENTLY_TO            Apparently-To =~ /<.*>/
tflags         __APPARENTLY_TO            multiple maxhits=21 nopublish

body        __ARTHUR_SIMMONS       /Arthur Simmons/

header		__AXB_LI_CLASS	exists:X-LinkedIn-Class

header		__AXB_LI_FBL	exists:X-LinkedIn-fbl

header		__AXB_LI_U	List-Unsubscribe =~ /\@em\.linkedin\.com\b/

header          __AXB_MO_OL_2600  X-MimeOLE =~ /Produced\ By\ Microsoft\ MimeOLE\ V6\.00\.2600\.0000/

header __AXB_MO_OL_C485C  X-MimeOLE =~ /Produced\ By\ Microsoft\ MimeOLE\ V6\.00\.2900\.5994/

header          __AXB_XM_OL_2600  X-Mailer =~ /Microsoft\ Outlook\ Express\ 6\.00\.2600\.0000/

header __AXB_XM_OL_C485C  X-Mailer =~ /Microsoft\ Outlook\ Express\ 6\.00\.2900\.5512/

body     __BEEN_APPROVED        /been approved/

header		__BELL_MOBILITY_RELAY	X-Spam-Relays-External =~ /^[^\]]+ rdns=mail\.txt\.bellmobilite\.ca helo=erwdbmgweb02\.bellmobilite\.ca /

body           __BIGNUM_EMAILS            /\b(?:thousand|million|\d[,\d]{4,})\s(?:(?!and|or|your)\w+\s)?(?:e-?mail\saddresses|leads|names)\b/i

uri             __BITLY_URI             /\/\/bit\.ly\//i

meta     __BOTH_INR_AND_REF	(__XM_BALSA || __XM_CALYPSO || __XM_FORTE || __XM_MHE || __XM_SQRLMAIL || __XM_SYLPHEED || __XM_THEBAT || __XM_VM || __XM_XIMEVOL || __UA_KMAIL || __UA_MOZ5 || __UA_OPERA7)

header __BOTNET_CLIENT1 X-Spam-Relays-External =~ /^[\]]+ rdns=\S*\b(?:ddns|dial-?(?:in|up)|dyn(?:amic)?ip|resident(?:ial)?|bredband)[^a-z]/i

header __BOTNET_CLIENT2 X-Spam-Relays-External =~ /^[\]]+ rdns=\S*(?:\b(?:pool|user)[^a-z]|[-.]ip[-.])/i

describe __BOTNET_NOTRUST	Message has no trusted relays
header	 __BOTNET_NOTRUST	X-Spam-Relays-Trusted !~ /ip=/i
tflags	 __BOTNET_NOTRUST	nopublish # confirm license with author first

header	 __BOTNET_OCNNEJP	X-Spam-Relays-Untrusted =~ /^[^\]]+ rdns=p\d{4}-ip\S*\.ocn\.ne\.jp\b/i

header __BOTNET_SERVER	X-Spam-Relays-External =~ /^[\]]+ rdns=\S*\b(?:e?mail(?:out)?|mta|mx(?:pool)?|relay|smtp|exch(?:ange)?)[^a-z]/i

header	 __BOTNET_SHAWCABLE	X-Spam-Relays-Untrusted =~ /^[^\]]+ rdns=s[0-9a-f]*\...\.shawcable\.net\b/i

meta     __BROKE_MUAS		(__XM_AOL || __XM_DTMAIL || __XM_FREEMAIL || __XM_LOTUSN5 || __XM_MSOE4 || __XM_NETMAIL || __XM_NETSCAPEW || __XM_NOVELL || __XM_OPENWEB || __XM_POSTMAN || __XM_WEBMAIL5)

header	 __BSD_REPORT       Subject =~ /.(?:ail|ecurit|eekl|onthl)y run output$/

header __BUG6919_RDNS_DYNAMIC_SPACELAN X-Spam-Relays-External =~ /^[^\]]+ rdns=\S+-[a-z]\d+-\d+\.spacelan\.ne\.jp/i

header   __BUG6919_RDNS_STATIC  X-Spam-Relays-External =~ /^[^\]]+ rdns=\S*(?:fix|fixip|static|dedicated|business|compute)/i

body __CARD_DIRECT_WWW_ADDRESS /card's direct www address below while you are connected to the Internet/

header      __CC_TOO_MANY          Cc =~ /(?:,[^,]{1,80}){30}/

body     __COMPLETE_REVIEW      /complete review/

header   __CONGRADULAT  Subject =~ /congra[dt]ulation/i

body      __COSTA_RI            /Costa Rica/i

header     __CTYPE_MULTIPART_MIXED Content-Type =~ /multipart\/mixed/i

header   __DATE_LOWER           ALL =~ /date:\s\S{5}/

uri      __DOMAIN_WITH_NUMS     /www[^.]+\.[^.]+\d[^.]+\./i

body __DOS_198K_VARI	/\$198,?\d{3}(?:\.00)? at a [0-3]\.\d{2}% variable/

body __DOS_248K_FIXED	/\$248,?\d{3}(?:\.00)? at a [0-3]\.\d{2}% fixed/

body __DOS_372K_VARI	/\$372,?\d{3}(?:\.00)? at a [0-3]\.\d{2}% variable/

body __DOS_488K_FIXED	/\$488,?\d{3}(?:\.00)? at a [0-3]\.\d{2}% fixed/

body __DOS_492K_INT	/\$492,?\d{3}(?:\.00)? at a [0-3]\.\d{2}% interest/

body __DOS_DEAL_MAKE_MONEY	/is the \w{2,20} deal and those who knows it is making money/

body	__DOS_DOM_LIST_CENTER		/Domain Listing Center/

header  __DOS_FINAL_NOTICE_DL		Subject =~ /Final Notice of Domain Listing/

body __DOS_GREAT_DRAWN_UP	/great \w{2,20} are drawn up/

header __DOS_HAVE_TO_READ	Subject =~ /have to read/

body __DOS_HEADLINES	/\bHeadlines\b/

body __DOS_INCREASE_UP		/increase is up/

body __DOS_KEY_GET_IN_EARLY	/key is getting in early/

header __DOS_MAILER_SM	X-Mailer =~ /SquirrelMail/

body __DOS_MED_CAN_WEB_PHARM    /\b(?:Web-Based Canadian|Canadian On-Line) Pharmacy\b/i

body __DOS_MED_MARK_DOWN        /\d{2}% (?:mark down|reduction)/i

body __DOS_MED_NO_DIRECTION     /\bN0 (?:(?:medicinal|doctor) (?:directions|instructions|recommendations)|prescriptions needed)\b/

body __DOS_MED_WHAT_COULD       /\bwhat (?:more|else) could you /i

header __DOS_MSGID_DIGITS10 Message-ID =~ /<1[013-9]\d{8}\@.*>/

header __DOS_MSGID_DIGITS9 Message-ID =~ /<\d{9}\@.*>/

body	__DOS_NOT_A_BILL		/THIS IS NOT A BILL/

body __DOS_NO_STOPPING		/no stopping this one/

body __DOS_OIL_EXCEED		/oil \w{2,20} exceeded all its expectations/

header __DOS_RELAY_SM	Received =~ /SquirrelMail authenticated/

header __DOS_REQ_TO_READ	Subject =~ /require to read/

header __DOS_SM_MID	Message-ID =~ /^<\d{4,8}(?:\.\d{1,3}){4}(?:\.\d{10})?\.squirrel\@[A-Za-z0-9._-]+>$/

body	__DOS_STOCK_COMPANY		/Company: /

body	__DOS_STOCK_O_PRICE		/(?:Current|Target)(?: Price)?:\s+\$(?:O\.|\d\.O)/

body	__DOS_STOCK_TICKER		/Ticker: /

body	__DOS_SUB_SEARCH_ENGINE		/Submission to \d{2,4} search engines/

body __DOS_SYMBOL_4	/\bSymbol [A-Z]{4}\b/

body __DOS_TOLD_DAY		/have been told that (?:Mon|Tues|Wednes|Thurs|Fri)day is the day/

header __DOS_UA_SM	User-Agent =~ /SquirrelMail/

body __DOS_WASTE_TIME_MISS	/(?:waste time|loss moment) and miss out/

uri        __DQ_URI_ONLY_ARGS       m'^https?://\d+\.\d+\.\d+\.\d+/\?[0-9a-f]{8,}'

header	 __EBAY_ADDRESS 	From:addr =~ /[\@.]ebay\.\w\w\w?(?:\.\w\w)?$/i

uri        __EXECUTABLE_URI         /\.(?:exe|scr|dll|pif|vbs|wsh|cmd|bat)$/i

body        __FBI_BODY_SHOUT_1   /^FEDERAL BUREAU OF INVESTIGATIONS?\b/

rawbody     __FBI_BODY_SHOUT_2   /^FEDERAL BUREAU OF INVESTIGATIONS?\b/m

header      __FBI_FM_DOM         From:addr =~ /\bfbi\.gov$/

header      __FBI_FM_NAME        From:name =~ /federal\sbureau\sof\sinvestigation/i

header      __FBI_RCVD_DOM       X-Spam-Relays-External =~ / rdns=\S+\bfbi\.gov /

meta        __FBI_SPOOF          (__FBI_FM_NAME || __FBI_FM_DOM || __FBI_BODY_SHOUT_1 || __FBI_BODY_SHOUT_2) && !__FBI_RCVD_DOM && __REPLYTO_EXISTS

body     __FB_BEST              /BEST/

body     __FB_BIG               /BIG/

body     __FB_COULD_NOT_F       /could not find you/i

body     __FB_CUSTOM_LOGO       /(?:custom|unique) logo/i

body     __FB_CUSTOM_RECOG      /customer recognition/i

body     __FB_DO_NOT_REPLY      /Do not reply to this address/i

body     __FB_EMAIL_ME_BAC      /Email me baca?k at/i

body   __FB_FIND_OUT            /find out how/i

body   __FB_FROM_YOUR           /from your/i

body   __FB_GENERATE            /generate/i

body   __FB_HOME_HOUSE          /ho(?:use|me)/i

body     __FB_HOWMUCH           /How Much/i

body     __FB_IDENTITY          /identity/i

body     __FB_IMAGE_OF          /image of your company/i

body     __FB_LOGO_DESIGN       /Logo Design/i

body     __FB_PPLE_ARE_SEARCH   /(?:People|they) are searching/i

body     __FB_REASON            /REASON/

body     __FB_TARGET_AUDIEN     /target audience/i

body     __FB_YOUR_IMAGE        /your(?: compan(?:y(?:'s)?|ies)) image/i

body     __FB_YOUR_MEDS         /your meds/i

body     __FB_YOU_ARE_PAYING    /you are paying/i

meta     __FM_HOW_COST          (__FB_HOWMUCH && __FB_COST)

meta     __FM_HOW_COST_ID       (__FM_HOW_COST || __FB_IDENTITY)

meta     __FM_MORTGAGE3PLUS     ((__PREAPPROVEDFVGT + __FIXED_RATEFVGT + __YOUR_CREDITFVGT + __HOMELOANFVGT + __APPROVALFVGT + __BIGDOLLARSFVGT + __LOANURIFVGT + __MORTURIFVGT) > 2)

meta     __FM_MORTGAGE4PLUS     ((__PREAPPROVEDFVGT + __FIXED_RATEFVGT + __YOUR_CREDITFVGT + __HOMELOANFVGT + __APPROVALFVGT + __BIGDOLLARSFVGT + __LOANURIFVGT + __MORTURIFVGT) > 3)

meta           __FM_TO_ALL_NUMS     __FROM_ALL_NUMS && __TO_ALL_NUMS  

meta     __FM_YOUR_IMAGE        (__FB_YOUR_IMAGE || __FB_IMAGE_OF)

body        __FORGED_FB_USERCP_01  /This message was intended for Want to control which emails you receive from Facebook\?/i

uri	 __FORGED_URL_DOM_1	m'https?://[^/]{0,40}\.(?:com|org|edu|net|gov|com?\.[a-z]{2})\.\w[^/\s]{4}'i

rawbody	 __FORGED_URL_DOM_2	m'(^|\W)https?://[\w.-]{0,40}\.(?:com|org|edu|net|gov|com?\.[a-z]{2})\.\w[^/\s]{5}'i

meta     __FORM_FRAUD     (__FILL_THIS_FORM || __FILL_THIS_FORM_SHORT) && (__FRAUD_VQE + __FRAUD_KJV + __FRAUD_IRJ + __FRAUD_NEB + __FRAUD_XJR + __FRAUD_DPR + __FRAUD_BEP + __FRAUD_TDP + __FRAUD_GAN + __FRAUD_IRT + __FRAUD_AON + __FRAUD_WNY + __FRAUD_IPK + __FRAUD_QXX + __FRAUD_IOV + __FRAUD_MLY + __FRAUD_ULK + __FRAUD_BGP + __FRAUD_YWW + __FRAUD_JYG + __FRAUD_XWW + __FRAUD_UUY + __FRAUD_SNT + __FRAUD_JNB + __FRAUD_QFY + __FRAUD_WDR + __FRAUD_WFC + __FRAUD_AUM + __FRAUD_MCQ + __FRAUD_PVN + __FRAUD_FVU + __FRAUD_CKF + __FRAUD_MQO + __FRAUD_TCC + __FRAUD_GBW + __FRAUD_AXF + __FRAUD_THJ + __FRAUD_YQV + __FRAUD_YJA + __FRAUD_YPO + __FRAUD_UOQ + __AFRICAN_STATE + __AGREED_RATIO + __AM_DYING + __ATM_CARD + __BACK_SCRATCH +  __BARRISTER + __BENEFICIARY + __COMPENSATION + __CONTACT_ATTY + __CONTACT_YOU + __COURIER + __DEAD_PARENT + __DEAL + DEAR_BENEFICIARY + DEAR_WINNER + __DECEASED + __DESTROY_ME + __DIED_IN + __DIPLOMATIC + __DORMANT_ACCT + __EARLY_DEMISE + T_EMRCP + __EX_CUSTOMER + __FEES + __FIFTY_FIFTY + __FOUND_YOU + __FRAUD + __FRAUD_PTX + __HUSH_HUSH + __I_INHERIT + __INHERIT_PMT + __INTL_BANK + __INVEST_COUNTRY + __INVEST_MONEY + __IS_LEGAL + __I_WILL_YOU + __KAM_LOTTO2 + __LOTTO_ADMITS + LOTTO_AGENT + __LOTTO_DEPT + __LOTTO_RELATED + __LOTTO_VERIFY + T_LOTTO_URI + __LOTTO_WIN_01 + __LOTTO_WINNINGS + __LUCKY_WINNER + __LUCRATIVE + __MILLIONS + __MY_FORTUNE + __NEXT_OF_KIN + __NOT_DEAD_YET + __NOT_SCAM + __OUR_BEHALF + __SCAM + __SHARE_IT + __SUM_OF_FUND + __SURVIVORS + __THEY_INHERIT + __TRTMT_DEFILED + __TRUNK_BOX +  __UN + UNCLAIMED_MONEY + __WIDOW + __WILL_LEGAL + __XFER_MONEY + __YOU_ASSIST + __YOU_INHERIT + __YOUR_BANK + __YOUR_FUND + __YOUR_PERM + __YOUR_PROFIT + __YOU_WON + T_LOTTO_AGENT_FM + T_LOTTO_AGENT_RPLY + __PCT_FOR_YOU + __PCT_OF_PMTS + __RANDOM_PICK + __CHARITY > 1)

meta        __FORM_LOW_CONTRAST   (__FILL_THIS_FORM_SHORT2 || __FILL_THIS_FORM_SHORT2) && HTML_FONT_LOW_CONTRAST 

header __FROM_ALL_HEX	    From:addr =~ /^(?!(?:19|20)\d\d[01]\d[0-3]\d)(?![0-9a-f]*[a-f]{3})[0-9a-f]+\@/

header         __FROM_ALL_NUMS      From:addr =~ /^\d+@/

header __FROM_ALL_NUMS_FIX  From:addr =~ /^(?!(?:19|20)\d\d[01]\d[0-3]\d)\d+\@/

header	 __FROM_DNS		From =~ /(?<![^\w.-])dns(?:admin)?\@/i

header	 __FROM_FULL_NAME	From:name =~ /^[^a-z[:punct:][:cntrl:]\d\s][^[:punct:][:cntrl:]\d\s]*[[:punct:]\s]+[^a-z[:punct:][:cntrl:]\d\s]/
tflags	 __FROM_FULL_NAME	nice

header   __FROM_GMAIL           From =~ /gmail\.com/

header	 __FROM_INFO		From =~ /(?<![^\w.-])info\@/i

header         __FROM_URI_1               From =~ /[^\@]www[.\s][^\s"<\@]+[.\s](?:com|net|info|biz|org|\w\w)\b.*["<]/i

header         __FROM_URI_2               From =~ m;http://(?:[^.\s]+\.){1,3}(?:com|net|info|biz|org|\w\w)\b;i

header __FROM_WEB_DAEMON From:addr =~ /(?:apache|www|web|tomcat|\biis\b).*\@/i

rawbody  __FR_SPACING_15        /[a-z0-9]{6}\s{15}[a-z0-9]{5}/i

rawbody  __FR_SPACING_17        /[a-z0-9]{6}\s{17}[a-z0-9]{5}/i

rawbody  __FR_SPACING_22        /[a-z0-9]{6}\s{22}[a-z0-9]{5}/i

rawbody  __FR_SPACING_9         /[a-z0-9]{6}\s{9}[a-z0-9]{5}/i

body     __FSL_ATM_CARD        /\bATM [Cc][Aa][Rr][Dd]\b/

body     __FSL_BODY_SEO_1      /\bSEO\b/

body     __FSL_BODY_SEO_2      /\bsearch engine optimi[sz]ation\b/i

header   __FSL_ENVFROM_AOL      X-Spam-Relays-External =~ /^[^\]]+ envfrom=[^\@ ]+\@aol\./i

header   __FSL_ENVFROM_GOOGLE	X-Spam-Relays-External =~ /^[^\]]+ envfrom=[^\@ ]+\@g(?:mail|oogle)\.com /i

header   __FSL_ENVFROM_HOTMAIL  X-Spam-Relays-External =~ /^[^\]]+ envfrom=[^\@ ]+\@hotmail\./i

header   __FSL_ENVFROM_LIVE     X-Spam-Relays-External =~ /^[^\]]+ envfrom=[^\@ ]+\@live\./i

header   __FSL_ENVFROM_ROCKET   X-Spam-Relays-External =~ /^[^\]]+ envfrom=[^\@ ]+\@rocketmail\.com /i

header   __FSL_ENVFROM_YAHOO    X-Spam-Relays-External =~ /^[^\]]+ envfrom=[^\@ ]+\@yahoo(?:groups)?\./i

header   __FSL_ENVFROM_YMAIL    X-Spam-Relays-External =~ /^[^\]]+ envfrom=[^\@ ]+\@ymail\.com /i

body     __FSL_FRIEND_SPAM       /^\s*h(?:i|ello)\s+\S+\s+http:\/\//mi

header   __FSL_FROM_EQ_REPTO     ALL =~ /(?:Reply-To|From):\s*([^<]+)\s*<[^\@ ]+@[^> ]+>.*(?:From|Reply-To):\s*\1/msi

header   __FSL_HAS_LIST_UNSUB  exists:List-Unsubscribe

header  __FSL_HELO_USER_1   X-Spam-Relays-External =~ / helo=user /i

header  __FSL_HELO_USER_2   Received =~ /from User(?:\s+by|\s*\(|$)/i

header  __FSL_HELO_USER_3   Received =~ /helo(?:=|\s)User/i

header   __FSL_IPV4_41         ALL =~ /(?:\(|\s+)?\[?41\.(?:[0-9]{1,3}\.){2}[0-9]{1,3}\]?/

body     __FSL_MAIL_HAS        /your mail has/i

header   __FSL_PHISH_ADMIN      From:name =~ /admin(?:istrator)?\b/i

body     __FSL_PHISH_DE         /\bdeactivat(?:ed?|ion)\b/i

body     __FSL_PHISH_MB         /\b(?:this|your|you're) (?:e|e-)?mailbox (?:has|is)\b/i

body     __FSL_PHISH_PW         /\bpass\s*word\s*:/i

body     __FSL_PHISH_RV         /\bre-?validat(?:ed?|ion)\b/i

body     __FSL_PHISH_UN         /\buser\s*name\s*:/i

header   __FSL_RELAY_AOL        X-Spam-Relays-External =~ /^[^\]]+ rdns=[^ ]+\.aol\.com/i

header   __FSL_RELAY_GOOGLE	X-Spam-Relays-External =~ /^[^\]]+ rdns=[^ ]+\.google\.com /i

header   __FSL_RELAY_HOTMAIL    X-Spam-Relays-External =~ /^[^\]]+ rdns=[^ ]+\.hotmail\.com /i

header   __FSL_RELAY_YAHOO      X-Spam-Relays-External =~ /^[^\]]+ rdns=[^ ]+\.yahoo(?:dns)?\.co(?:m|\.jp) /i

header   __FSL_SUBJECT_EMAIL   Subject =~ /\b[^\@ ]+\@[^\@ ]+\b/

header   __FSL_SUBJ_SEO_1      Subject =~ /\bSEO\b/i

header   __FSL_SUBJ_SEO_2      Subject =~ /\bsearch engine optimi[sz]ation\b/i

header   __FSL_TO_COMMON_ROLE  To:addr =~ /^((?:post|web|domain)master|info|sales|(?:tech)?support|(?:sys)?admin(?:istrator)?|abuse|noc|root|security|compliance|registrar)@/i

body     __FSL_URGENT_ASSIST   /your urgent assist/i

header   __FSL_YAHOO_AUTH1      Received =~ /from [a-z]{10} \([^\@ ]+\@\d+\.\d+\.\d+\.\d+ with (?:plain|login)\) /

header   __FSL_YAHOO_AUTH2      Received =~ /from localhost \([^\@ ]+\@\d+\.\d+\.\d+\.\d+ with (?:plain|login)\) /i

header   __FSL_YAHOO_AUTH3      Received =~ /from user \([^\@ ]+\@\d+\.\d+\.\d+\.\d+ with (?:plain|login)\) /i

header   __FS_ADIDAS            Subject =~ /\badidas\b/i

header   __FS_CLAIM_YOUR        Subject =~ /claim your/i

header   __FS_COKE              Subject =~ /\bcoke\b/i

header   __FS_COST              Subject =~ /cost/i

header   __FS_DEBT              Subject =~ /debt/i

header   __FS_FREE              Subject =~ /\bfree\b/i

header   __FS_HELP              Subject =~ /help/i

header   __FS_HOWMUCH           Subject =~ /how much/i

header   __FS_IMAGE             Subject =~ /your(?: compan(?:y(?:'s)?|ies))? image/i

header   __FS_IPODXBOX          Subject =~ /(?:ipod|xbox)/i

header   __FS_LEND              Subject =~ /\blend\b/i

header   __FS_MP3PLAY           Subject =~ /mp3 player/i

header   __FS_NIKE              Subject =~ /\bnike\b/i

header   __FS_PEPSI             Subject =~ /\bpepsi\b/i

header   __FS_RE_TWO_WORDS      Subject =~ /^Re: (?:[a-z']{2,5}\s+){2}$/

header   __FS_TEEN              Subject =~ /\bteen\b/i

uri      __FU_LOAN              /[a-pr-z0-9]+loan[a-z0-9]+\.com/i

body     __F_ASS                /\bass\b/i

body     __F_FUCK               /\bfuck\b/i

body     __F_TEEN               /teens?\b/i

meta        __GAPPY_HTML           __MIME_HTML && (__GAPPY_HTML_01 || __GAPPY_HTML_02)

full        __GAPPY_HTML_01        m;</?[a-z]{1,6}(?:\s[^>]{0,40})?>(?:\s|=09){0,80}(?:(?!\d)[\w'()\#,.:!]{1,15}(?:\s|=09){4,80}){7}\S;

full        __GAPPY_HTML_02        m;\S(?:(?:\s|=09){4,80}(?!\d)[\w'()\#,.:!]{1,15}){7}(?:\s|=09){0,5}</?[a-z]{1,6}/?>;

body        __GAPPY_PHONE_NA       /1 - \d \d \d - \d \d \d - \d \d \d \d/

header   __GETYOUR      subject =~ /get your/i

body     __GET_TICKET       /\bget\syour\sticket+\b/i

header   __GIFTCERT     Subject =~ /(?:gift|gas) (?:cert|card)/i

body     __GOOD_ENOUGH          /good enough/

header __GOOGLE_GROUPS_UA       User-Agent =~ /^G2\//

header	 __GREYLISTED	ALL =~ /(?:^|\n)X-(?:Scam-Grey|Greylist(?:ing)?):\s+delay(?:ed)? (?:for )?\d+(?: ?s(?:ec(?:ond)?s?)?|:\d\d)/im

header	 __GREYLISTING	ALL =~ /(?:^|\n)X-(?:Scam-Grey|Greylist(?:ing)?):\s/m
tflags	 __GREYLISTING	nice

uri         __GZ_PILL_SQUAT1       /\/[a-z]{3,8}\d{2}\.html/i

uri         __GZ_PILL_SQUAT2       /\/[a-z]{3,8}\d{2}\.jpg/i

meta        __GZ_PILL_SQUATTERS    __GZ_PILL_SQUAT1 && __GZ_PILL_SQUAT2

meta           __HDRS_LCASE_1K       __HDRS_LCASE && __SINGLE_HEADER_1K

header __HEAD_X_KERNEL          exists:X-Kernel

header	 __HELO_AS_VICTIM 	X-Spam-Relays-External =~ /^[^\]]+ helo=(\S+) [^\]]*\bby=\1 /

header   __HELO_MISC_IP        	X-Spam-Relays-Untrusted =~ /^[^\]]+ helo=[^a-z\?]\S{0,30}(?:\d{1,3}[^\d]){4}[^\]]+ auth= /i

header __HELO_NOT_RDNS	X-Spam-Relays-External =~ /^[^\]]+ rdns=(\S+) helo=(?!\1)\S/

body		__HK_LOTTO_AWARD	/(?:cash prize|prize awards?|you have been awarded|award (?:notification|notice))/i

header	 __HOTMAIL_HELO	Received =~ /from ([A-Z]{3})\d[^.]+ [^\n]+ by \1\d+-[^\n ]+\.\1\d+\.hotmail\.com with Microsoft/i
tflags	 __HOTMAIL_HELO 	nice

rawbody __HS_QUOTE_rulesrc_sandbox_jm_20_basic_cf /^> /

header __HS_SUBJ_RE_FW_rulesrc_sandbox_jm_20_basic_cf Subject =~ /^(?i:re|fw):/

meta        __HTML_FONT_LOW_CONTRAST_MINFP	HTML_FONT_LOW_CONTRAST && !__RCD_RDNS_MAIL && !__DOS_HAS_LIST_UNSUB && !__MAIL_LINK 

rawbody     __HTML_FONT_TINY_01  /font-size:\s?[0-4]px;/i

meta     __INR_AND_NO_REF	(__XM_IMAIL || __XM_APPLEMAIL || __XM_COMMUNIG || __XM_EDMAX || __XM_ELM || __XM_EMUMAIL || __XM_EXMH || __XM_LOTUSN || __XM_MAILCITY || __XM_MAILSMITH || __XM_MSCDO || __XM_MSOUT || __XM_MIMETOOLS || __XM_OPERA6 || __XM_PEGASUS || __XM_QUALCOM || __UA_IMP || __UA_MSOEMAC || __UA_MSENTOUR || __UA_OPERA7)

body        __INTRUST_DOMS         /In[Tt]rust Domains/

header __IP_IN_RELAY  X-Spam-Relays-External =~ /^\[ ip=(\d+)\.(\d+)\.(\d+)\.(\d+) (?:[^\]]* )?(?:rdns|helo)=\S*(?:\1\D\2\D\3\D\4|\4\D\3\D\2\D\1)/

header      __IRS_FM_DOM         From:addr =~ /\birs\.gov$/

header      __IRS_FM_NAME        From:name =~ /internal\srevenue\sservice/i

header      __IRS_RCVD_DOM       X-Spam-Relays-External =~ / rdns=\S+\birs\.gov /

meta        __IRS_SPOOF          (__IRS_FM_NAME || __IRS_FM_DOM) && !__IRS_RCVD_DOM && __REPLYTO_EXISTS

header __JM_REACTOR_MID     Message-ID =~ /^<000\S+\@[a-z0-9]+>$/

header __JM_REACTOR_XM2900  X-Mailer =~ /^Microsoft Outlook Express 6.00.2900.3138$/

header __JM_REACTOR_XMOLE   X-MimeOLE =~ /^Produced By Microsoft MimeOLE V6.00.2900.3198$/

header 		__KAM_BLOCK_UTF7_1	Content-Type =~ /charset=(?:unicode-\d+-\d+-)?utf-7/i

body __KAM_LOTTO1_BUG6000 /(e-?mail[- ](address|ID) (have emerged a winner|attached to (ticket|reference)|was one of the ten winners)|random selection in our computerized email selection system|was selected online)/is

body __KAM_LOTTO5_BUG6000 /(affiliated office of |freelotto (affiliated|group)|Royal Heritage Lottery|UK National (Online)? Lottery|U\.?K\.? Grand Promotions|Lottery Department UK|Euromillion Loteria|International Lottery)/is

header   __KB_UA_MOZ      User-Agent =~ /\bMozilla/

meta	 __KHOP_NO_FULL_NAME	!(__NOT_A_PERSON || __FROM_ENCODED_QP || __FROM_NEEDS_MIME || __FROM_FULL_NAME)

header __KHOP_SC_CIDR8  X-Spam-Relays-Untrusted =~ /^[^\]]* (?:by|ip)=(?-xism:\b(?:1(?:13|86)|9[35])(?:\.[012]?\d{1,2}){3}\b) /

header __KHOP_SC_TOP_CIDR8  X-Spam-Relays-Untrusted =~ /^[^\]]* (?:by|ip)=(?-xism:\b(?:1(?:78|90)|37|2)(?:\.[012]?\d{1,2}){3}\b) /

meta __KHOP_SPAMMY_CIDR16  T_KHOP_SC_CIDR16||T_KHOP_SC_TOP_CIDR16

meta __KHOP_SPAMMY_CIDR24  T_KHOP_PSBL_CIDR24||T_KHOP_SC_CIDR24||T_KHOP_SC_TOP_CIDR24

meta __KHOP_SPAMMY_CIDR8   T_KHOP_SC_CIDR8||T_KHOP_SC_TOP_CIDR8

meta __KHOP_SPAMMY_SUBNET __KHOP_SPAMMY_CIDR24||__KHOP_SPAMMY_CIDR16

body __LEGIT_MARLO_CARD /At our Card Pick Up site, enter BOTH the Directory/

header __LISTID_DEBIAN	List-Id =~ /\.lists\.debian\.org>/

meta        __LIST_PARTIAL         __DOS_HAS_LIST_UNSUB && !__DOS_HAS_LIST_ID
describe    __LIST_PARTIAL         Has incomplete List-* header set

body __LOCAL_PP_B_UPD		m'(?:confirm|update|verify) (?:your|the) (?:(?:current|billing) )?(?:records?|information|account|identity)'i

body __LOCAL_PP_PPCGIURL	m'https?://www.paypal.com/cgi-bin/webscr\?'i

header __LOCAL_PP_S_UPD		Subject: =~ m'(?:confirm|update) (?:your|the) (?:billing )?(?:records?|information|account)'i

header	 __LOGWATCH_REPORT	Subject =~ /^Log[Ww]atch for /

rawbody  __LONGLINE	/^.{998}[^\r\n]/

body     __LOSE_WEIGHT          /l.{0,1}o.{0,1}s.{0,1}e.{0,4}w.{0,1}e.{0,1}[i1].{0,1}g.{0,1}h.{0,1}t/i

uri            __MANY_SUBDOM       m;^https?://(?:[^\./]{1,30}\.){6};i

header __MAY_BE_FORGED	Received =~ /\(may be forged\)/

body        __MIME_CTYPE_IN_BODY    /^Content-Type:\s/

meta        __MIME_MALF      __CTYPE_MULTIPART_ANY && __MIME_CTYPE_IN_BODY

header   __MISSING_THREAD	Thread-Index =~ /^UNSET$/ [if-unset: UNSET]

meta           __MONEY_12LTRDOM    __FROM_12LTRDOM_1 && __LOTSA_MONEY_00

meta     __MONEY_FORM        LOTS_OF_MONEY && __FILL_THIS_FORM

meta     __MONEY_FRAUD    LOTS_OF_MONEY && (__FRAUD_VQE + __FRAUD_KJV + __FRAUD_IRJ + __FRAUD_NEB + __FRAUD_XJR + __FRAUD_DPR + __FRAUD_BEP + __FRAUD_TDP + __FRAUD_GAN + __FRAUD_IRT + __FRAUD_AON + __FRAUD_WNY + __FRAUD_IPK + __FRAUD_QXX + __FRAUD_IOV + __FRAUD_MLY + __FRAUD_ULK + __FRAUD_BGP + __FRAUD_YWW + __FRAUD_JYG + __FRAUD_XWW + __FRAUD_UUY + __FRAUD_SNT + __FRAUD_JNB + __FRAUD_QFY + __FRAUD_WDR + __FRAUD_WFC + __FRAUD_AUM + __FRAUD_MCQ + __FRAUD_PVN + __FRAUD_FVU + __FRAUD_CKF + __FRAUD_MQO + __FRAUD_TCC + __FRAUD_GBW + __FRAUD_AXF + __FRAUD_THJ + __FRAUD_YQV + __FRAUD_YJA + __FRAUD_YPO + __FRAUD_UOQ + __AFRICAN_STATE + __AGREED_RATIO + __AM_DYING + __ATM_CARD + __BACK_SCRATCH +  __BARRISTER + __BENEFICIARY + __COMPENSATION + __CONTACT_ATTY + __CONTACT_YOU + __COURIER + __DEAD_PARENT + __DEAL + DEAR_BENEFICIARY + DEAR_WINNER + __DECEASED + __DESTROY_ME + __DIED_IN + __DIPLOMATIC + __DORMANT_ACCT + __EARLY_DEMISE + T_EMRCP + __EX_CUSTOMER + __FEES + __FIFTY_FIFTY + __FOUND_YOU + __FRAUD + __FRAUD_PTX + __HUSH_HUSH + __I_INHERIT + __INHERIT_PMT + __INTL_BANK + __INVEST_COUNTRY + __INVEST_MONEY + __IS_LEGAL + __I_WILL_YOU + __KAM_LOTTO2 + __LOTTO_ADMITS + LOTTO_AGENT + __LOTTO_DEPT + __LOTTO_RELATED + __LOTTO_VERIFY + T_LOTTO_URI + __LOTTO_WIN_01 + __LOTTO_WINNINGS +  __LUCKY_WINNER + __LUCRATIVE + __MILLIONS + __MY_FORTUNE + __NEXT_OF_KIN + __NOT_DEAD_YET + __NOT_SCAM + __OUR_BEHALF + __SCAM + __SHARE_IT + __SUM_OF_FUND + __SURVIVORS + __THEY_INHERIT + __TRTMT_DEFILED + __TRUNK_BOX +  __UN + UNCLAIMED_MONEY + __WIDOW + __WILL_LEGAL + __XFER_MONEY + __YOU_ASSIST + __YOU_INHERIT + __YOUR_BANK + __YOUR_FUND + __YOUR_PERM + __YOUR_PROFIT + __YOU_WON + T_LOTTO_AGENT_FM + T_LOTTO_AGENT_RPLY + __PCT_FOR_YOU + __PCT_OF_PMTS + __RANDOM_PICK + __CHARITY > 1)

meta     __MONEY_FRAUD_8  LOTS_OF_MONEY && (__FRAUD_VQE + __FRAUD_KJV + __FRAUD_IRJ + __FRAUD_NEB + __FRAUD_XJR + __FRAUD_DPR + __FRAUD_BEP + __FRAUD_TDP + __FRAUD_GAN + __FRAUD_IRT + __FRAUD_AON + __FRAUD_WNY + __FRAUD_IPK + __FRAUD_QXX + __FRAUD_IOV + __FRAUD_MLY + __FRAUD_ULK + __FRAUD_BGP + __FRAUD_YWW + __FRAUD_JYG + __FRAUD_XWW + __FRAUD_UUY + __FRAUD_SNT + __FRAUD_JNB + __FRAUD_QFY + __FRAUD_WDR + __FRAUD_WFC + __FRAUD_AUM + __FRAUD_MCQ + __FRAUD_PVN + __FRAUD_FVU + __FRAUD_CKF + __FRAUD_MQO + __FRAUD_TCC + __FRAUD_GBW + __FRAUD_AXF + __FRAUD_THJ + __FRAUD_YQV + __FRAUD_YJA + __FRAUD_YPO + __FRAUD_UOQ + __AFRICAN_STATE + __AGREED_RATIO + __AM_DYING + __ATM_CARD + __BACK_SCRATCH +  __BARRISTER + __BENEFICIARY + __COMPENSATION + __CONTACT_ATTY + __CONTACT_YOU + __COURIER + __DEAD_PARENT + __DEAL + DEAR_BENEFICIARY + DEAR_WINNER + __DECEASED + __DESTROY_ME + __DIED_IN + __DIPLOMATIC + __DORMANT_ACCT + __EARLY_DEMISE + T_EMRCP + __EX_CUSTOMER + __FEES + __FIFTY_FIFTY + __FOUND_YOU + __FRAUD + __FRAUD_PTX + __HUSH_HUSH + __I_INHERIT + __INHERIT_PMT + __INTL_BANK + __INVEST_COUNTRY + __INVEST_MONEY + __IS_LEGAL + __I_WILL_YOU + __KAM_LOTTO2 + __LOTTO_ADMITS + LOTTO_AGENT + __LOTTO_DEPT + __LOTTO_RELATED + __LOTTO_VERIFY + T_LOTTO_URI + __LOTTO_WIN_01 + __LOTTO_WINNINGS +  __LUCKY_WINNER + __LUCRATIVE + __MILLIONS + __MY_FORTUNE + __NEXT_OF_KIN + __NOT_DEAD_YET + __NOT_SCAM + __OUR_BEHALF + __SCAM + __SHARE_IT + __SUM_OF_FUND + __SURVIVORS + __THEY_INHERIT + __TRTMT_DEFILED + __TRUNK_BOX +  __UN + UNCLAIMED_MONEY + __WIDOW + __WILL_LEGAL + __XFER_MONEY + __YOU_ASSIST + __YOU_INHERIT + __YOUR_BANK + __YOUR_FUND + __YOUR_PERM + __YOUR_PROFIT + __YOU_WON + T_LOTTO_AGENT_FM + T_LOTTO_AGENT_RPLY + __PCT_FOR_YOU + __PCT_OF_PMTS + __RANDOM_PICK + __CHARITY > 8)

meta     __MONEY_LOTTERY  LOTS_OF_MONEY && (__LOTTO_WINNINGS + __LOTTO_WIN_01 + __YOU_WON + __LOTTO_AGENT_01 + __LOTTO_AGENT_02 + __LOTTO_DEPT + T_LOTTO_AGENT_FM + T_LOTTO_AGENT_RPLY + __LOTTO_ADMITS + __LOTTO_RELATED + DEAR_WINNER + __LOTTO_VERIFY + __GET_TICKET > 1)

header   __MSGID_GMAIL          MESSAGEID =~ /gmail\.com/i

header         __MSGID_GUID          Message-ID =~ /^<?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}\@/i

meta           __MSGID_GUID_FAKE     __MSGID_GUID_LOOSE && !__MSGID_GUID

header         __MSGID_GUID_LOOSE    Message-ID =~ /^<?[0-9A-Z]{8}-(?:[0-9A-Z]{3,4}-){3}[0-9A-Z]{11,12}\@/

header __MSNBC_NOT_EXCH         X-MimeOLE =~ /^Produced By Microsoft Exchange/

header __MSNBC_THREAD_INDEX     ALL =~ /\nthread-index: /s

header         __MUA_EQ_ORG_1        ALL =~ /\nX-Mailer: ([^\n]+)\n.*Organization: \1\n/ism

header         __MUA_EQ_ORG_2        ALL =~ /\nOrganization: ([^\n]+)\n.*X-Mailer: \1\n/ism

header __MULTIPART_RELATED Content-Type =~ /multipart\/related/

header   __OPERA_MID_NO_DIGIT  Message-ID =~ /^<[^0-9]{2,40}\@/

header   __OPERA_MUA           User-Agent =~ /^Opera /

body      __OWN_LAND            /\bland\b/i

body      __OWN_PROP            /propert/i

header  __PHPMAILER_MUA       X-Mailer =~ /^PHPMailer\b/

header __PH_TVD_FROM2	From:addr =~ /\@.*ebay/i

body       __POSTCARD_HALLMARK_01   /\bYou(?:'ve| have) (?:just )?(?:rec[ei]{2}ved )?an? (?:new )?(?:greeting |anonymous |virtual )?Hallmark (?:post|e-?)?card\b/i

body       __POSTCARD_HALLMARK_02   /\bA (?:friend) has (?:just )?sent you an? (?:new )?(?:greeting |anonymous |virtual )?Hallmark (?:post|e-?)?card\b/i

rawbody  __PQRTW_4_A     m,<a name="\#[pqrtw]{4}">\s*</a>,

rawbody  __PQRTW_4_SPAN  m,<span name="\#[pqrtw]{4}">\s*</span>,

rawbody __PR_TD_NOWRAP      /<td nowrap>/

body   __RAJONAA_INFO	m' rajonaa: http://www\.[\w-]{0,50}\.info !$'

rawbody  __RAW_RANDOM           /(?:[%\#\[\$]RA?NDO?M?|\%(?:CUSTOM|FROM|PROXY|X?MESSA|MAKE_TXT))/i

header __RCD_RDNS_DIAL X-Spam-Relays-External =~ /^[^\]]+ rdns=\S*\bdial(?:ing?)?s?[^a-z]/i

header __RCD_RDNS_DYN X-Spam-Relays-External =~ /^[^\]]+ rdns=\S*\bdyna?(?:mic)?s?[^a-z]/i

header __RCD_RDNS_DYN_MESSY X-Spam-Relays-External =~ /^[^\]]+ rdns=\S*dyn/i

header __RCD_RDNS_MAIL X-Spam-Relays-External =~ /^[^\]]+ rdns=\S*\bmail[^a-z]/i
tflags __RCD_RDNS_MAIL nice

header __RCD_RDNS_MTA X-Spam-Relays-External =~ /^[^\]]+ rdns=\S*\bmta[^a-z]/i
tflags __RCD_RDNS_MTA nice

header __RCD_RDNS_OB X-Spam-Relays-External =~ /^[^\]]+ rdns=\S*\boutbounds?[^a-z]/i
tflags __RCD_RDNS_OB nice

header __RCD_RDNS_OB_MESSY X-Spam-Relays-External =~ /^[^\]]+ rdns=\S*outbound/i
tflags __RCD_RDNS_OB_MESSY nice

header __RCD_RDNS_PPOE X-Spam-Relays-External =~ /^[^\]]+ rdns=\S*\bp?ppoe[^a-z]/i

header __RCD_RDNS_PPOE_MESSY X-Spam-Relays-External =~ /^[^\]]+ rdns=\S*ppoe/i

header __RCD_RDNS_PPP X-Spam-Relays-External =~ /^[^\]]+ rdns=\S*\bppp[^a-z]/i

header __RCD_RDNS_PPP_MESSY X-Spam-Relays-External =~ /^[^\]]+ rdns=\S*ppp/i

header __RCD_RDNS_PROXY X-Spam-Relays-External =~ /^[^\]]+ rdns=\S*\bprox(?:y(?:ing)?|ie[ds])[^a-z]/i

header __RCD_RDNS_PROXY_MESSY X-Spam-Relays-External =~ /^[^\]]+ rdns=\S*proxy/i

header __RCD_RDNS_SMTP X-Spam-Relays-External =~ /^[^\]]+ rdns=\S*\bsmtps?[^a-z]/i
tflags __RCD_RDNS_SMTP nice

header __RCD_RDNS_STATIC X-Spam-Relays-External =~ /^[^\]]+ rdns=\S*\bstatics?[^a-z]/i
tflags __RCD_RDNS_STATIC nice

header __RCD_RDNS_STATIC_MESSY X-Spam-Relays-External =~ /^[^\]]+ rdns=\S*static/i
tflags __RCD_RDNS_STATIC_MESSY nice

header         __RCVD_12LTRDOM     Received =~ /[(\s.][a-z]{12}\./

header	 __RCVD_VIA_AFRINIC	X-Spam-Relays-External =~ /^\[ ip=(?:(?:41|19[67])|202\.123\.(?:[12]?\d|3[01]))\.\d/

header	 __RCVD_VIA_AFRINIC_E	X-Spam-Relays-External  =~ /\[ ip=(?:(?:41|19[67])|202\.123\.(?:[12]?\d|3[01]))\.\d/
tflags	 __RCVD_VIA_AFRINIC_E	nopublish

header	 __RCVD_VIA_APNIC	X-Spam-Relays-External =~ /^\[ ip=(?-xism:1|27|5[89]|6[01]|1(?:[12][0-6]|1[7-9]|75|8[0123])|2(?:03|1[0189]|2[012]|02(?!\.123\.(?:[012]?\d|3[01])))|169\.2(?:0[89]|1\d|2[01]|223)|169\.2(?:1[04]|22))\.\d/

header	 __RCVD_VIA_APNIC_E	X-Spam-Relays-External  =~ /\[ ip=(?-xism:1|27|5[89]|6[01]|1(?:[12][0-6]|1[7-9]|75|8[0123])|2(?:03|1[0189]|2[012]|02(?!\.123\.(?:[012]?\d|3[01])))|169\.2(?:0[89]|1\d|2[01]|223)|169\.2(?:1[04]|22))\.\d/
tflags	 __RCVD_VIA_APNIC_E	nopublish

header	 __RCVD_VIA_ARIN	X-Spam-Relays-External =~ /^\[ ip=(?!169\.254|172\.(?:1[6-9]|2\d|3[01])\.|192\.(?:0\.[02]|168)\.|198\.51\.100)(?:1(?:3[0124-9]|6[0124-9]|4[02346-9]|5[25-9]|7[0234]|9[289]|0[78]|2[89]|84)|2(?:0[4-9]|16|4)|7[0-6]?|6[3-9]|9[6-9]|50)\.\d/

header	 __RCVD_VIA_ARIN_E	X-Spam-Relays-External  =~ /\[ ip=(?!169\.254|172\.(?:1[6-9]|2\d|3[01])\.|192\.(?:0\.[02]|168)\.|198\.51\.100)(?:1(?:3[0124-9]|6[0124-9]|4[02346-9]|5[25-9]|7[0234]|9[289]|0[78]|2[89]|84)|2(?:0[4-9]|16|4)|7[0-6]?|6[3-9]|9[6-9]|50)\.\d/
tflags	 __RCVD_VIA_ARIN_E	nopublish

header	 __RCVD_VIA_IPV6	X-Spam-Relays-External =~ /^\[ ip=[0-9a-f:]+ /i

header	 __RCVD_VIA_IPV6_E	X-Spam-Relays-External  =~ /\[ ip=[0-9a-f:]+ /i

header	 __RCVD_VIA_LACNIC	X-Spam-Relays-External =~ /^\[ ip=(?:1(?:90|8[679]|20(?:[01]\.|6\.223\.1(?:24|30))))\.\d/

header	 __RCVD_VIA_LACNIC_E	X-Spam-Relays-External  =~ /\[ ip=(?:1(?:90|8[679]|20(?:[01]\.|6\.223\.1(?:24|30))))\.\d/
tflags	 __RCVD_VIA_LACNIC_E	nopublish

header	 __RCVD_VIA_NON_RIR	X-Spam-Relays-External =~ /^\[ ip=(?:0(?:1[1235-9]|2[012689]|3[02-58]|4[034578]|5[2-7]|0[34689])|21[45])\.\d/

header	 __RCVD_VIA_NON_RIR_E	X-Spam-Relays-External  =~ /\[ ip=(?:0(?:1[1235-9]|2[012689]|3[02-58]|4[034578]|5[2-7]|0[34689])|21[45])\.\d/
tflags	 __RCVD_VIA_NON_RIR_E	nopublish

header	 __RCVD_VIA_RIPE	X-Spam-Relays-External =~ /^\[ ip=(?:1(?:9[345]|7[68]|09|88)|2(?:1(?:[23]|7))?|7[789]|9[0-5]|8\d|31|46|62)\.\d/

header	 __RCVD_VIA_RIPE_E	X-Spam-Relays-External  =~ /\[ ip=(?:1(?:9[345]|7[68]|09|88)|2(?:1(?:[23]|7))?|7[789]|9[0-5]|8\d|31|46|62)\.\d/
tflags	 __RCVD_VIA_RIPE_E	nopublish

header __RDNS_HEX X-Spam-Relays-External =~ /^[^\]]+ rdns=[^ .]*\d(?![0-9a-f]*[a-f]{3})[0-9a-f]{7}/

header __RDNS_HEX9 X-Spam-Relays-External =~ /^[^\]]+ rdns=[^ .]*\d(?![0-9a-f]*[a-f]{3})[0-9a-f]{8}/

header __RDNS_IS_WWW	X-Spam-Relays-External =~ /^[^\]]+ rdns=www\./

header __RDNS_LONG	X-Spam-Relays-External =~ /^[^\]]+ rdns=\S{30}/

header __RDNS_NO_SUBDOM	X-Spam-Relays-External =~ /^[^\]]+ rdns=[^. ]*\.\w+ /

header __RELAY_THRU_WWW	Received =~ /from (?:[^ \@]+\@)?www\./

header         __RPATH_12LTRDOM    Return-Path =~ /\@[a-z]{12}\./

meta           __RP_CERTIFIED_ANBREP_L3   RCVD_IN_RP_CERTIFIED && RCVD_IN_ANBREP_L3
tflags         __RP_CERTIFIED_ANBREP_L3   net nopublish

meta           __RP_CERTIFIED_BRBL        RCVD_IN_RP_CERTIFIED && RCVD_IN_BRBL_LASTEXT
tflags         __RP_CERTIFIED_BRBL        net nopublish

meta           __RP_CERTIFIED_PSBL        RCVD_IN_RP_CERTIFIED && RCVD_IN_PSBL
tflags         __RP_CERTIFIED_PSBL        net nopublish

meta           __RP_CERTIFIED_SORBS       RCVD_IN_RP_CERTIFIED && __RCVD_IN_SORBS
tflags         __RP_CERTIFIED_SORBS       net nopublish

meta           __RP_CERTIFIED_XBL         RCVD_IN_RP_CERTIFIED && RCVD_IN_XBL
tflags         __RP_CERTIFIED_XBL         net nopublish

meta           __RP_CERTIFIED_ZEN         RCVD_IN_RP_CERTIFIED && __RCVD_IN_ZEN
tflags         __RP_CERTIFIED_ZEN         net nopublish

meta           __RP_SAFE_ANBREP_L3        RCVD_IN_RP_SAFE && RCVD_IN_ANBREP_L3
tflags         __RP_SAFE_ANBREP_L3        net nopublish

meta           __RP_SAFE_BRBL             RCVD_IN_RP_SAFE && RCVD_IN_BRBL_LASTEXT
tflags         __RP_SAFE_BRBL             net nopublish

meta           __RP_SAFE_PSBL             RCVD_IN_RP_SAFE && RCVD_IN_PSBL
tflags         __RP_SAFE_PSBL             net nopublish

meta           __RP_SAFE_SORBS            RCVD_IN_RP_SAFE && __RCVD_IN_SORBS
tflags         __RP_SAFE_SORBS            net nopublish

meta           __RP_SAFE_XBL              RCVD_IN_RP_SAFE && RCVD_IN_XBL
tflags         __RP_SAFE_XBL              net nopublish

meta           __RP_SAFE_ZEN              RCVD_IN_RP_SAFE && __RCVD_IN_ZEN
tflags         __RP_SAFE_ZEN              net nopublish

header __S25R_1 X-Spam-Relays-External =~ /^[^\]]+ rdns=[^. ]*\d[^0-9. ]+\d\S*\./

header __S25R_2 X-Spam-Relays-External =~ /^[^\]]+ rdns=[^. ]*\d{5}/

header __S25R_3 X-Spam-Relays-External =~ /^[^\]]+ rdns=(?:[^. ]+\.)?\d[^. ]*\.[^. ]+\.\S+\.[a-z]/

header __S25R_4 X-Spam-Relays-External =~ /^[^\]]+ rdns=[^. ]*\d\.[^. ]*\d-\d/

header __S25R_5 X-Spam-Relays-External =~ /^[^\]]+ rdns=[^. ]*\d\.[^. ]*\d\.[^. ]+\.\S+\./

header __S25R_6 X-Spam-Relays-External =~ /^[^\]]+ rdns=(?:dhcp|dialup|ppp|[achrsvx]?dsl)[^. ]*\d/

body        __SCANNED              /\b(?:(?:document was scan+ed and sent ?to you using|Scan from)(?: an?)? (?:(?:Hewlet+-Packard |HP ){1,2}Officejet|Hewlet+-Packard Officejet Location: machine location not set)|Xerox\b)/i

rawbody        __SCRIPT_GIBBERISH       /<script>[^;<]{100}/im

body           __SCRIPT_TAG_IN_BODY     /<script>/i

body     __SEEN_ON_ABC          /\bA[^a-z]{0,1}B[^a-z]{0,1}C\b/i

body     __SEEN_ON_CBS          /\bC[^a-z]{0,1}B[^a-z]{0,1}S\b/i

body     __SEEN_ON_CNN          /\bC[^a-z]{0,1}N[^a-z]{0,1}N\b/i

body     __SEEN_ON_NBC          /\bN[^a-z]{0,1}B[^a-z]{0,1}C\b/i

body     __SEEN_ON_OPRAH        /\boprah\b/i

uri	 __SHORT_URL	/^http:\/\/[^\/]{3,6}\.\w\w\/[^\/]{3,8}\/?$/

header   __SINGLE_HEADER_1K	ALL:raw =~ /(?-xim:(?=(?!X-Spam|X-MailScan|D\w{3,8}-Signature)(?:^|\n)[^\s\n]+:(?:.(?!\n\S)){1024,2047}.(?:\n\S|$)))/s

header __SMIME_SIGNED  Content-Type =~ /multipart\/signed;.*\/x-pkcs7-signatu/s

rawbody __SPOOFED_URL_HOST /<a\s[^>]{0,2048}\bhref=(?:3D)?.?(https?:\/\/?[^\/?>"'\# ]{8,29})[^>]{0,2048}>(?:[^<]{0,1024}<(?!\/a)[^>]{1,1024}>){0,99}\s{0,10}(?!\1)https?[^\w<]{1,3}[^<]{5}/i

header __SUBJ_2UPPER	Subject =~ /^(?:[a-zA-Z]{2,4}: +)?(?:\[[ \w]+\] +)?(?:.*[A-Z]){2}/

header __SUBJ_4LOWER	Subject =~ /^(?:[a-zA-Z]{2,4}: +)?(?:\[[ \w]+\] +)?(?:.*[a-z]){4}/

header __SUBJ_ALL_LOWER	Subject =~ /^[a-z -]$/

header      __SUBJ_ATTENTION     Subject =~ /ATTENTION/

header         __SUBJ_HAS_TO_1      ALL =~ /\nTo:\s+(?:[^\n<]{0,80}<)?([^\n\s>,]+)>?\n(?:[^\n]{1,100}\n)*Subject:\s+[^\n]{0,100}\1[>,\s\n]/ism

header	 __SUBJ_HAS_WORDS	Subject =~ /(?:^|\s)[^\W0-9_]{3,15}(?:\s|$)/

header __SUBJ_IMPORTANT	Subject =~ /\b(?:[Ii]mportant|IMPORTANT)\b/

header __SUBJ_INFORMAL	Subject =~ /(?:^| )(?:[iuU4]|[Bb]4)(?: |$)/

header   __SUBJ_LOWER           ALL =~ /subject:\s\S{5}/

header	 __SUBJ_NOT_SHORT	Subject =~ /^.{16}/

header      __SUBJ_OBFU_PUNCT      Subject =~ /(?:(?!<[a-z][a-z])[-~`"!@\#$%^&*()_+={}|\\\/?<>,.:;][a-z][-~`"!@\#$%^&*()_+={}|\\\/?<>,.:;\s]|[a-z][~`"!@\#$%^&*()_+={}|\\?<>,.:;][a-z])/i
tflags      __SUBJ_OBFU_PUNCT      multiple maxhits=4

header __SUBJ_SHORT	Subject =~ /^.{0,8}$/

header __TAB_IN_SUBJ	Subject =~ /\t/

meta           __TOOMANY_HDRS_LCASE  __HDRS_LCASE > 2

header         __TO_ALL_NUMS        To:addr =~ /^\d+@/

meta           __TO_EQ_FM_DIRECT_MX __TO_EQ_FROM && __DOS_DIRECT_TO_MX

meta           __TO_EQ_FM_DOM_HTML_IMG  __TO_EQ_FROM_DOM && __HTML_LINK_IMAGE

meta           __TO_EQ_FM_DOM_HTML_ONLY __TO_EQ_FROM_DOM && MIME_HTML_ONLY

meta           __TO_EQ_FM_HTML_DIRECT __TO_EQ_FM_DIRECT_MX && MIME_HTML_ONLY

meta           __TO_EQ_FM_HTML_ONLY __TO_EQ_FROM && MIME_HTML_ONLY

meta	 __TO_EQ_FROM_USR	(__TO_EQ_FROM_USR_1 || __TO_EQ_FROM_USR_2) && !(__FROM_DNS || __FROM_INFO || __SENDER_BOT)
describe __TO_EQ_FROM_USR	To: username same as From: username

header	 __TO_EQ_FROM_USR_1	ALL =~ /\nFrom:\s+(?:[^\n<]{0,80}<)?([^\n\s\@>]+)\@[^\n\s]+>?\n(?:[^\n]{1,100}\n)*To:\s+(?:[^\n]{0,80}<)?\1[\@>,\s\n]/ism

header	 __TO_EQ_FROM_USR_2	ALL =~ /\nTo:\s+(?:[^\n<]{0,80}<)?([^\n\s\@>]+)\@[^\n\s]+>?\n(?:[^\n]{1,100}\n)*From:\s+(?:[^\n]{0,80}<)?\1[\@>,\s\n]/ism

meta	 __TO_EQ_FROM_USR_NN	(__TO_EQ_FROM_USR_NN_1 || __TO_EQ_FROM_USR_NN_2) && !(__FROM_DNS || __FROM_INFO || __SENDER_BOT)
describe __TO_EQ_FROM_USR_NN	To: username same as From: username sans trailing nums

header	 __TO_EQ_FROM_USR_NN_1	ALL =~ /\nFrom:\s+(?:[^\n<]{0,80}<)?([^\n\s\@>]{4,80}?)\d*\@[^\n\s]+>?\n(?:[^\n]{1,100}\n)*To:\s+(?:[^\n]{0,80}<)?\1\d*[\@>,\s\n]/ism

header	 __TO_EQ_FROM_USR_NN_2	ALL =~ /\nTo:\s+(?:[^\n<]{0,80}<)?([^\n\s\@>]{4,80}?)\d*\@[^\n\s]+>?\n(?:[^\n]{1,100}\n)*From:\s+(?:[^\n]{0,80}<)?\1\d*[\@>,\s\n]/ism

meta       __TO_NO_BRKTS_DIRECT     __TO_NO_ARROWS_R && __DOS_DIRECT_TO_MX

meta       __TO_NO_BRKTS_DYNIP     __TO_NO_ARROWS_R && !__TO_UNDISCLOSED && RDNS_DYNAMIC

meta       __TO_NO_BRKTS_FROM_MSSP   __TO_NO_ARROWS_R && !__TO_UNDISCLOSED && __FROM_MISSPACED

meta       __TO_NO_BRKTS_HTML_IMG  __TO_NO_ARROWS_R && !__TO_UNDISCLOSED && HTML_MESSAGE && __ONE_IMG

meta       __TO_NO_BRKTS_NORDNS    __TO_NO_ARROWS_R && !__TO_UNDISCLOSED && RDNS_NONE

meta       __TO_NO_BRKTS_NORDNS_HTML    __TO_NO_BRKTS_HTML_ONLY && RDNS_NONE

meta       __TO_NO_BRKTS_NOTLIST    __TO_NO_ARROWS_R && !__VIA_ML

meta       __TO_NO_BRKTS_PCNT       __TO_NO_ARROWS_R && __FB_NUM_PERCNT

header      __TO_TOO_MANY          To =~ /(?:,[^,]{1,80}){30}/

header      __TO_WAY_TOO_MANY      ToCc =~ /(?:,[^,]{1,80}){50}/

header __TT_BROKEN_XANAX                Subject =~ /X[:^."%()*\[\\]?A[:^."%()*\[\\]?N[:^."%()*\[\\]?A[:^."%()*\[\\]?X/i

header __TT_OBSCURED_XANAX      Subject =~ /(x|X|><)(a|A|\(a\)|4|@)(n|N)(a|A|\(a\)|4|@)(x|X|><)/

header __TT_XANAX               Subject =~ /XANAX/i

rawbody __TVD_BODY      /\S{4}/

body __TVD_GOT_UR       /\bgot ur (?:msg|message|email)/i

body __TVD_HAPPY_WITH   /\b(?:satisfied|glad|complaining|happy|content) with (?:ur?|your (?:thing|unit))\b/i

uri __TVD_INT_CID /^cid:/i

meta __TVD_MIME_ATT __TVD_MIME_ATT_AP || __TVD_MIME_ATT_AOPDF

header __TVD_MIME_CT_MM Content-Type =~ /^multipart\/mixed/i

body __TVD_VISIT_SITE   /\bvisit (?:this site|here),? www\./i

rawbody __TWO_WORD_LINES /^\S+\s+\S+$/
tflags  __TWO_WORD_LINES multiple

header   __UA_IMP		User-Agent =~ /^Internet Messaging Program/

header   __UA_KMAIL		User-Agent =~ /^KMail/

header   __UA_MOZ5		User-Agent =~ /^Mozilla\/5/

header   __UA_MSENTOUR		User-Agent =~ /^Microsoft-Entourage/

header   __UA_OPERA7		User-Agent =~ /^Opera7/

uri         __UCOZ_URI             /\.ucoz\.org\//i
describe    __UCOZ_URI             URI contains ucoz.org

body     __UC_MONEY       /\bMONEY\b/

body        __UNSUBSCRIBE_ES   /\b(?:Para darte de baja y no recibir ning(?:=FA|[\xfa]|[\xc3][\xba])n|Si no desea que le enviemos publicidad|solicitar su baja)\b/i

body        __UNSUBSCRIBE_PT   /\bSe n(?:a|=E3|[\xe3]|[\xc3][\xa3])o desejar mais receber nossos e-?mails?\b/i

rawbody	 __UNSUB_MAILTO	/href=["']?mailto:[^>]{6,60}>[^<]{0,6}\b(?:(?:un)?subscri(?:ber?|ptions?)|abuses?|opt(?:ing)?.?out)\b/
tflags	 __UNSUB_MAILTO	nice

uri            __URI_12LTRDOM      m,://(?:[^./]+\.)*[a-z]{12}\.[^./]+/,i

uri         __URI_DATA         /^data:[a-z]/i

uri         __URI_DBL_DOM      m,^https?://[^.]+\.(?!amazon\.com)([^/]+)/.*https?://[^.]+\.\1/,i

uri         __URI_DBL_INDIR    m,(?:=https?://(?!www\.amazon\.com).*?){2},i

body        __URI_DBL_PROTO    m,\b(?:https?:/+){2},i

uri         __URI_DBL_SUBDOM   m,^https?://(?!www\.amazon\.com)([^/]+)/.*https?://(?:[^.]+\.)?\1/,i

body          __URI_DEOBFU_INSTR  /(?:delete|remove|take\sout)(?:\sthe)?\sspaces/i

uri         __URI_DOM_DOTDOT      m,://[^/]+\.\.,

uri         __URI_DOS_FILE     /^[A-Z]:\\/i

uri         __URI_GOOG_MC        /(?!(?-i:[Gg]oogle))google/i

uri             __URI_OBFU_DOM          /:\/\/(?:\w+\.)+(?:com|gov|net|org)(?:\.\w+){3,}\//i

body          __URI_OBFU_TLD    /\.\s(?:c\so\sm|n\se\st|o\sr\sg|b\si\sz|i\sn\sf\so)/i

uri         __URI_PROTO_MC       /^(?!(?-i:(?:[Hh]ttps?|HTTPS?):))https?:/i

uri         __URI_TLD_MC         /\.(?!(?-i:com|net|org|biz|info|COM|NET|ORG))(?:com|net|org|biz|info)\b/i

uri         __URI_TRPL_INDIR   m,(?:=https?://(?!www\.amazon\.com).*?){3},i

uri         __URI_WWW_MC         m,://(?!(?-i:www|WWW))www\.,i

uri         __URI_YOUSENDIT      m,^https?://www\.yousendit\.com/directdownload,i

header __USER_AGENT_MUTT        User-Agent =~ /^Mutt /

body __V_SECONDARYSOURCES /\bsecondary sources\b/i

rawbody  __WEB_BUGS	m{<[^>]{4,100}\ssrc=[^>]{8,200}\.(?:pl|cgi|php\d?|asp|jsp|cfm|py|\?[^>]{4})\b}i

header   __XM_AOL		X-Mailer =~ /^AOL /

header   __XM_APPLEMAIL		X-Mailer =~ /^Apple Mail/

header   __XM_BALSA		X-Mailer =~ /^Balsa \d/

header   __XM_CALYPSO		X-Mailer =~ /^Calypso/

header   __XM_COMMUNIG		X-Mailer =~ /^CommuniGate/

header   __XM_DTMAIL		X-Mailer =~ /^dtmail 1/

header      __XM_EC_MESSENGER      X-Mailer =~ /\beC-Messenger\b/

header   __XM_EDMAX		X-Mailer =~ /^EdMax/

header   __XM_ELM		X-Mailer =~ /^ELM/

header   __XM_EMUMAIL		X-Mailer =~ /^EMUmail/

header   __XM_EXMH		X-Mailer =~ /^exmh/

header   __XM_FORTE		X-Mailer =~ /^Forte Agent \d/

header   __XM_FREEMAIL		X-Mailer =~ /^freemail 0/

header   __XM_IMAIL		X-Mailer =~ /^<IMail v\d/

header   __XM_LOTUSN		X-Mailer =~ /^Lotus Notes/

header   __XM_LOTUSN5		X-Mailer =~ /^Lotus Notes Release 5\.0\.\d/

header   __XM_MAILCITY		X-Mailer =~ /^MailCity Service/

header   __XM_MAILSMITH		X-Mailer =~ /^Mailsmith /

header   __XM_MHE		X-Mailer =~ /^mh-e \d/

header   __XM_MIMETOOLS		X-Mailer =~ /^MIME-tools \d/i

header   __XM_MSCDO		X-Mailer =~ /^Microsoft CDO/

header   __XM_MSOE4		X-Mailer =~ /^Microsoft Outlook Express 4/

header   __XM_MSOUT		X-Mailer =~ /^Microsoft Outlook[, ]?\s?[BIC]/ #Build, IMO, CWS

header   __XM_NETMAIL		X-Mailer =~ /^NetMail ModWeb Module/

header   __XM_NETSCAPEW		X-Mailer =~ /^Netscape Webmail/

header   __XM_NOVELL		X-Mailer =~ /^Novell GroupWise/

header   __XM_OPENWEB		X-Mailer =~ /^Open WebMail 1/

header   __XM_OPERA6		X-Mailer =~ /^Opera 6/

header   __XM_PEGASUS		X-Mailer =~ /^Pegasus Mail/

header      __XM_PHPMAILER_FORGED  X-Mailer =~ /PHPMailer\s.*version\D+$/

header   __XM_POSTMAN		X-Mailer =~ /^Postman 1/

header   __XM_QUALCOM		X-Mailer =~ /^QUALCOMM Windows Eudora/

header   __XM_SQRLMAIL		X-Mailer =~ /^SquirrelMail/

header   __XM_SYLPHEED		X-Mailer =~ /^Sylpheed/

header   __XM_THEBAT		X-Mailer =~ /^The Bat!/

header   __XM_VM		X-Mailer =~ /^VM \d/

header   __XM_WEBMAIL5		X-Mailer =~ /^Web Mail 5/

header   __XM_XIMEVOL		X-Mailer =~ /^Ximian Evolution/

header __X_IP                   exists:X-IP

body     __YOUR_CREDIT          /your credit/

body        __YOUR_PHOTOS       /\byour photos (?:as p[rw]omised )?(?:here )?(?:- )?https?:/i

body		__hk_hthousand		/hundred.{0,20}thousand.{0,20}(?:eur|usd|gbp|cfa|euro?s?|dollard?s?|pounds?|francs?)\b/i

body		__hk_million		/(?:(?:[0-9]{3}[ ,.]?){2,4}|[0-9] ?M\b|mill(?:(?:es?|ons?)(?: de\b)?|ion)).{0,18}(?:\$|[\xa3\xa4]|eur\b|usd\b|gbp\b|cfa\b|euro?s?\b|dollard?s?\b|pounds?\b|francs?\b)/i

body		__hk_million2		/(?:\$|[\xa3\xa4]|eur|usd?|gbp|cfa|euro?s?|dollard?s?|pounds?|francs?)(?: de\b)? mill(?:(?:es?|ons?)|ion)/

body		__hk_win_0		/\byour? e-?mail just w[oi]n/i

body		__hk_win_1		/\b(?:prize|lucky|dear|emerged(?: a)?) (?:winner|money)/i

body		__hk_win_2		/\battn.{0,10}winner/i

body		__hk_win_3		/\bhappily aa?nnounce/i

body		__hk_win_4		/\bpleas(?:ure|ed) to inform/i

body		__hk_win_5		/\b(?:notice the|your) winning/i

body		__hk_win_6		/\b(?:ha(?:s|ve)|you) w[io]n/i

body		__hk_win_7		/\bcongratulations? to your/i

body		__hk_win_8		/\bunexpected luck/i

body		__hk_win_9		/\blucky (?:nl )number/i

body		__hk_win_a		/\bwinning (?:e-?mail|numbers|information)/i

body		__hk_win_b		/\byour e-?mail (?:address )?(?:has )?w[io]n/i

body		__hk_win_c		/\bune adresse e-?mail sur internet/i

body		__hk_win_d		/\bcategory (?:\S{0,5} )?winner of our/i

body		__hk_win_e		/\b(?:tic(?:ket)?|batch|\bbt|serial|\bsr|\brf|ref(?:erence)?)(?:\:| ?(?:number|no\b|nr))/i

body		__hk_win_f		/\bnum.ro de (?:ticket|s.rie|r.f.rence|lot)/i

body		__hk_win_g		/\bselected randomly/i

body		__hk_win_h		/\brandomly selected/i

body		__hk_win_i		/\bfunds? transfer/i

body		__hk_win_j		/\b(?:winning|ready for|sum) pay ?out/i

body		__hk_win_k		/\bclaim(?:s? officer| your| procedure)/i

body		__hk_win_l		/\b(?:make|file) (?:for )?your claim/i

body		__hk_win_m		/\br.clamation de votre prix/i

body		__hk_win_n		/\bcollect your prize/i

body		__hk_win_o		/\bclarification and procedure/i
